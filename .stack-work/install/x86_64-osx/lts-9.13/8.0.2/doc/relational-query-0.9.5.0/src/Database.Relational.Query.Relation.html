<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Module      : Database.Relational.Query.Relation</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Copyright   : 2013-2017 Kei Hibino</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- License     : BSD3</span><span>
</span><a name="line-7"></a><span class="hs-comment">--</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Maintainer  : ex8k.hibino@gmail.com</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Stability   : experimental</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Portability : unknown</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- This module defines re-usable Relation type</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- to compose complex query.</span><span>
</span><a name="line-14"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Relation</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-15"></a><span>  </span><span class="hs-comment">-- * Relation type</span><span>
</span><a name="line-16"></a><span>  </span><a href="Database.Relational.Query.Relation.html#table"><span class="hs-identifier hs-var">table</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#derivedRelation"><span class="hs-identifier hs-var">derivedRelation</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#tableOf"><span class="hs-identifier hs-var">tableOf</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>  </span><a href="Database.Relational.Query.Relation.html#relation"><span class="hs-identifier hs-var">relation</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#relation%27"><span class="hs-identifier hs-var">relation'</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>  </span><a href="Database.Relational.Query.Relation.html#aggregateRelation"><span class="hs-identifier hs-var">aggregateRelation</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#aggregateRelation%27"><span class="hs-identifier hs-var">aggregateRelation'</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span>  </span><a href="Database.Relational.Query.Relation.html#UniqueRelation"><span class="hs-identifier hs-type">UniqueRelation</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>  </span><a href="Database.Relational.Query.Relation.html#unsafeUnique"><span class="hs-identifier hs-var">unsafeUnique</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#unUnique"><span class="hs-identifier hs-var">unUnique</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span>  </span><a href="Database.Relational.Query.Relation.html#uniqueRelation%27"><span class="hs-identifier hs-var">uniqueRelation'</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#aggregatedUnique"><span class="hs-identifier hs-var">aggregatedUnique</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span>  </span><span class="hs-comment">-- * Query using relation</span><span>
</span><a name="line-26"></a><span>  </span><a href="Database.Relational.Query.Relation.html#query"><span class="hs-identifier hs-var">query</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#queryMaybe"><span class="hs-identifier hs-var">queryMaybe</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#queryList"><span class="hs-identifier hs-var">queryList</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#queryList%27"><span class="hs-identifier hs-var">queryList'</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#queryScalar"><span class="hs-identifier hs-var">queryScalar</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#queryScalar%27"><span class="hs-identifier hs-var">queryScalar'</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>  </span><a href="Database.Relational.Query.Relation.html#uniqueQuery%27"><span class="hs-identifier hs-var">uniqueQuery'</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#uniqueQueryMaybe%27"><span class="hs-identifier hs-var">uniqueQueryMaybe'</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span>  </span><span class="hs-comment">-- * Direct style join</span><span>
</span><a name="line-30"></a><span>  </span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>  </span><a href="Database.Relational.Query.Relation.html#inner%27"><span class="hs-identifier hs-var">inner'</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#left%27"><span class="hs-identifier hs-var">left'</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#right%27"><span class="hs-identifier hs-var">right'</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#full%27"><span class="hs-identifier hs-var">full'</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>  </span><a href="Database.Relational.Query.Relation.html#inner"><span class="hs-identifier hs-var">inner</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#left"><span class="hs-identifier hs-var">left</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#right"><span class="hs-identifier hs-var">right</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#full"><span class="hs-identifier hs-var">full</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>  </span><a href="Database.Relational.Query.Relation.html#on%27"><span class="hs-identifier hs-var">on'</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>  </span><span class="hs-comment">-- * Relation append</span><span>
</span><a name="line-36"></a><span>  </span><a href="Database.Relational.Query.Relation.html#union"><span class="hs-identifier hs-var">union</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#except"><span class="hs-identifier hs-var">except</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#intersect"><span class="hs-identifier hs-var">intersect</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>  </span><a href="Database.Relational.Query.Relation.html#unionAll"><span class="hs-identifier hs-var">unionAll</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#exceptAll"><span class="hs-identifier hs-var">exceptAll</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#intersectAll"><span class="hs-identifier hs-var">intersectAll</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span>  </span><a href="Database.Relational.Query.Relation.html#union%27"><span class="hs-identifier hs-var">union'</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#except%27"><span class="hs-identifier hs-var">except'</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#intersect%27"><span class="hs-identifier hs-var">intersect'</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>  </span><a href="Database.Relational.Query.Relation.html#unionAll%27"><span class="hs-identifier hs-var">unionAll'</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#exceptAll%27"><span class="hs-identifier hs-var">exceptAll'</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Relation.html#intersectAll%27"><span class="hs-identifier hs-var">intersectAll'</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">BaseSQL</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.BaseSQL.html#Duplication"><span class="hs-identifier hs-type">Duplication</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.BaseSQL.html#Distinct"><span class="hs-identifier hs-var">Distinct</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#All"><span class="hs-identifier hs-var">All</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Context.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Context</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Aggregated"><span class="hs-identifier hs-type">Aggregated</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">BaseType</span></a><span>
</span><a name="line-49"></a><span>  </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.BaseType.html#ConfigureQuery"><span class="hs-identifier hs-type">ConfigureQuery</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#qualifyQuery"><span class="hs-identifier hs-var">qualifyQuery</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>   </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#unsafeTypeRelation"><span class="hs-identifier hs-var">unsafeTypeRelation</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#untypeRelation"><span class="hs-identifier hs-var">untypeRelation</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#relationWidth"><span class="hs-identifier hs-var">relationWidth</span></a><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Monad.Class.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span></a><span>
</span><a name="line-52"></a><span>  </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.Class.html#MonadQualify"><span class="hs-identifier hs-type">MonadQualify</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.Class.html#liftQualify"><span class="hs-identifier hs-var">liftQualify</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#MonadQuery"><span class="hs-identifier hs-type">MonadQuery</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.Class.html#query%27"><span class="hs-identifier hs-var">query'</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#queryMaybe%27"><span class="hs-identifier hs-var">queryMaybe'</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#on"><span class="hs-identifier hs-var">on</span></a><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Monad.Simple.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Simple</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.Simple.html#QuerySimple"><span class="hs-identifier hs-type">QuerySimple</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Monad.Simple.html#SimpleQuery"><span class="hs-identifier hs-type">SimpleQuery</span></a><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Database.Relational.Query.Monad.Simple.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Simple</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Simple</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Monad.Aggregate.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Aggregate</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.Aggregate.html#QueryAggregate"><span class="hs-identifier hs-type">QueryAggregate</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Monad.Aggregate.html#AggregatedQuery"><span class="hs-identifier hs-type">AggregatedQuery</span></a><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Database.Relational.Query.Monad.Aggregate.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Aggregate</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Aggregate</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Monad.Unique.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Unique</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.Unique.html#QueryUnique"><span class="hs-identifier hs-type">QueryUnique</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Monad.Unique.html#unsafeUniqueSubQuery"><span class="hs-identifier hs-var">unsafeUniqueSubQuery</span></a><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Database.Relational.Query.Monad.Unique.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Unique</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Unique</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Table.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Table</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Table.html#Table"><span class="hs-identifier hs-type">Table</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Table.html#TableDerivable"><span class="hs-identifier hs-type">TableDerivable</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Table.html#derivedTable"><span class="hs-identifier hs-var">derivedTable</span></a><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Sub.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Sub</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#SubQuery"><span class="hs-identifier hs-type">SubQuery</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#NodeAttr"><span class="hs-identifier hs-type">NodeAttr</span></a><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Just%27"><span class="hs-identifier hs-var">Just'</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Maybe"><span class="hs-identifier hs-var">Maybe</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Database.Relational.Query.Sub.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Sub</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">SubQuery</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Scalar.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Scalar</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Scalar.html#ScalarDegree"><span class="hs-identifier hs-type">ScalarDegree</span></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Pi.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Pi</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Pi.Unsafe.html#Pi"><span class="hs-identifier hs-type">Pi</span></a><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Projection.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Projection</span></a><span>
</span><a name="line-65"></a><span>  </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Projection.html#ListProjection"><span class="hs-identifier hs-type">ListProjection</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Database.Relational.Query.Projection.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Projection</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Projection</span><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Relational.Query.Projectable.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Relational</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span><span class="hs-operator">.</span><span class="hs-identifier">Projectable</span></a><span>
</span><a name="line-68"></a><span>  </span><span class="hs-special">(</span><a href="Database.Relational.Query.Projectable.html#PlaceHolders"><span class="hs-identifier hs-type">PlaceHolders</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Projectable.html#unitPlaceHolder"><span class="hs-identifier hs-var">unitPlaceHolder</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Projectable.html#unsafeAddPlaceHolders"><span class="hs-identifier hs-var">unsafeAddPlaceHolders</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Projectable.html#unsafePlaceHolders"><span class="hs-identifier hs-var">unsafePlaceHolders</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Projectable.html#projectZip"><span class="hs-identifier hs-var">projectZip</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">-- | Simple 'Relation' from 'Table'.</span><span>
</span><a name="line-72"></a><span class="hs-identifier">table</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Table.html#Table"><span class="hs-identifier hs-type">Table</span></a><span> </span><a href="#local-6989586621679356245"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356245"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-73"></a><a name="table"><a href="Database.Relational.Query.Relation.html#table"><span class="hs-identifier">table</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Monad.BaseType.html#unsafeTypeRelation"><span class="hs-identifier hs-var">unsafeTypeRelation</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Sub.html#fromTable"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromTable</span></a><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-comment">-- | Inferred 'Relation'.</span><span>
</span><a name="line-76"></a><span class="hs-identifier">derivedRelation</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Table.html#TableDerivable"><span class="hs-identifier hs-type">TableDerivable</span></a><span> </span><a href="#local-6989586621679356244"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356244"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-77"></a><a name="derivedRelation"><a href="Database.Relational.Query.Relation.html#derivedRelation"><span class="hs-identifier">derivedRelation</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#table"><span class="hs-identifier hs-var">table</span></a><span> </span><a href="Database.Relational.Query.Table.html#derivedTable"><span class="hs-identifier hs-var">derivedTable</span></a><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- | Interface to derive 'Table' type object.</span><span>
</span><a name="line-80"></a><span class="hs-identifier">tableOf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Table.html#TableDerivable"><span class="hs-identifier hs-type">TableDerivable</span></a><span> </span><a href="#local-6989586621679356243"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356243"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Table.html#Table"><span class="hs-identifier hs-type">Table</span></a><span> </span><a href="#local-6989586621679356243"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-81"></a><a name="tableOf"><a href="Database.Relational.Query.Relation.html#tableOf"><span class="hs-identifier">tableOf</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">const</span><span> </span><a href="Database.Relational.Query.Table.html#derivedTable"><span class="hs-identifier hs-var">derivedTable</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-identifier">placeHoldersFromRelation</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356241"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356242"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Projectable.html#PlaceHolders"><span class="hs-identifier hs-type">PlaceHolders</span></a><span> </span><a href="#local-6989586621679356241"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-84"></a><a name="placeHoldersFromRelation"><a href="Database.Relational.Query.Relation.html#placeHoldersFromRelation"><span class="hs-identifier">placeHoldersFromRelation</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">const</span><span> </span><a href="Database.Relational.Query.Projectable.html#unsafePlaceHolders"><span class="hs-identifier hs-var">unsafePlaceHolders</span></a><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | Join sub-query. Query result is not 'Maybe'.</span><span>
</span><a name="line-87"></a><span class="hs-identifier">query</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.Class.html#MonadQualify"><span class="hs-identifier hs-type">MonadQualify</span></a><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#ConfigureQuery"><span class="hs-identifier hs-type">ConfigureQuery</span></a><span> </span><a href="#local-6989586621679356239"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#MonadQuery"><span class="hs-identifier hs-type">MonadQuery</span></a><span> </span><a href="#local-6989586621679356239"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356240"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-89"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679356239"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span> </span><a href="#local-6989586621679356240"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-90"></a><a name="query"><a href="Database.Relational.Query.Relation.html#query"><span class="hs-identifier">query</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#query%27"><span class="hs-identifier hs-var">query'</span></a><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-comment">-- | Join sub-query. Query result is 'Maybe'.</span><span>
</span><a name="line-93"></a><span class="hs-comment">--   The combinations of 'query' and 'queryMaybe' express</span><span>
</span><a name="line-94"></a><span class="hs-comment">--   inner joins, left outer joins, right outer joins, and full outer joins.</span><span>
</span><a name="line-95"></a><span class="hs-comment">--   Here is an example of a right outer join:</span><span>
</span><a name="line-96"></a><span class="hs-comment">--</span><span>
</span><a name="line-97"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-98"></a><span class="hs-comment">--   outerJoin = relation $ do</span><span>
</span><a name="line-99"></a><span class="hs-comment">--     e &lt;- queryMaybe employee</span><span>
</span><a name="line-100"></a><span class="hs-comment">--     d &lt;- query department</span><span>
</span><a name="line-101"></a><span class="hs-comment">--     on $ e ?! E.deptId' .=. just (d ! D.deptId')</span><span>
</span><a name="line-102"></a><span class="hs-comment">--     return $ (,) |$| e |*| d</span><span>
</span><a name="line-103"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-104"></a><span class="hs-identifier">queryMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.Class.html#MonadQualify"><span class="hs-identifier hs-type">MonadQualify</span></a><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#ConfigureQuery"><span class="hs-identifier hs-type">ConfigureQuery</span></a><span> </span><a href="#local-6989586621679356237"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#MonadQuery"><span class="hs-identifier hs-type">MonadQuery</span></a><span> </span><a href="#local-6989586621679356237"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356238"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-106"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679356237"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356238"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><a name="queryMaybe"><a href="Database.Relational.Query.Relation.html#queryMaybe"><span class="hs-identifier">queryMaybe</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#queryMaybe%27"><span class="hs-identifier hs-var">queryMaybe'</span></a><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-identifier">queryList0</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#MonadQualify"><span class="hs-identifier hs-type">MonadQualify</span></a><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#ConfigureQuery"><span class="hs-identifier hs-type">ConfigureQuery</span></a><span> </span><a href="#local-6989586621679356233"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356234"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356235"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679356233"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Projection.html#ListProjection"><span class="hs-identifier hs-type">ListProjection</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="#local-6989586621679356236"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356235"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a><a name="queryList0"><a href="Database.Relational.Query.Relation.html#queryList0"><span class="hs-identifier">queryList0</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Monad.Class.html#liftQualify"><span class="hs-identifier hs-var">liftQualify</span></a><span>
</span><a name="line-111"></a><span>              </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Database.Relational.Query.Projection.html#unsafeListFromSubQuery"><span class="hs-identifier hs-var">Projection</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeListFromSubQuery</span></a><span>
</span><a name="line-112"></a><span>              </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#untypeRelation"><span class="hs-identifier hs-var">untypeRelation</span></a><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">-- | List sub-query, for /IN/ and /EXIST/ with place-holder parameter 'p'.</span><span>
</span><a name="line-115"></a><span class="hs-identifier">queryList'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#MonadQualify"><span class="hs-identifier hs-type">MonadQualify</span></a><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#ConfigureQuery"><span class="hs-identifier hs-type">ConfigureQuery</span></a><span> </span><a href="#local-6989586621679356229"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-116"></a><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356230"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356231"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-117"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679356229"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Projectable.html#PlaceHolders"><span class="hs-identifier hs-type">PlaceHolders</span></a><span> </span><a href="#local-6989586621679356230"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Projection.html#ListProjection"><span class="hs-identifier hs-type">ListProjection</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="#local-6989586621679356232"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356231"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><a name="queryList%27"><a href="Database.Relational.Query.Relation.html#queryList%27"><span class="hs-identifier">queryList'</span></a></a><span> </span><a name="local-6989586621679356246"><a href="#local-6989586621679356246"><span class="hs-identifier">rel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-119"></a><span>  </span><a name="local-6989586621679356247"><a href="#local-6989586621679356247"><span class="hs-identifier">ql</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Relational.Query.Relation.html#queryList0"><span class="hs-identifier hs-var">queryList0</span></a><span> </span><a href="#local-6989586621679356246"><span class="hs-identifier hs-var">rel</span></a><span>
</span><a name="line-120"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Relation.html#placeHoldersFromRelation"><span class="hs-identifier hs-var">placeHoldersFromRelation</span></a><span> </span><a href="#local-6989586621679356246"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356247"><span class="hs-identifier hs-var">ql</span></a><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- | List sub-query, for /IN/ and /EXIST/.</span><span>
</span><a name="line-123"></a><span class="hs-identifier">queryList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#MonadQualify"><span class="hs-identifier hs-type">MonadQualify</span></a><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#ConfigureQuery"><span class="hs-identifier hs-type">ConfigureQuery</span></a><span> </span><a href="#local-6989586621679356226"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-124"></a><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356227"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-125"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679356226"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Projection.html#ListProjection"><span class="hs-identifier hs-type">ListProjection</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="#local-6989586621679356228"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356227"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><a name="queryList"><a href="Database.Relational.Query.Relation.html#queryList"><span class="hs-identifier">queryList</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#queryList0"><span class="hs-identifier hs-var">queryList0</span></a><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-identifier">addUnitPH</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="#local-6989586621679356224"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679356224"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679356225"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679356224"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Projectable.html#PlaceHolders"><span class="hs-identifier hs-type">PlaceHolders</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356225"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><a name="addUnitPH"><a href="Database.Relational.Query.Relation.html#addUnitPH"><span class="hs-identifier">addUnitPH</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="Database.Relational.Query.Projectable.html#unitPlaceHolder"><span class="hs-identifier hs-var">unitPlaceHolder</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">-- | Finalize 'QuerySimple' monad and generate 'Relation' with place-holder parameter 'p'.</span><span>
</span><a name="line-132"></a><span class="hs-identifier">relation'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.Simple.html#SimpleQuery"><span class="hs-identifier hs-type">SimpleQuery</span></a><span> </span><a href="#local-6989586621679356222"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356223"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356222"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356223"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-133"></a><a name="relation%27"><a href="Database.Relational.Query.Relation.html#relation%27"><span class="hs-identifier">relation'</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Monad.BaseType.html#unsafeTypeRelation"><span class="hs-identifier hs-var">unsafeTypeRelation</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Monad.Simple.html#toSubQuery"><span class="hs-identifier hs-var">Simple</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toSubQuery</span></a><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- | Finalize 'QuerySimple' monad and generate 'Relation'.</span><span>
</span><a name="line-136"></a><span class="hs-identifier">relation</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.Simple.html#QuerySimple"><span class="hs-identifier hs-type">QuerySimple</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span> </span><a href="#local-6989586621679356221"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356221"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-137"></a><a name="relation"><a href="Database.Relational.Query.Relation.html#relation"><span class="hs-identifier">relation</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#relation%27"><span class="hs-identifier hs-var">relation'</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Relation.html#addUnitPH"><span class="hs-identifier hs-var">addUnitPH</span></a><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-- | Finalize 'QueryAggregate' monad and geneate 'Relation' with place-holder parameter 'p'.</span><span>
</span><a name="line-140"></a><span class="hs-identifier">aggregateRelation'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.Aggregate.html#AggregatedQuery"><span class="hs-identifier hs-type">AggregatedQuery</span></a><span> </span><a href="#local-6989586621679356219"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356220"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356219"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356220"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-141"></a><a name="aggregateRelation%27"><a href="Database.Relational.Query.Relation.html#aggregateRelation%27"><span class="hs-identifier">aggregateRelation'</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Monad.BaseType.html#unsafeTypeRelation"><span class="hs-identifier hs-var">unsafeTypeRelation</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Monad.Aggregate.html#toSubQuery"><span class="hs-identifier hs-var">Aggregate</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toSubQuery</span></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">-- | Finalize 'QueryAggregate' monad and geneate 'Relation'.</span><span>
</span><a name="line-144"></a><span class="hs-identifier">aggregateRelation</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.Aggregate.html#QueryAggregate"><span class="hs-identifier hs-type">QueryAggregate</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Aggregated"><span class="hs-identifier hs-type">Aggregated</span></a><span> </span><a href="#local-6989586621679356218"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356218"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-145"></a><a name="aggregateRelation"><a href="Database.Relational.Query.Relation.html#aggregateRelation"><span class="hs-identifier">aggregateRelation</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#aggregateRelation%27"><span class="hs-identifier hs-var">aggregateRelation'</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Relation.html#addUnitPH"><span class="hs-identifier hs-var">addUnitPH</span></a><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">-- | Restriction predicate function type for direct style join operator,</span><span>
</span><a name="line-149"></a><span class="hs-comment">--   used on predicates of direct join style as follows.</span><span>
</span><a name="line-150"></a><span class="hs-comment">--</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-152"></a><span class="hs-comment">--   do xy &lt;- query $</span><span>
</span><a name="line-153"></a><span class="hs-comment">--            relX `inner` relY `on'` [ \x y -&gt; ... ] -- this lambda form has JoinRestriction type</span><span>
</span><a name="line-154"></a><span class="hs-comment">--      ...</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-156"></a><span class="hs-keyword">type</span><span> </span><a name="JoinRestriction"><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier">JoinRestriction</span></a></a><span> </span><a name="local-6989586621679356118"><a href="#local-6989586621679356118"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679356119"><a href="#local-6989586621679356119"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span> </span><a href="#local-6989586621679356118"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span> </span><a href="#local-6989586621679356119"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-comment">-- | Basic direct join operation with place-holder parameters.</span><span>
</span><a name="line-159"></a><span class="hs-identifier">join'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356212"><span class="hs-identifier hs-type">qa</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.Simple.html#QuerySimple"><span class="hs-identifier hs-type">QuerySimple</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Projectable.html#PlaceHolders"><span class="hs-identifier hs-type">PlaceHolders</span></a><span> </span><a href="#local-6989586621679356213"><span class="hs-identifier hs-type">pa</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span> </span><a href="#local-6989586621679356214"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356215"><span class="hs-identifier hs-type">qb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.Simple.html#QuerySimple"><span class="hs-identifier hs-type">QuerySimple</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Projectable.html#PlaceHolders"><span class="hs-identifier hs-type">PlaceHolders</span></a><span> </span><a href="#local-6989586621679356216"><span class="hs-identifier hs-type">pb</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span> </span><a href="#local-6989586621679356217"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679356212"><span class="hs-identifier hs-type">qa</span></a><span>
</span><a name="line-162"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679356215"><span class="hs-identifier hs-type">qb</span></a><span>
</span><a name="line-163"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span> </span><a href="#local-6989586621679356214"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679356217"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-164"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356213"><span class="hs-identifier hs-type">pa</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356216"><span class="hs-identifier hs-type">pb</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356214"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356217"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-165"></a><a name="join%27"><a href="Database.Relational.Query.Relation.html#join%27"><span class="hs-identifier">join'</span></a></a><span> </span><a name="local-6989586621679356248"><a href="#local-6989586621679356248"><span class="hs-identifier">qL</span></a></a><span> </span><a name="local-6989586621679356249"><a href="#local-6989586621679356249"><span class="hs-identifier">qR</span></a></a><span> </span><a name="local-6989586621679356250"><a href="#local-6989586621679356250"><span class="hs-identifier">r0</span></a></a><span> </span><a name="local-6989586621679356251"><a href="#local-6989586621679356251"><span class="hs-identifier">r1</span></a></a><span> </span><a name="local-6989586621679356252"><a href="#local-6989586621679356252"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Relational.Query.Relation.html#relation%27"><span class="hs-identifier hs-var">relation'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-166"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679356253"><a href="#local-6989586621679356253"><span class="hs-identifier">ph0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679356254"><a href="#local-6989586621679356254"><span class="hs-identifier">pj0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679356248"><span class="hs-identifier hs-var">qL</span></a><span> </span><a href="#local-6989586621679356250"><span class="hs-identifier hs-var">r0</span></a><span>
</span><a name="line-167"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679356255"><a href="#local-6989586621679356255"><span class="hs-identifier">ph1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679356256"><a href="#local-6989586621679356256"><span class="hs-identifier">pj1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679356249"><span class="hs-identifier hs-var">qR</span></a><span> </span><a href="#local-6989586621679356251"><span class="hs-identifier hs-var">r1</span></a><span>
</span><a name="line-168"></a><span>  </span><span class="hs-identifier hs-var">sequence_</span><span> </span><span class="hs-special">[</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#on"><span class="hs-identifier hs-var">on</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679356257"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679356254"><span class="hs-identifier hs-var">pj0</span></a><span> </span><a href="#local-6989586621679356256"><span class="hs-identifier hs-var">pj1</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679356257"><a href="#local-6989586621679356257"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679356252"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-169"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356253"><span class="hs-identifier hs-var">ph0</span></a><span> </span><span class="hs-special">`</span><a href="Database.Relational.Query.Projectable.html#projectZip"><span class="hs-identifier hs-var">projectZip</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679356255"><span class="hs-identifier hs-var">ph1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356254"><span class="hs-identifier hs-var">pj0</span></a><span> </span><span class="hs-special">`</span><a href="Database.Relational.Query.Projectable.html#projectZip"><span class="hs-identifier hs-var">projectZip</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679356256"><span class="hs-identifier hs-var">pj1</span></a><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">-- | Direct inner join with place-holder parameters.</span><span>
</span><a name="line-172"></a><span class="hs-identifier">inner'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356208"><span class="hs-identifier hs-type">pa</span></a><span> </span><a href="#local-6989586621679356209"><span class="hs-identifier hs-type">a</span></a><span>            </span><span class="hs-comment">-- ^ Left query to join</span><span>
</span><a name="line-173"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356210"><span class="hs-identifier hs-type">pb</span></a><span> </span><a href="#local-6989586621679356211"><span class="hs-identifier hs-type">b</span></a><span>            </span><span class="hs-comment">-- ^ Right query to join</span><span>
</span><a name="line-174"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span> </span><a href="#local-6989586621679356209"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679356211"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- ^ Join restrictions</span><span>
</span><a name="line-175"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356208"><span class="hs-identifier hs-type">pa</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356210"><span class="hs-identifier hs-type">pb</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356209"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356211"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Result joined relation</span><span>
</span><a name="line-176"></a><a name="inner%27"><a href="Database.Relational.Query.Relation.html#inner%27"><span class="hs-identifier">inner'</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#join%27"><span class="hs-identifier hs-var">join'</span></a><span> </span><a href="Database.Relational.Query.Monad.Class.html#query%27"><span class="hs-identifier hs-var">query'</span></a><span> </span><a href="Database.Relational.Query.Monad.Class.html#query%27"><span class="hs-identifier hs-var">query'</span></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">-- | Direct left outer join with place-holder parameters.</span><span>
</span><a name="line-179"></a><span class="hs-identifier">left'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356204"><span class="hs-identifier hs-type">pa</span></a><span> </span><a href="#local-6989586621679356205"><span class="hs-identifier hs-type">a</span></a><span>                  </span><span class="hs-comment">-- ^ Left query to join</span><span>
</span><a name="line-180"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356206"><span class="hs-identifier hs-type">pb</span></a><span> </span><a href="#local-6989586621679356207"><span class="hs-identifier hs-type">b</span></a><span>                  </span><span class="hs-comment">-- ^ Right query to join</span><span>
</span><a name="line-181"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span> </span><a href="#local-6989586621679356205"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356207"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Join restrictions</span><span>
</span><a name="line-182"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356204"><span class="hs-identifier hs-type">pa</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356206"><span class="hs-identifier hs-type">pb</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356205"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356207"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Result joined relation</span><span>
</span><a name="line-183"></a><a name="left%27"><a href="Database.Relational.Query.Relation.html#left%27"><span class="hs-identifier">left'</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#join%27"><span class="hs-identifier hs-var">join'</span></a><span> </span><a href="Database.Relational.Query.Monad.Class.html#query%27"><span class="hs-identifier hs-var">query'</span></a><span> </span><a href="Database.Relational.Query.Monad.Class.html#queryMaybe%27"><span class="hs-identifier hs-var">queryMaybe'</span></a><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">-- | Direct right outer join with place-holder parameters.</span><span>
</span><a name="line-186"></a><span class="hs-identifier">right'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356200"><span class="hs-identifier hs-type">pa</span></a><span> </span><a href="#local-6989586621679356201"><span class="hs-identifier hs-type">a</span></a><span>                 </span><span class="hs-comment">-- ^ Left query to join</span><span>
</span><a name="line-187"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356202"><span class="hs-identifier hs-type">pb</span></a><span> </span><a href="#local-6989586621679356203"><span class="hs-identifier hs-type">b</span></a><span>                 </span><span class="hs-comment">-- ^ Right query to join</span><span>
</span><a name="line-188"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356201"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356203"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Join restrictions</span><span>
</span><a name="line-189"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356200"><span class="hs-identifier hs-type">pa</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356202"><span class="hs-identifier hs-type">pb</span></a><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356201"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356203"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Result joined relation</span><span>
</span><a name="line-190"></a><a name="right%27"><a href="Database.Relational.Query.Relation.html#right%27"><span class="hs-identifier">right'</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#join%27"><span class="hs-identifier hs-var">join'</span></a><span> </span><a href="Database.Relational.Query.Monad.Class.html#queryMaybe%27"><span class="hs-identifier hs-var">queryMaybe'</span></a><span> </span><a href="Database.Relational.Query.Monad.Class.html#query%27"><span class="hs-identifier hs-var">query'</span></a><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-comment">-- | Direct full outer join with place-holder parameters.</span><span>
</span><a name="line-193"></a><span class="hs-identifier">full'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356196"><span class="hs-identifier hs-type">pa</span></a><span> </span><a href="#local-6989586621679356197"><span class="hs-identifier hs-type">a</span></a><span>                         </span><span class="hs-comment">-- ^ Left query to join</span><span>
</span><a name="line-194"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356198"><span class="hs-identifier hs-type">pb</span></a><span> </span><a href="#local-6989586621679356199"><span class="hs-identifier hs-type">b</span></a><span>                         </span><span class="hs-comment">-- ^ Right query to join</span><span>
</span><a name="line-195"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356197"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356199"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Join restrictions</span><span>
</span><a name="line-196"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356196"><span class="hs-identifier hs-type">pa</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356198"><span class="hs-identifier hs-type">pb</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356197"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356199"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Result joined relation</span><span>
</span><a name="line-197"></a><a name="full%27"><a href="Database.Relational.Query.Relation.html#full%27"><span class="hs-identifier">full'</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#join%27"><span class="hs-identifier hs-var">join'</span></a><span> </span><a href="Database.Relational.Query.Monad.Class.html#queryMaybe%27"><span class="hs-identifier hs-var">queryMaybe'</span></a><span> </span><a href="Database.Relational.Query.Monad.Class.html#queryMaybe%27"><span class="hs-identifier hs-var">queryMaybe'</span></a><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">-- | Basic direct join operation.</span><span>
</span><a name="line-200"></a><span class="hs-identifier">join_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356192"><span class="hs-identifier hs-type">qa</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.Simple.html#QuerySimple"><span class="hs-identifier hs-type">QuerySimple</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span> </span><a href="#local-6989586621679356193"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-201"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356194"><span class="hs-identifier hs-type">qb</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.Simple.html#QuerySimple"><span class="hs-identifier hs-type">QuerySimple</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span> </span><a href="#local-6989586621679356195"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679356192"><span class="hs-identifier hs-type">qa</span></a><span>
</span><a name="line-203"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679356194"><span class="hs-identifier hs-type">qb</span></a><span>
</span><a name="line-204"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span> </span><a href="#local-6989586621679356193"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679356195"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-205"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356193"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356195"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-206"></a><a name="join_"><a href="Database.Relational.Query.Relation.html#join_"><span class="hs-identifier">join_</span></a></a><span> </span><a name="local-6989586621679356258"><a href="#local-6989586621679356258"><span class="hs-identifier">qL</span></a></a><span> </span><a name="local-6989586621679356259"><a href="#local-6989586621679356259"><span class="hs-identifier">qR</span></a></a><span> </span><a name="local-6989586621679356260"><a href="#local-6989586621679356260"><span class="hs-identifier">r0</span></a></a><span> </span><a name="local-6989586621679356261"><a href="#local-6989586621679356261"><span class="hs-identifier">r1</span></a></a><span> </span><a name="local-6989586621679356262"><a href="#local-6989586621679356262"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Relational.Query.Relation.html#relation"><span class="hs-identifier hs-var">relation</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-207"></a><span>  </span><a name="local-6989586621679356263"><a href="#local-6989586621679356263"><span class="hs-identifier">pj0</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679356258"><span class="hs-identifier hs-var">qL</span></a><span> </span><a href="#local-6989586621679356260"><span class="hs-identifier hs-var">r0</span></a><span>
</span><a name="line-208"></a><span>  </span><a name="local-6989586621679356264"><a href="#local-6989586621679356264"><span class="hs-identifier">pj1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679356259"><span class="hs-identifier hs-var">qR</span></a><span> </span><a href="#local-6989586621679356261"><span class="hs-identifier hs-var">r1</span></a><span>
</span><a name="line-209"></a><span>  </span><span class="hs-identifier hs-var">sequence_</span><span> </span><span class="hs-special">[</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#on"><span class="hs-identifier hs-var">on</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679356265"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679356263"><span class="hs-identifier hs-var">pj0</span></a><span> </span><a href="#local-6989586621679356264"><span class="hs-identifier hs-var">pj1</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679356265"><a href="#local-6989586621679356265"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679356262"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-210"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679356263"><span class="hs-identifier hs-var">pj0</span></a><span> </span><span class="hs-special">`</span><a href="Database.Relational.Query.Projectable.html#projectZip"><span class="hs-identifier hs-var">projectZip</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679356264"><span class="hs-identifier hs-var">pj1</span></a><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-comment">-- | Direct inner join.</span><span>
</span><a name="line-213"></a><span class="hs-identifier">inner</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356190"><span class="hs-identifier hs-type">a</span></a><span>         </span><span class="hs-comment">-- ^ Left query to join</span><span>
</span><a name="line-214"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356191"><span class="hs-identifier hs-type">b</span></a><span>         </span><span class="hs-comment">-- ^ Right query to join</span><span>
</span><a name="line-215"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span> </span><a href="#local-6989586621679356190"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679356191"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Join restrictions</span><span>
</span><a name="line-216"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356190"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356191"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- ^ Result joined relation</span><span>
</span><a name="line-217"></a><a name="inner"><a href="Database.Relational.Query.Relation.html#inner"><span class="hs-identifier">inner</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#join_"><span class="hs-identifier hs-var">join_</span></a><span> </span><a href="Database.Relational.Query.Relation.html#query"><span class="hs-identifier hs-var">query</span></a><span> </span><a href="Database.Relational.Query.Relation.html#query"><span class="hs-identifier hs-var">query</span></a><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-comment">-- | Direct left outer join.</span><span>
</span><a name="line-220"></a><span class="hs-identifier">left</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356188"><span class="hs-identifier hs-type">a</span></a><span>                 </span><span class="hs-comment">-- ^ Left query to join</span><span>
</span><a name="line-221"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356189"><span class="hs-identifier hs-type">b</span></a><span>                 </span><span class="hs-comment">-- ^ Right query to join</span><span>
</span><a name="line-222"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span> </span><a href="#local-6989586621679356188"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356189"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Join restrictions</span><span>
</span><a name="line-223"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356188"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356189"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- ^ Result joined relation</span><span>
</span><a name="line-224"></a><a name="left"><a href="Database.Relational.Query.Relation.html#left"><span class="hs-identifier">left</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#join_"><span class="hs-identifier hs-var">join_</span></a><span> </span><a href="Database.Relational.Query.Relation.html#query"><span class="hs-identifier hs-var">query</span></a><span> </span><a href="Database.Relational.Query.Relation.html#queryMaybe"><span class="hs-identifier hs-var">queryMaybe</span></a><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-comment">-- | Direct right outer join.</span><span>
</span><a name="line-227"></a><span class="hs-identifier">right</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356186"><span class="hs-identifier hs-type">a</span></a><span>                 </span><span class="hs-comment">-- ^ Left query to join</span><span>
</span><a name="line-228"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356187"><span class="hs-identifier hs-type">b</span></a><span>                 </span><span class="hs-comment">-- ^ Right query to join</span><span>
</span><a name="line-229"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356186"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356187"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Join restrictions</span><span>
</span><a name="line-230"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356186"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356187"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- ^ Result joined relation</span><span>
</span><a name="line-231"></a><a name="right"><a href="Database.Relational.Query.Relation.html#right"><span class="hs-identifier">right</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#join_"><span class="hs-identifier hs-var">join_</span></a><span> </span><a href="Database.Relational.Query.Relation.html#queryMaybe"><span class="hs-identifier hs-var">queryMaybe</span></a><span> </span><a href="Database.Relational.Query.Relation.html#query"><span class="hs-identifier hs-var">query</span></a><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-comment">-- | Direct full outer join.</span><span>
</span><a name="line-234"></a><span class="hs-identifier">full</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356184"><span class="hs-identifier hs-type">a</span></a><span>                         </span><span class="hs-comment">-- ^ Left query to join</span><span>
</span><a name="line-235"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356185"><span class="hs-identifier hs-type">b</span></a><span>                         </span><span class="hs-comment">-- ^ Right query to join</span><span>
</span><a name="line-236"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356184"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356185"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Join restrictions</span><span>
</span><a name="line-237"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356184"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356185"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- ^ Result joined relation</span><span>
</span><a name="line-238"></a><a name="full"><a href="Database.Relational.Query.Relation.html#full"><span class="hs-identifier">full</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#join_"><span class="hs-identifier hs-var">join_</span></a><span> </span><a href="Database.Relational.Query.Relation.html#queryMaybe"><span class="hs-identifier hs-var">queryMaybe</span></a><span> </span><a href="Database.Relational.Query.Relation.html#queryMaybe"><span class="hs-identifier hs-var">queryMaybe</span></a><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">-- | Apply restriction for direct join style.</span><span>
</span><a name="line-241"></a><span class="hs-identifier">on'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span> </span><a href="#local-6989586621679356181"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679356182"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356183"><span class="hs-identifier hs-type">pc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356181"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356182"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Relational.Query.Relation.html#JoinRestriction"><span class="hs-identifier hs-type">JoinRestriction</span></a><span> </span><a href="#local-6989586621679356181"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679356182"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-243"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356183"><span class="hs-identifier hs-type">pc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356181"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356182"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-244"></a><a name="on%27"><a href="Database.Relational.Query.Relation.html#on%27"><span class="hs-identifier">on'</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-operator hs-var">$</span><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">inner'</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">left'</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">right'</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">full'</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">inner</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">left</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">right</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">full</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">on'</span><span class="hs-special">`</span><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-identifier">unsafeLiftAppend</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#SubQuery"><span class="hs-identifier hs-type">SubQuery</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#SubQuery"><span class="hs-identifier hs-type">SubQuery</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#SubQuery"><span class="hs-identifier hs-type">SubQuery</span></a><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356177"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356178"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-250"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356179"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679356178"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-251"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356180"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679356178"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-252"></a><a name="unsafeLiftAppend"><a href="Database.Relational.Query.Relation.html#unsafeLiftAppend"><span class="hs-identifier">unsafeLiftAppend</span></a></a><span> </span><a name="local-6989586621679356266"><a href="#local-6989586621679356266"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679356267"><a href="#local-6989586621679356267"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679356268"><a href="#local-6989586621679356268"><span class="hs-identifier">a1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#unsafeTypeRelation"><span class="hs-identifier hs-var">unsafeTypeRelation</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-253"></a><span>  </span><a name="local-6989586621679356269"><a href="#local-6989586621679356269"><span class="hs-identifier">s0</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#untypeRelation"><span class="hs-identifier hs-var">untypeRelation</span></a><span> </span><a href="#local-6989586621679356267"><span class="hs-identifier hs-var">a0</span></a><span>
</span><a name="line-254"></a><span>  </span><a name="local-6989586621679356270"><a href="#local-6989586621679356270"><span class="hs-identifier">s1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#untypeRelation"><span class="hs-identifier hs-var">untypeRelation</span></a><span> </span><a href="#local-6989586621679356268"><span class="hs-identifier hs-var">a1</span></a><span>
</span><a name="line-255"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679356269"><span class="hs-identifier hs-var">s0</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679356266"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679356270"><span class="hs-identifier hs-var">s1</span></a><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span class="hs-identifier">liftAppend</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#SubQuery"><span class="hs-identifier hs-type">SubQuery</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#SubQuery"><span class="hs-identifier hs-type">SubQuery</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#SubQuery"><span class="hs-identifier hs-type">SubQuery</span></a><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356176"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-259"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356176"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-260"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356176"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-261"></a><a name="liftAppend"><a href="Database.Relational.Query.Relation.html#liftAppend"><span class="hs-identifier">liftAppend</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Relational.Query.Relation.html#unsafeLiftAppend"><span class="hs-identifier hs-var">unsafeLiftAppend</span></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-comment">-- | Union of two relations.</span><span>
</span><a name="line-264"></a><span class="hs-identifier">union</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356175"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356175"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356175"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-265"></a><a name="union"><a href="Database.Relational.Query.Relation.html#union"><span class="hs-identifier">union</span></a></a><span>     </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#liftAppend"><span class="hs-identifier hs-var">liftAppend</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Sub.html#union"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">union</span></a><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#Distinct"><span class="hs-identifier hs-var">Distinct</span></a><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><span class="hs-comment">-- | Union of two relations. Not distinct.</span><span>
</span><a name="line-268"></a><span class="hs-identifier">unionAll</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356174"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356174"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356174"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-269"></a><a name="unionAll"><a href="Database.Relational.Query.Relation.html#unionAll"><span class="hs-identifier">unionAll</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#liftAppend"><span class="hs-identifier hs-var">liftAppend</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Sub.html#union"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">union</span></a><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#All"><span class="hs-identifier hs-var">All</span></a><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-comment">-- | Subtraction of two relations.</span><span>
</span><a name="line-272"></a><span class="hs-identifier">except</span><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356173"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356173"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356173"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-273"></a><a name="except"><a href="Database.Relational.Query.Relation.html#except"><span class="hs-identifier">except</span></a></a><span>    </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#liftAppend"><span class="hs-identifier hs-var">liftAppend</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Sub.html#except"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">except</span></a><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#Distinct"><span class="hs-identifier hs-var">Distinct</span></a><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-comment">-- | Subtraction of two relations. Not distinct.</span><span>
</span><a name="line-276"></a><span class="hs-identifier">exceptAll</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356172"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356172"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356172"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-277"></a><a name="exceptAll"><a href="Database.Relational.Query.Relation.html#exceptAll"><span class="hs-identifier">exceptAll</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#liftAppend"><span class="hs-identifier hs-var">liftAppend</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Sub.html#except"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">except</span></a><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#All"><span class="hs-identifier hs-var">All</span></a><span>
</span><a name="line-278"></a><span>
</span><a name="line-279"></a><span class="hs-comment">-- | Intersection of two relations.</span><span>
</span><a name="line-280"></a><span class="hs-identifier">intersect</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356171"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356171"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356171"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-281"></a><a name="intersect"><a href="Database.Relational.Query.Relation.html#intersect"><span class="hs-identifier">intersect</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#liftAppend"><span class="hs-identifier hs-var">liftAppend</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Sub.html#intersect"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">intersect</span></a><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#Distinct"><span class="hs-identifier hs-var">Distinct</span></a><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-comment">-- | Intersection of two relations. Not distinct.</span><span>
</span><a name="line-284"></a><span class="hs-identifier">intersectAll</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356170"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356170"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356170"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-285"></a><a name="intersectAll"><a href="Database.Relational.Query.Relation.html#intersectAll"><span class="hs-identifier">intersectAll</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#liftAppend"><span class="hs-identifier hs-var">liftAppend</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Sub.html#intersect"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">intersect</span></a><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#All"><span class="hs-identifier hs-var">All</span></a><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-identifier">liftAppend'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#SubQuery"><span class="hs-identifier hs-type">SubQuery</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#SubQuery"><span class="hs-identifier hs-type">SubQuery</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#SubQuery"><span class="hs-identifier hs-type">SubQuery</span></a><span class="hs-special">)</span><span>
</span><a name="line-288"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356167"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356168"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-289"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356169"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679356168"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-290"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356167"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356169"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356168"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-291"></a><a name="liftAppend%27"><a href="Database.Relational.Query.Relation.html#liftAppend%27"><span class="hs-identifier">liftAppend'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Relational.Query.Relation.html#unsafeLiftAppend"><span class="hs-identifier hs-var">unsafeLiftAppend</span></a><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-comment">-- | Union of two relations with place-holder parameters.</span><span>
</span><a name="line-294"></a><span class="hs-identifier">union'</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356164"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356165"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356166"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679356165"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356164"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356166"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356165"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-295"></a><a name="union%27"><a href="Database.Relational.Query.Relation.html#union%27"><span class="hs-identifier">union'</span></a></a><span>     </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#liftAppend%27"><span class="hs-identifier hs-var">liftAppend'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Sub.html#union"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">union</span></a><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#Distinct"><span class="hs-identifier hs-var">Distinct</span></a><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span class="hs-comment">-- | Union of two relations with place-holder parameters. Not distinct.</span><span>
</span><a name="line-298"></a><span class="hs-identifier">unionAll'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356161"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356162"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356163"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679356162"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356161"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356163"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356162"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-299"></a><a name="unionAll%27"><a href="Database.Relational.Query.Relation.html#unionAll%27"><span class="hs-identifier">unionAll'</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#liftAppend%27"><span class="hs-identifier hs-var">liftAppend'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Sub.html#union"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">union</span></a><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#All"><span class="hs-identifier hs-var">All</span></a><span>
</span><a name="line-300"></a><span>
</span><a name="line-301"></a><span class="hs-comment">-- | Subtraction of two relations with place-holder parameters.</span><span>
</span><a name="line-302"></a><span class="hs-identifier">except'</span><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356158"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356159"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356160"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679356159"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356158"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356160"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356159"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-303"></a><a name="except%27"><a href="Database.Relational.Query.Relation.html#except%27"><span class="hs-identifier">except'</span></a></a><span>    </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#liftAppend%27"><span class="hs-identifier hs-var">liftAppend'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Sub.html#except"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">except</span></a><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#Distinct"><span class="hs-identifier hs-var">Distinct</span></a><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-comment">-- | Subtraction of two relations with place-holder parameters. Not distinct.</span><span>
</span><a name="line-306"></a><span class="hs-identifier">exceptAll'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356155"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356156"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356157"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679356156"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356155"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356157"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356156"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-307"></a><a name="exceptAll%27"><a href="Database.Relational.Query.Relation.html#exceptAll%27"><span class="hs-identifier">exceptAll'</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#liftAppend%27"><span class="hs-identifier hs-var">liftAppend'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Sub.html#except"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">except</span></a><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#All"><span class="hs-identifier hs-var">All</span></a><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span class="hs-comment">-- | Intersection of two relations with place-holder parameters.</span><span>
</span><a name="line-310"></a><span class="hs-identifier">intersect'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356152"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356153"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356154"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679356153"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356152"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356154"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356153"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-311"></a><a name="intersect%27"><a href="Database.Relational.Query.Relation.html#intersect%27"><span class="hs-identifier">intersect'</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#liftAppend%27"><span class="hs-identifier hs-var">liftAppend'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Sub.html#intersect"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">intersect</span></a><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#Distinct"><span class="hs-identifier hs-var">Distinct</span></a><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-comment">-- | Intersection of two relations with place-holder parameters. Not distinct.</span><span>
</span><a name="line-314"></a><span class="hs-identifier">intersectAll'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356149"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356150"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356151"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679356150"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356149"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356151"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356150"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-315"></a><a name="intersectAll%27"><a href="Database.Relational.Query.Relation.html#intersectAll%27"><span class="hs-identifier">intersectAll'</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#liftAppend%27"><span class="hs-identifier hs-var">liftAppend'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Sub.html#intersect"><span class="hs-identifier hs-var">SubQuery</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">intersect</span></a><span> </span><a href="Database.Relational.Query.Internal.BaseSQL.html#All"><span class="hs-identifier hs-var">All</span></a><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">7</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">union</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">except</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">unionAll</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">exceptAll</span><span class="hs-special">`</span><span>
</span><a name="line-318"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">intersect</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">intersectAll</span><span class="hs-special">`</span><span>
</span><a name="line-319"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">7</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">union'</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">except'</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">unionAll'</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">exceptAll'</span><span class="hs-special">`</span><span>
</span><a name="line-320"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">intersect'</span><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">intersectAll'</span><span class="hs-special">`</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-comment">{-
-- | Get projection width from 'Relation'.
width :: Relation p r -&gt; Int
width =  SubQuery.width . subQueryFromRelation
-}</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-comment">-- | Unique relation type to compose scalar queries.</span><span>
</span><a name="line-329"></a><span class="hs-keyword">newtype</span><span> </span><a name="UniqueRelation"><a href="Database.Relational.Query.Relation.html#UniqueRelation"><span class="hs-identifier">UniqueRelation</span></a></a><span> </span><a name="local-6989586621679356115"><a href="#local-6989586621679356115"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679356116"><a href="#local-6989586621679356116"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679356117"><a href="#local-6989586621679356117"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a name="Unique"><a href="Database.Relational.Query.Relation.html#Unique"><span class="hs-identifier">Unique</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356115"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356117"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span class="hs-comment">-- | Unsafely specify unique relation.</span><span>
</span><a name="line-332"></a><span class="hs-identifier">unsafeUnique</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356146"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356147"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Relation.html#UniqueRelation"><span class="hs-identifier hs-type">UniqueRelation</span></a><span> </span><a href="#local-6989586621679356146"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356148"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679356147"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-333"></a><a name="unsafeUnique"><a href="Database.Relational.Query.Relation.html#unsafeUnique"><span class="hs-identifier">unsafeUnique</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#Unique"><span class="hs-identifier hs-var">Unique</span></a><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">-- | Discard unique attribute.</span><span>
</span><a name="line-336"></a><span class="hs-identifier">unUnique</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Relation.html#UniqueRelation"><span class="hs-identifier hs-type">UniqueRelation</span></a><span> </span><a href="#local-6989586621679356143"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356144"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679356145"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356143"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356145"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-337"></a><a name="unUnique"><a href="Database.Relational.Query.Relation.html#unUnique"><span class="hs-identifier">unUnique</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Relation.html#Unique"><span class="hs-identifier hs-var">Unique</span></a><span> </span><a name="local-6989586621679356271"><a href="#local-6989586621679356271"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679356271"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-comment">-- | Basic monadic join operation using 'MonadQuery'.</span><span>
</span><a name="line-340"></a><span class="hs-identifier">uniqueQueryWithAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#NodeAttr"><span class="hs-identifier hs-type">NodeAttr</span></a><span>
</span><a name="line-341"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Relation.html#UniqueRelation"><span class="hs-identifier hs-type">UniqueRelation</span></a><span> </span><a href="#local-6989586621679356140"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356141"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679356142"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-342"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.Unique.html#QueryUnique"><span class="hs-identifier hs-type">QueryUnique</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Projectable.html#PlaceHolders"><span class="hs-identifier hs-type">PlaceHolders</span></a><span> </span><a href="#local-6989586621679356140"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="#local-6989586621679356141"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679356142"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-343"></a><a name="uniqueQueryWithAttr"><a href="Database.Relational.Query.Relation.html#uniqueQueryWithAttr"><span class="hs-identifier">uniqueQueryWithAttr</span></a></a><span> </span><a name="local-6989586621679356272"><a href="#local-6989586621679356272"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Relational.Query.Projectable.html#unsafeAddPlaceHolders"><span class="hs-identifier hs-var">unsafeAddPlaceHolders</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679356273"><span class="hs-identifier hs-var">run</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-344"></a><span>  </span><a name="local-6989586621679356273"><a href="#local-6989586621679356273"><span class="hs-identifier">run</span></a></a><span> </span><a name="local-6989586621679356274"><a href="#local-6989586621679356274"><span class="hs-identifier">rel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-345"></a><span>    </span><a name="local-6989586621679356276"><a href="#local-6989586621679356276"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#liftQualify"><span class="hs-identifier hs-var">liftQualify</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-346"></a><span>      </span><a name="local-6989586621679356275"><a href="#local-6989586621679356275"><span class="hs-identifier">sq</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#untypeRelation"><span class="hs-identifier hs-var">untypeRelation</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Relation.html#unUnique"><span class="hs-identifier hs-var">unUnique</span></a><span> </span><a href="#local-6989586621679356274"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">)</span><span>
</span><a name="line-347"></a><span>      </span><a href="Database.Relational.Query.Monad.BaseType.html#qualifyQuery"><span class="hs-identifier hs-var">qualifyQuery</span></a><span> </span><a href="#local-6989586621679356275"><span class="hs-identifier hs-var">sq</span></a><span>
</span><a name="line-348"></a><span>    </span><a href="Database.Relational.Query.Projection.html#unsafeChangeContext"><span class="hs-identifier hs-var">Projection</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeChangeContext</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Relational.Query.Monad.Unique.html#unsafeUniqueSubQuery"><span class="hs-identifier hs-var">unsafeUniqueSubQuery</span></a><span> </span><a href="#local-6989586621679356272"><span class="hs-identifier hs-var">attr</span></a><span> </span><a href="#local-6989586621679356276"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-comment">-- | Join unique sub-query with place-holder parameter 'p'.</span><span>
</span><a name="line-351"></a><span class="hs-identifier">uniqueQuery'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Relation.html#UniqueRelation"><span class="hs-identifier hs-type">UniqueRelation</span></a><span> </span><a href="#local-6989586621679356137"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356138"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679356139"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-352"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.Unique.html#QueryUnique"><span class="hs-identifier hs-type">QueryUnique</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Projectable.html#PlaceHolders"><span class="hs-identifier hs-type">PlaceHolders</span></a><span> </span><a href="#local-6989586621679356137"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="#local-6989586621679356138"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679356139"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-353"></a><a name="uniqueQuery%27"><a href="Database.Relational.Query.Relation.html#uniqueQuery%27"><span class="hs-identifier">uniqueQuery'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Relational.Query.Relation.html#uniqueQueryWithAttr"><span class="hs-identifier hs-var">uniqueQueryWithAttr</span></a><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Just%27"><span class="hs-identifier hs-var">Just'</span></a><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-comment">-- | Join unique sub-query with place-holder parameter 'p'. Query result is 'Maybe'.</span><span>
</span><a name="line-356"></a><span class="hs-identifier">uniqueQueryMaybe'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Relation.html#UniqueRelation"><span class="hs-identifier hs-type">UniqueRelation</span></a><span> </span><a href="#local-6989586621679356134"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356135"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679356136"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-357"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Monad.Unique.html#QueryUnique"><span class="hs-identifier hs-type">QueryUnique</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Projectable.html#PlaceHolders"><span class="hs-identifier hs-type">PlaceHolders</span></a><span> </span><a href="#local-6989586621679356134"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="#local-6989586621679356135"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356136"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-358"></a><a name="uniqueQueryMaybe%27"><a href="Database.Relational.Query.Relation.html#uniqueQueryMaybe%27"><span class="hs-identifier">uniqueQueryMaybe'</span></a></a><span> </span><a name="local-6989586621679356277"><a href="#local-6989586621679356277"><span class="hs-identifier">pr</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-359"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679356278"><a href="#local-6989586621679356278"><span class="hs-identifier">ph</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679356279"><a href="#local-6989586621679356279"><span class="hs-identifier">pj</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Relational.Query.Relation.html#uniqueQueryWithAttr"><span class="hs-identifier hs-var">uniqueQueryWithAttr</span></a><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Maybe"><span class="hs-identifier hs-var">Maybe</span></a><span> </span><a href="#local-6989586621679356277"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-360"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356278"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Projection.html#just"><span class="hs-identifier hs-var">Projection</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">just</span></a><span> </span><a href="#local-6989586621679356279"><span class="hs-identifier hs-var">pj</span></a><span class="hs-special">)</span><span>
</span><a name="line-361"></a><span>
</span><a name="line-362"></a><span class="hs-comment">-- | Finalize 'QueryUnique' monad and generate 'UniqueRelation'.</span><span>
</span><a name="line-363"></a><span class="hs-identifier">uniqueRelation'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.Unique.html#QueryUnique"><span class="hs-identifier hs-type">QueryUnique</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Projectable.html#PlaceHolders"><span class="hs-identifier hs-type">PlaceHolders</span></a><span> </span><a href="#local-6989586621679356131"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="#local-6989586621679356132"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679356133"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Relation.html#UniqueRelation"><span class="hs-identifier hs-type">UniqueRelation</span></a><span> </span><a href="#local-6989586621679356131"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356132"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679356133"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-364"></a><a name="uniqueRelation%27"><a href="Database.Relational.Query.Relation.html#uniqueRelation%27"><span class="hs-identifier">uniqueRelation'</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Relational.Query.Relation.html#unsafeUnique"><span class="hs-identifier hs-var">unsafeUnique</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#unsafeTypeRelation"><span class="hs-identifier hs-var">unsafeTypeRelation</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Monad.Unique.html#toSubQuery"><span class="hs-identifier hs-var">Unique</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toSubQuery</span></a><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span class="hs-comment">-- | Aggregated 'UniqueRelation'.</span><span>
</span><a name="line-367"></a><span class="hs-identifier">aggregatedUnique</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a><span> </span><a href="#local-6989586621679356127"><span class="hs-identifier hs-type">ph</span></a><span> </span><a href="#local-6989586621679356128"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-368"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Pi.Unsafe.html#Pi"><span class="hs-identifier hs-type">Pi</span></a><span> </span><a href="#local-6989586621679356128"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679356129"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-369"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span> </span><a href="#local-6989586621679356129"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Aggregated"><span class="hs-identifier hs-type">Aggregated</span></a><span> </span><a href="#local-6989586621679356130"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-370"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Relational.Query.Relation.html#UniqueRelation"><span class="hs-identifier hs-type">UniqueRelation</span></a><span> </span><a href="#local-6989586621679356127"><span class="hs-identifier hs-type">ph</span></a><span> </span><a href="Database.Relational.Query.Internal.ContextType.html#Flat"><span class="hs-identifier hs-type">Flat</span></a><span> </span><a href="#local-6989586621679356130"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-371"></a><a name="aggregatedUnique"><a href="Database.Relational.Query.Relation.html#aggregatedUnique"><span class="hs-identifier">aggregatedUnique</span></a></a><span> </span><a name="local-6989586621679356280"><a href="#local-6989586621679356280"><span class="hs-identifier">rel</span></a></a><span> </span><a name="local-6989586621679356281"><a href="#local-6989586621679356281"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679356282"><a href="#local-6989586621679356282"><span class="hs-identifier">ag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Relational.Query.Relation.html#unsafeUnique"><span class="hs-identifier hs-var">unsafeUnique</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Relation.html#aggregateRelation%27"><span class="hs-identifier hs-var">aggregateRelation'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-372"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679356283"><a href="#local-6989586621679356283"><span class="hs-identifier">ph</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679356284"><a href="#local-6989586621679356284"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#query%27"><span class="hs-identifier hs-var">query'</span></a><span> </span><a href="#local-6989586621679356280"><span class="hs-identifier hs-var">rel</span></a><span>
</span><a name="line-373"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679356283"><span class="hs-identifier hs-var">ph</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679356282"><span class="hs-identifier hs-var">ag</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Relational.Query.Projection.html#wpi"><span class="hs-identifier hs-var">Projection</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">wpi</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.BaseType.html#relationWidth"><span class="hs-identifier hs-var">relationWidth</span></a><span> </span><a href="#local-6989586621679356280"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356284"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679356281"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-comment">-- | Scalar sub-query with place-holder parameter 'p'.</span><span>
</span><a name="line-376"></a><span class="hs-identifier">queryScalar'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.Class.html#MonadQualify"><span class="hs-identifier hs-type">MonadQualify</span></a><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#ConfigureQuery"><span class="hs-identifier hs-type">ConfigureQuery</span></a><span> </span><a href="#local-6989586621679356123"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Scalar.html#ScalarDegree"><span class="hs-identifier hs-type">ScalarDegree</span></a><span> </span><a href="#local-6989586621679356124"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-377"></a><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Relational.Query.Relation.html#UniqueRelation"><span class="hs-identifier hs-type">UniqueRelation</span></a><span> </span><a href="#local-6989586621679356125"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679356126"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679356124"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-378"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679356123"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Projectable.html#PlaceHolders"><span class="hs-identifier hs-type">PlaceHolders</span></a><span> </span><a href="#local-6989586621679356125"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="#local-6989586621679356126"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356124"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-379"></a><a name="queryScalar%27"><a href="Database.Relational.Query.Relation.html#queryScalar%27"><span class="hs-identifier">queryScalar'</span></a></a><span> </span><a name="local-6989586621679356285"><a href="#local-6989586621679356285"><span class="hs-identifier">ur</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-380"></a><span>  </span><a href="Database.Relational.Query.Projectable.html#unsafeAddPlaceHolders"><span class="hs-identifier hs-var">unsafeAddPlaceHolders</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Monad.Class.html#liftQualify"><span class="hs-identifier hs-var">liftQualify</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-381"></a><span>  </span><a href="Database.Relational.Query.Projection.html#unsafeFromScalarSubQuery"><span class="hs-identifier hs-var">Projection</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeFromScalarSubQuery</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#untypeRelation"><span class="hs-identifier hs-var">untypeRelation</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Relation.html#unUnique"><span class="hs-identifier hs-var">unUnique</span></a><span> </span><a href="#local-6989586621679356285"><span class="hs-identifier hs-var">ur</span></a><span class="hs-special">)</span><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span class="hs-comment">-- | Scalar sub-query.</span><span>
</span><a name="line-384"></a><span class="hs-identifier">queryScalar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Monad.Class.html#MonadQualify"><span class="hs-identifier hs-type">MonadQualify</span></a><span> </span><a href="Database.Relational.Query.Monad.BaseType.html#ConfigureQuery"><span class="hs-identifier hs-type">ConfigureQuery</span></a><span> </span><a href="#local-6989586621679356120"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="Database.Relational.Query.Scalar.html#ScalarDegree"><span class="hs-identifier hs-type">ScalarDegree</span></a><span> </span><a href="#local-6989586621679356121"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-385"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Relational.Query.Relation.html#UniqueRelation"><span class="hs-identifier hs-type">UniqueRelation</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679356122"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679356121"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-386"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679356120"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Database.Relational.Query.Internal.Sub.html#Projection"><span class="hs-identifier hs-type">Projection</span></a><span> </span><a href="#local-6989586621679356122"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679356121"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-387"></a><a name="queryScalar"><a href="Database.Relational.Query.Relation.html#queryScalar"><span class="hs-identifier">queryScalar</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Relational.Query.Relation.html#queryScalar%27"><span class="hs-identifier hs-var">queryScalar'</span></a><span>
</span><a name="line-388"></a></pre></body></html>