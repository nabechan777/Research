<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------------------</span><span>
</span><a name="line-2"></a><span class="hs-comment">{-|
Module      :  Print
Copyright   :  (c) Daan Leijen 2003
License     :  wxWindows

Maintainer  :  wxhaskell-devel@lists.sourceforge.net
Stability   :  provisional
Portability :  portable

Printer abstraction layer. See @samples\/wx\/Print.hs@ for a demo.

The application should create a 'pageSetupDialog' to hold the printer
settings of the user.

&gt; f &lt;- frame [text := &quot;Print demo&quot;]                               
&gt; 
&gt; -- Create a pageSetup dialog with an initial margin of 25 mm.
&gt; pageSetup &lt;- pageSetupDialog f 25

The dialog can be shown using 'pageSetupShowModal'. Furthermore, the 
function 'printDialog' and 'printPreview' can be used to show a print dialog
and preview window.

&gt; mprint   &lt;- menuItem file 
&gt;                [ text := &quot;&amp;Print...&quot;
&gt;                , help := &quot;Print a test&quot;
&gt;                , on command := printDialog pageSetup &quot;Test&quot;  pageFun printFun
&gt;                ]
&gt; mpreview &lt;- menuItem file 
&gt;                [ text := &quot;&amp;Print preview&quot;
&gt;                , help := &quot;Print preview&quot;
&gt;                , on command := printPreview pageSetup &quot;Test&quot; pageFun printFun 

Those functions take a 'PageFunction' and 'PrintFunction' respectively that get called
to determine the number of needed pages and to draw on the printer DC respectively.
The framework takes automatic care of printer margins, preview scaling etc.

-}</span><span></span><span>
</span><a name="line-40"></a><span class="hs-comment">-----------------------------------------------------------------------------------------</span><span>
</span><a name="line-41"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WXCore</span><span class="hs-operator">.</span><span class="hs-identifier">Print</span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- * Printing</span><span>
</span><a name="line-42"></a><span>                                 </span><a href="Graphics.UI.WXCore.Print.html#pageSetupDialog"><span class="hs-identifier hs-var">pageSetupDialog</span></a><span></span><span>
</span><a name="line-43"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WXCore.Print.html#pageSetupShowModal"><span class="hs-identifier hs-var">pageSetupShowModal</span></a><span></span><span>
</span><a name="line-44"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WXCore.Print.html#printDialog"><span class="hs-identifier hs-var">printDialog</span></a><span></span><span>
</span><a name="line-45"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WXCore.Print.html#printPreview"><span class="hs-identifier hs-var">printPreview</span></a><span></span><span>
</span><a name="line-46"></a><span>                                 </span><span class="hs-comment">-- * Callbacks</span><span>
</span><a name="line-47"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageFunction"><span class="hs-identifier hs-type">PageFunction</span></a><span></span><span>
</span><a name="line-48"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintFunction"><span class="hs-identifier hs-type">PrintFunction</span></a><span></span><span>
</span><a name="line-49"></a><span>                                 </span><span class="hs-comment">-- * Page and printer info</span><span>
</span><a name="line-50"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier hs-type">PageInfo</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-51"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintInfo"><span class="hs-identifier hs-type">PrintInfo</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-52"></a><span>                                 </span><span class="hs-comment">-- * Internal</span><span>
</span><a name="line-53"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WXCore.Print.html#pageSetupDataGetPageInfo"><span class="hs-identifier hs-var">pageSetupDataGetPageInfo</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WXCore.Print.html#pageSetupDataSetPageInfo"><span class="hs-identifier hs-var">pageSetupDataSetPageInfo</span></a><span></span><span>
</span><a name="line-54"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WXCore.Print.html#printOutGetPrintInfo"><span class="hs-identifier hs-var">printOutGetPrintInfo</span></a><span></span><span>
</span><a name="line-55"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WXCore.Print.html#pageSetupDialogGetFrame"><span class="hs-identifier hs-var">pageSetupDialogGetFrame</span></a><span></span><span>
</span><a name="line-56"></a><span>                               </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-57"></a><span></span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.UI.WXCore.WxcClasses.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WXCore</span><span class="hs-operator">.</span><span class="hs-identifier">WxcClasses</span></a><span></span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.UI.WXCore.WxcClassInfo.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WXCore</span><span class="hs-operator">.</span><span class="hs-identifier">WxcClassInfo</span></a><span></span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.UI.WXCore.Types.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WXCore</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span></span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.UI.WXCore.Events.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WXCore</span><span class="hs-operator">.</span><span class="hs-identifier">Events</span></a><span></span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.UI.WXCore.Frame.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WXCore</span><span class="hs-operator">.</span><span class="hs-identifier">Frame</span></a><span></span><span>
</span><a name="line-63"></a><span></span><span>
</span><a name="line-64"></a><span class="hs-comment">-- | Return a page range given page info, print info, and the printable size.</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- The printable size is the number of pixels available for printing </span><span>
</span><a name="line-66"></a><span class="hs-comment">-- without the page margins.</span><span>
</span><a name="line-67"></a><span class="hs-keyword">type</span><span> </span><a name="PageFunction"><a href="Graphics.UI.WXCore.Print.html#PageFunction"><span class="hs-identifier">PageFunction</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier hs-type">PageInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintInfo"><span class="hs-identifier hs-type">PrintInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-68"></a><span></span><span>
</span><a name="line-69"></a><span class="hs-comment">-- | Print a page given page info, print info, the printable size, the</span><span>
</span><a name="line-70"></a><span class="hs-comment">-- printer device context and the current page.</span><span>
</span><a name="line-71"></a><span class="hs-comment">-- The printable size is the number of pixels available for printing </span><span>
</span><a name="line-72"></a><span class="hs-comment">-- without the page margins</span><span>
</span><a name="line-73"></a><span class="hs-keyword">type</span><span> </span><a name="PrintFunction"><a href="Graphics.UI.WXCore.Print.html#PrintFunction"><span class="hs-identifier">PrintFunction</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier hs-type">PageInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintInfo"><span class="hs-identifier hs-type">PrintInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#DC"><span class="hs-identifier hs-type">DC</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-74"></a><span></span><span>
</span><a name="line-75"></a><span></span><span>
</span><a name="line-76"></a><span class="hs-comment">{--------------------------------------------------------------------------
   Handle print events
--------------------------------------------------------------------------}</span><span>  </span><span>
</span><a name="line-79"></a><span class="hs-comment">-- | The standard print event handler</span><span>
</span><a name="line-80"></a><span class="hs-identifier">onPrint</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-comment">{- preview? -}</span><span> </span><span>
</span><a name="line-81"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier hs-type">PageInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#Printout"><span class="hs-identifier hs-type">Printout</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcClassTypes.html#CWXCPrintout"><span class="hs-identifier hs-type">CWXCPrintout</span></a><span> </span><a href="#local-6989586621679279132"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-82"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageFunction"><span class="hs-identifier hs-type">PageFunction</span></a><span></span><span>
</span><a name="line-83"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintFunction"><span class="hs-identifier hs-type">PrintFunction</span></a><span> </span><span>
</span><a name="line-84"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Events.html#EventPrint"><span class="hs-identifier hs-type">EventPrint</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-85"></a><a name="onPrint"><a href="Graphics.UI.WXCore.Print.html#onPrint"><span class="hs-identifier">onPrint</span></a></a><span> </span><a name="local-6989586621679279133"><a href="#local-6989586621679279133"><span class="hs-identifier">isPreview</span></a></a><span> </span><a name="local-6989586621679279134"><a href="#local-6989586621679279134"><span class="hs-identifier">pageInfo</span></a></a><span> </span><a name="local-6989586621679279135"><a href="#local-6989586621679279135"><span class="hs-identifier">printOut</span></a></a><span> </span><a name="local-6989586621679279136"><a href="#local-6989586621679279136"><span class="hs-identifier">pageRangeFunction</span></a></a><span> </span><a name="local-6989586621679279137"><a href="#local-6989586621679279137"><span class="hs-identifier">printFunction</span></a></a><span> </span><a name="local-6989586621679279138"><a href="#local-6989586621679279138"><span class="hs-identifier">ev</span></a></a><span> </span><span>
</span><a name="line-86"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679279138"><span class="hs-identifier hs-var">ev</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-87"></a><span>      </span><a href="Graphics.UI.WXCore.Events.html#PrintPrepare"><span class="hs-identifier hs-var">PrintPrepare</span></a><span> </span><span class="hs-glyph">-&gt;</span><span></span><span>
</span><a name="line-88"></a><span>        </span><a href="Graphics.UI.WXCore.Print.html#printOutInitPageRange"><span class="hs-identifier hs-var">printOutInitPageRange</span></a><span> </span><a href="#local-6989586621679279135"><span class="hs-identifier hs-var">printOut</span></a><span> </span><a href="#local-6989586621679279134"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279136"><span class="hs-identifier hs-var">pageRangeFunction</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span></span><span>
</span><a name="line-89"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-90"></a><span></span><span>
</span><a name="line-91"></a><span>      </span><a href="Graphics.UI.WXCore.Events.html#PrintPage"><span class="hs-identifier hs-var">PrintPage</span></a><span> </span><a name="local-6989586621679279139"><a href="#local-6989586621679279139"><span class="hs-identifier">_cancel</span></a></a><span> </span><a name="local-6989586621679279140"><a href="#local-6989586621679279140"><span class="hs-identifier">dc</span></a></a><span> </span><a name="local-6989586621679279141"><a href="#local-6989586621679279141"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span></span><span>
</span><a name="line-92"></a><span>        </span><span class="hs-keyword">do</span><span class="hs-special">{</span><span> </span><a name="local-6989586621679279142"><a href="#local-6989586621679279142"><span class="hs-identifier">printInfo</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.Print.html#printOutGetPrintInfo"><span class="hs-identifier hs-var">printOutGetPrintInfo</span></a><span> </span><a href="#local-6989586621679279135"><span class="hs-identifier hs-var">printOut</span></a><span></span><span>
</span><a name="line-93"></a><span>          </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679279143"><a href="#local-6989586621679279143"><span class="hs-identifier">io</span></a></a><span> </span><a name="local-6989586621679279144"><a href="#local-6989586621679279144"><span class="hs-identifier">info</span></a></a><span> </span><a name="local-6989586621679279145"><a href="#local-6989586621679279145"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679279137"><span class="hs-identifier hs-var">printFunction</span></a><span> </span><a href="#local-6989586621679279134"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279144"><span class="hs-identifier hs-var">info</span></a><span> </span><a href="#local-6989586621679279145"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679279140"><span class="hs-identifier hs-var">dc</span></a><span> </span><a href="#local-6989586621679279141"><span class="hs-identifier hs-var">n</span></a><span> </span><span>
</span><a name="line-94"></a><span>          </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679279133"><span class="hs-identifier hs-var">isPreview</span></a><span> </span><span>
</span><a name="line-95"></a><span>             </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679279146"><a href="#local-6989586621679279146"><span class="hs-identifier">previewInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Print.html#toScreenInfo"><span class="hs-identifier hs-var">toScreenInfo</span></a><span> </span><a href="#local-6989586621679279142"><span class="hs-identifier hs-var">printInfo</span></a><span></span><span>
</span><a name="line-96"></a><span>                     </span><span class="hs-special">(</span><a name="local-6989586621679279147"><a href="#local-6989586621679279147"><span class="hs-identifier">scaleX</span></a></a><span class="hs-special">,</span><a name="local-6989586621679279148"><a href="#local-6989586621679279148"><span class="hs-identifier">scaleY</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.Print.html#getPreviewZoom"><span class="hs-identifier hs-var">getPreviewZoom</span></a><span> </span><a href="#local-6989586621679279134"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279146"><span class="hs-identifier hs-var">previewInfo</span></a><span> </span><a href="#local-6989586621679279140"><span class="hs-identifier hs-var">dc</span></a><span>                     </span><span>
</span><a name="line-97"></a><span>                     </span><a href="Graphics.UI.WXCore.Print.html#dcScale"><span class="hs-identifier hs-var">dcScale</span></a><span> </span><a href="#local-6989586621679279140"><span class="hs-identifier hs-var">dc</span></a><span> </span><a href="#local-6989586621679279147"><span class="hs-identifier hs-var">scaleX</span></a><span> </span><a href="#local-6989586621679279148"><span class="hs-identifier hs-var">scaleY</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#respectMargin"><span class="hs-identifier hs-var">respectMargin</span></a><span> </span><a href="#local-6989586621679279134"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279146"><span class="hs-identifier hs-var">previewInfo</span></a><span> </span><a href="#local-6989586621679279140"><span class="hs-identifier hs-var">dc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279143"><span class="hs-identifier hs-var">io</span></a><span> </span><a href="#local-6989586621679279146"><span class="hs-identifier hs-var">previewInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-98"></a><span>             </span><span class="hs-keyword">else</span><span> </span><a href="Graphics.UI.WXCore.Print.html#respectMargin"><span class="hs-identifier hs-var">respectMargin</span></a><span> </span><a href="#local-6989586621679279134"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279142"><span class="hs-identifier hs-var">printInfo</span></a><span> </span><a href="#local-6989586621679279140"><span class="hs-identifier hs-var">dc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279143"><span class="hs-identifier hs-var">io</span></a><span> </span><a href="#local-6989586621679279142"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-99"></a><span>          </span><span class="hs-special">}</span><span>        </span><span>
</span><a name="line-100"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-101"></a><span></span><span>
</span><a name="line-102"></a><span></span><span>
</span><a name="line-103"></a><span class="hs-comment">-- | Set a clipping region and device origin according to the margin</span><span>
</span><a name="line-104"></a><span class="hs-identifier">respectMargin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier hs-type">PageInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintInfo"><span class="hs-identifier hs-type">PrintInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#DC"><span class="hs-identifier hs-type">DC</span></a><span> </span><a href="#local-6989586621679279130"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcTypes.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679279131"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679279131"><span class="hs-identifier hs-type">b</span></a><span></span><span>
</span><a name="line-105"></a><a name="respectMargin"><a href="Graphics.UI.WXCore.Print.html#respectMargin"><span class="hs-identifier">respectMargin</span></a></a><span> </span><a name="local-6989586621679279149"><a href="#local-6989586621679279149"><span class="hs-identifier">pageInfo</span></a></a><span> </span><a name="local-6989586621679279150"><a href="#local-6989586621679279150"><span class="hs-identifier">printInfo</span></a></a><span> </span><a name="local-6989586621679279151"><a href="#local-6989586621679279151"><span class="hs-identifier">dc</span></a></a><span> </span><a name="local-6989586621679279152"><a href="#local-6989586621679279152"><span class="hs-identifier">io</span></a></a><span></span><span>
</span><a name="line-106"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679279153"><a href="#local-6989586621679279153"><span class="hs-identifier">left</span></a></a><span class="hs-special">,</span><a name="local-6989586621679279154"><a href="#local-6989586621679279154"><span class="hs-identifier">top</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><a name="local-6989586621679279155"><a href="#local-6989586621679279155"><span class="hs-identifier">printSize</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Print.html#printableArea"><span class="hs-identifier hs-var">printableArea</span></a><span> </span><a href="#local-6989586621679279149"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279150"><span class="hs-identifier hs-var">printInfo</span></a><span></span><span>
</span><a name="line-107"></a><span></span><span>
</span><a name="line-108"></a><span>       </span><span class="hs-comment">-- the device origin is in unscaled coordinates</span><span>
</span><a name="line-109"></a><span>       </span><a name="local-6989586621679279156"><a href="#local-6989586621679279156"><span class="hs-identifier">scaleX</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesAL.html#dcGetUserScaleX"><span class="hs-identifier hs-var">dcGetUserScaleX</span></a><span> </span><a href="#local-6989586621679279151"><span class="hs-identifier hs-var">dc</span></a><span></span><span>
</span><a name="line-110"></a><span>       </span><a name="local-6989586621679279157"><a href="#local-6989586621679279157"><span class="hs-identifier">scaleY</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesAL.html#dcGetUserScaleY"><span class="hs-identifier hs-var">dcGetUserScaleY</span></a><span> </span><a href="#local-6989586621679279151"><span class="hs-identifier hs-var">dc</span></a><span></span><span>
</span><a name="line-111"></a><span>       </span><a href="Graphics.UI.WXCore.WxcClassesAL.html#dcSetDeviceOrigin"><span class="hs-identifier hs-var">dcSetDeviceOrigin</span></a><span> </span><a href="#local-6989586621679279151"><span class="hs-identifier hs-var">dc</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcTypes.html#pt"><span class="hs-identifier hs-var">pt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">round</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279156"><span class="hs-identifier hs-var">scaleX</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679279153"><span class="hs-identifier hs-var">left</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">round</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279157"><span class="hs-identifier hs-var">scaleY</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679279154"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-112"></a><span></span><span>
</span><a name="line-113"></a><span>       </span><span class="hs-comment">-- the clipping respects the scaling</span><span>
</span><a name="line-114"></a><span>       </span><a href="Graphics.UI.WXCore.WxcClassesAL.html#dcSetClippingRegion"><span class="hs-identifier hs-var">dcSetClippingRegion</span></a><span> </span><a href="#local-6989586621679279151"><span class="hs-identifier hs-var">dc</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcTypes.html#rect"><span class="hs-identifier hs-var">rect</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcTypes.html#pt"><span class="hs-identifier hs-var">pt</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679279155"><span class="hs-identifier hs-var">printSize</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-115"></a><span>       </span><a href="#local-6989586621679279152"><span class="hs-identifier hs-var">io</span></a><span> </span><a href="#local-6989586621679279155"><span class="hs-identifier hs-var">printSize</span></a><span></span><span>
</span><a name="line-116"></a><span></span><span>
</span><a name="line-117"></a><span class="hs-comment">-- | Calculate the printable area</span><span>
</span><a name="line-118"></a><span class="hs-identifier">printableArea</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier hs-type">PageInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintInfo"><span class="hs-identifier hs-type">PrintInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span class="hs-special">,</span><a href="Graphics.UI.WXCore.WxcTypes.html#Size"><span class="hs-identifier hs-type">Size</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-119"></a><a name="printableArea"><a href="Graphics.UI.WXCore.Print.html#printableArea"><span class="hs-identifier">printableArea</span></a></a><span> </span><a name="local-6989586621679279158"><a href="#local-6989586621679279158"><span class="hs-identifier">pageInfo</span></a></a><span> </span><a name="local-6989586621679279159"><a href="#local-6989586621679279159"><span class="hs-identifier">printInfo</span></a></a><span></span><span>
</span><a name="line-120"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679279160"><a href="#local-6989586621679279160"><span class="hs-identifier">printW</span></a></a><span class="hs-special">,</span><a name="local-6989586621679279161"><a href="#local-6989586621679279161"><span class="hs-identifier">printH</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Print.html#pixelToMM"><span class="hs-identifier hs-var">pixelToMM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">printerPPI</span><span> </span><a href="#local-6989586621679279159"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">printPageSize</span><span> </span><a href="#local-6989586621679279159"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-121"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679279162"><a href="#local-6989586621679279162"><span class="hs-identifier">ppmmW</span></a></a><span class="hs-special">,</span><a name="local-6989586621679279163"><a href="#local-6989586621679279163"><span class="hs-identifier">ppmmH</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Print.html#ppiToPPMM"><span class="hs-identifier hs-var">ppiToPPMM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">printerPPI</span><span> </span><a href="#local-6989586621679279159"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-122"></a><span></span><span>
</span><a name="line-123"></a><span>        </span><span class="hs-comment">-- calculate minimal printer margin</span><span>
</span><a name="line-124"></a><span>        </span><a name="local-6989586621679279164"><a href="#local-6989586621679279164"><span class="hs-identifier">minX</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sizeW</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pageSize</span><span> </span><a href="#local-6989586621679279158"><span class="hs-identifier hs-var">pageInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679279160"><span class="hs-identifier hs-var">printW</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span>  </span><span>
</span><a name="line-125"></a><span>        </span><a name="local-6989586621679279165"><a href="#local-6989586621679279165"><span class="hs-identifier">minY</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sizeH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pageSize</span><span> </span><a href="#local-6989586621679279158"><span class="hs-identifier hs-var">pageInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679279161"><span class="hs-identifier hs-var">printH</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span></span><span>
</span><a name="line-126"></a><span></span><span>
</span><a name="line-127"></a><span>        </span><span class="hs-comment">-- top-left margin</span><span>
</span><a name="line-128"></a><span>        </span><a name="local-6989586621679279166"><a href="#local-6989586621679279166"><span class="hs-identifier">top</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679279163"><span class="hs-identifier hs-var">ppmmH</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">max</span><span> </span><a href="#local-6989586621679279165"><span class="hs-identifier hs-var">minY</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">rectTop</span><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">pageArea</span><span> </span><a href="#local-6989586621679279158"><span class="hs-identifier hs-var">pageInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-129"></a><span>        </span><a name="local-6989586621679279167"><a href="#local-6989586621679279167"><span class="hs-identifier">left</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679279162"><span class="hs-identifier hs-var">ppmmW</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">max</span><span> </span><a href="#local-6989586621679279164"><span class="hs-identifier hs-var">minX</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">rectLeft</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">pageArea</span><span> </span><a href="#local-6989586621679279158"><span class="hs-identifier hs-var">pageInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-130"></a><span></span><span>
</span><a name="line-131"></a><span>        </span><span class="hs-comment">-- bottom-right margin</span><span>
</span><a name="line-132"></a><span>        </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcTypes.html#Point"><span class="hs-identifier hs-var">Point</span></a><span> </span><a name="local-6989586621679279168"><a href="#local-6989586621679279168"><span class="hs-identifier">mright</span></a></a><span> </span><a name="local-6989586621679279169"><a href="#local-6989586621679279169"><span class="hs-identifier">mbottom</span></a></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-133"></a><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Types.html#pointSub"><span class="hs-identifier hs-var">pointSub</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcTypes.html#pointFromSize"><span class="hs-identifier hs-var">pointFromSize</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pageSize</span><span> </span><a href="#local-6989586621679279158"><span class="hs-identifier hs-var">pageInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcTypes.html#rectBottomRight"><span class="hs-identifier hs-var">rectBottomRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pageArea</span><span> </span><a href="#local-6989586621679279158"><span class="hs-identifier hs-var">pageInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span>
</span><a name="line-134"></a><span>        </span><a name="local-6989586621679279170"><a href="#local-6989586621679279170"><span class="hs-identifier">bottom</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679279163"><span class="hs-identifier hs-var">ppmmH</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">max</span><span> </span><a href="#local-6989586621679279165"><span class="hs-identifier hs-var">minY</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><a href="#local-6989586621679279169"><span class="hs-identifier hs-var">mbottom</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-135"></a><span>        </span><a name="local-6989586621679279171"><a href="#local-6989586621679279171"><span class="hs-identifier">right</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679279162"><span class="hs-identifier hs-var">ppmmW</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">max</span><span> </span><a href="#local-6989586621679279164"><span class="hs-identifier hs-var">minX</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><a href="#local-6989586621679279168"><span class="hs-identifier hs-var">mright</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-136"></a><span></span><span>
</span><a name="line-137"></a><span>        </span><a name="local-6989586621679279172"><a href="#local-6989586621679279172"><span class="hs-identifier">dw</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">round</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279171"><span class="hs-identifier hs-var">right</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679279167"><span class="hs-identifier hs-var">left</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-138"></a><span>        </span><a name="local-6989586621679279173"><a href="#local-6989586621679279173"><span class="hs-identifier">dh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">round</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279170"><span class="hs-identifier hs-var">bottom</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679279166"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-139"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679279174"><a href="#local-6989586621679279174"><span class="hs-identifier">dw'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679279175"><a href="#local-6989586621679279175"><span class="hs-identifier">dh'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">sizeW</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">printPageSize</span><span> </span><a href="#local-6989586621679279159"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-identifier">sizeH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">printPageSize</span><span> </span><a href="#local-6989586621679279159"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-140"></a><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279172"><span class="hs-identifier hs-var">dw</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679279173"><span class="hs-identifier hs-var">dh</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-141"></a><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279173"><span class="hs-identifier hs-var">dh</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679279172"><span class="hs-identifier hs-var">dw</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-142"></a><span></span><span>
</span><a name="line-143"></a><span>        </span><span class="hs-comment">-- the actual printable page size</span><span>
</span><a name="line-144"></a><span>        </span><a name="local-6989586621679279176"><a href="#local-6989586621679279176"><span class="hs-identifier">printSize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#sz"><span class="hs-identifier hs-var">sz</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sizeW</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">printPageSize</span><span> </span><a href="#local-6989586621679279159"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679279174"><span class="hs-identifier hs-var">dw'</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-145"></a><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">sizeH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">printPageSize</span><span> </span><a href="#local-6989586621679279159"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679279175"><span class="hs-identifier hs-var">dh'</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-146"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679279167"><span class="hs-identifier hs-var">left</span></a><span class="hs-special">,</span><a href="#local-6989586621679279166"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679279176"><span class="hs-identifier hs-var">printSize</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-147"></a><span></span><span>
</span><a name="line-148"></a><span class="hs-comment">-- | Get the zoom factor from the preview </span><span>
</span><a name="line-149"></a><span class="hs-identifier">getPreviewZoom</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier hs-type">PageInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintInfo"><span class="hs-identifier hs-type">PrintInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#DC"><span class="hs-identifier hs-type">DC</span></a><span> </span><a href="#local-6989586621679279129"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-150"></a><a name="getPreviewZoom"><a href="Graphics.UI.WXCore.Print.html#getPreviewZoom"><span class="hs-identifier">getPreviewZoom</span></a></a><span> </span><a name="local-6989586621679279177"><a href="#local-6989586621679279177"><span class="hs-identifier">_pageInfo</span></a></a><span> </span><a name="local-6989586621679279178"><a href="#local-6989586621679279178"><span class="hs-identifier">printInfo</span></a></a><span> </span><a name="local-6989586621679279179"><a href="#local-6989586621679279179"><span class="hs-identifier">dc</span></a></a><span></span><span>
</span><a name="line-151"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679279180"><a href="#local-6989586621679279180"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesAL.html#dcGetSize"><span class="hs-identifier hs-var">dcGetSize</span></a><span> </span><a href="#local-6989586621679279179"><span class="hs-identifier hs-var">dc</span></a><span></span><span>
</span><a name="line-152"></a><span>       </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679279181"><a href="#local-6989586621679279181"><span class="hs-identifier">printW</span></a></a><span class="hs-special">,</span><a name="local-6989586621679279182"><a href="#local-6989586621679279182"><span class="hs-identifier">printH</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Print.html#pixelToMM"><span class="hs-identifier hs-var">pixelToMM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">printerPPI</span><span> </span><a href="#local-6989586621679279178"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">printPageSize</span><span> </span><a href="#local-6989586621679279178"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-153"></a><span>           </span><span class="hs-special">(</span><a name="local-6989586621679279183"><a href="#local-6989586621679279183"><span class="hs-identifier">screenW</span></a></a><span class="hs-special">,</span><a name="local-6989586621679279184"><a href="#local-6989586621679279184"><span class="hs-identifier">screenH</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Print.html#pixelToMM"><span class="hs-identifier hs-var">pixelToMM</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">screenPPI</span><span> </span><a href="#local-6989586621679279178"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679279180"><span class="hs-identifier hs-var">size</span></a><span></span><span>
</span><a name="line-154"></a><span>           </span><a name="local-6989586621679279185"><a href="#local-6989586621679279185"><span class="hs-identifier">scaleX</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679279183"><span class="hs-identifier hs-var">screenW</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679279181"><span class="hs-identifier hs-var">printW</span></a><span></span><span>
</span><a name="line-155"></a><span>           </span><a name="local-6989586621679279186"><a href="#local-6989586621679279186"><span class="hs-identifier">scaleY</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679279184"><span class="hs-identifier hs-var">screenH</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679279182"><span class="hs-identifier hs-var">printH</span></a><span></span><span>
</span><a name="line-156"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279185"><span class="hs-identifier hs-var">scaleX</span></a><span class="hs-special">,</span><a href="#local-6989586621679279186"><span class="hs-identifier hs-var">scaleY</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-157"></a><span></span><span>
</span><a name="line-158"></a><span></span><span>
</span><a name="line-159"></a><span class="hs-comment">-- | Transform printer info to screen printer info (for the preview).</span><span>
</span><a name="line-160"></a><span class="hs-identifier">toScreenInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintInfo"><span class="hs-identifier hs-type">PrintInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintInfo"><span class="hs-identifier hs-type">PrintInfo</span></a><span></span><span>
</span><a name="line-161"></a><a name="toScreenInfo"><a href="Graphics.UI.WXCore.Print.html#toScreenInfo"><span class="hs-identifier">toScreenInfo</span></a></a><span> </span><a name="local-6989586621679279187"><a href="#local-6989586621679279187"><span class="hs-identifier">printInfo</span></a></a><span></span><span>
</span><a name="line-162"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679279188"><a href="#local-6989586621679279188"><span class="hs-identifier">scaleX</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sizeW</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">screenPPI</span><span> </span><a href="#local-6989586621679279187"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sizeW</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">printerPPI</span><span> </span><a href="#local-6989586621679279187"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-163"></a><span>        </span><a name="local-6989586621679279189"><a href="#local-6989586621679279189"><span class="hs-identifier">scaleY</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sizeH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">screenPPI</span><span> </span><a href="#local-6989586621679279187"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sizeH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">printerPPI</span><span> </span><a href="#local-6989586621679279187"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-164"></a><span>        </span><a name="local-6989586621679279190"><a href="#local-6989586621679279190"><span class="hs-identifier">pxX</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">round</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279188"><span class="hs-identifier hs-var">scaleX</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sizeW</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">printPageSize</span><span> </span><a href="#local-6989586621679279187"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-165"></a><span>        </span><a name="local-6989586621679279191"><a href="#local-6989586621679279191"><span class="hs-identifier">pxY</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">round</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279189"><span class="hs-identifier hs-var">scaleY</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sizeH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">printPageSize</span><span> </span><a href="#local-6989586621679279187"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679279187"><span class="hs-identifier hs-var">printInfo</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">printerPPI</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">screenPPI</span><span> </span><a href="#local-6989586621679279187"><span class="hs-identifier hs-var">printInfo</span></a><span></span><span>
</span><a name="line-167"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">printPageSize</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#sz"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="#local-6989586621679279190"><span class="hs-identifier hs-var">pxX</span></a><span> </span><a href="#local-6989586621679279191"><span class="hs-identifier hs-var">pxY</span></a><span></span><span>
</span><a name="line-168"></a><span>                </span><span class="hs-special">}</span><span></span><span>
</span><a name="line-169"></a><span></span><span>
</span><a name="line-170"></a><span class="hs-comment">-- | Pixels to millimeters given a PPI</span><span>
</span><a name="line-171"></a><span class="hs-identifier">pixelToMM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-172"></a><a name="pixelToMM"><a href="Graphics.UI.WXCore.Print.html#pixelToMM"><span class="hs-identifier">pixelToMM</span></a></a><span> </span><a name="local-6989586621679279192"><a href="#local-6989586621679279192"><span class="hs-identifier">ppi</span></a></a><span> </span><a name="local-6989586621679279193"><a href="#local-6989586621679279193"><span class="hs-identifier">size</span></a></a><span></span><span>
</span><a name="line-173"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679279194"><a href="#local-6989586621679279194"><span class="hs-identifier">convert</span></a></a><span> </span><a name="local-6989586621679279195"><a href="#local-6989586621679279195"><span class="hs-identifier">f</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279195"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679279193"><span class="hs-identifier hs-var">size</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279195"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679279192"><span class="hs-identifier hs-var">ppi</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-number">25.4</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279194"><span class="hs-identifier hs-var">convert</span></a><span> </span><span class="hs-identifier">sizeW</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679279194"><span class="hs-identifier hs-var">convert</span></a><span> </span><span class="hs-identifier">sizeH</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-175"></a><span></span><span>
</span><a name="line-176"></a><span class="hs-comment">-- | pixels per inch to pixels per millimeter</span><span>
</span><a name="line-177"></a><span class="hs-identifier">ppiToPPMM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-178"></a><a name="ppiToPPMM"><a href="Graphics.UI.WXCore.Print.html#ppiToPPMM"><span class="hs-identifier">ppiToPPMM</span></a></a><span> </span><a name="local-6989586621679279196"><a href="#local-6989586621679279196"><span class="hs-identifier">ppi</span></a></a><span></span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679279197"><a href="#local-6989586621679279197"><span class="hs-identifier">convert</span></a></a><span> </span><a name="local-6989586621679279198"><a href="#local-6989586621679279198"><span class="hs-identifier">f</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279198"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679279196"><span class="hs-identifier hs-var">ppi</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-number">25.4</span><span></span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279197"><span class="hs-identifier hs-var">convert</span></a><span> </span><span class="hs-identifier">sizeW</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679279197"><span class="hs-identifier hs-var">convert</span></a><span> </span><span class="hs-identifier">sizeH</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-181"></a><span></span><span>
</span><a name="line-182"></a><span class="hs-comment">-- | Convert an 'Int' to a 'Double'.</span><span>
</span><a name="line-183"></a><span class="hs-identifier">toDouble</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span></span><span>
</span><a name="line-184"></a><a name="toDouble"><a href="Graphics.UI.WXCore.Print.html#toDouble"><span class="hs-identifier">toDouble</span></a></a><span> </span><a name="local-6989586621679279199"><a href="#local-6989586621679279199"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679279199"><span class="hs-identifier hs-var">i</span></a><span></span><span>
</span><a name="line-185"></a><span></span><span>
</span><a name="line-186"></a><span class="hs-comment">-- | Scale the 'DC'.</span><span>
</span><a name="line-187"></a><span class="hs-identifier">dcScale</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#DC"><span class="hs-identifier hs-type">DC</span></a><span> </span><a href="#local-6989586621679279127"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679279128"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679279128"><span class="hs-identifier hs-type">b</span></a><span></span><span>
</span><a name="line-188"></a><a name="dcScale"><a href="Graphics.UI.WXCore.Print.html#dcScale"><span class="hs-identifier">dcScale</span></a></a><span> </span><a name="local-6989586621679279200"><a href="#local-6989586621679279200"><span class="hs-identifier">dc</span></a></a><span> </span><a name="local-6989586621679279201"><a href="#local-6989586621679279201"><span class="hs-identifier">scaleX</span></a></a><span> </span><a name="local-6989586621679279202"><a href="#local-6989586621679279202"><span class="hs-identifier">scaleY</span></a></a><span> </span><a name="local-6989586621679279203"><a href="#local-6989586621679279203"><span class="hs-identifier">io</span></a></a><span></span><span>
</span><a name="line-189"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679279204"><a href="#local-6989586621679279204"><span class="hs-identifier">oldX</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesAL.html#dcGetUserScaleX"><span class="hs-identifier hs-var">dcGetUserScaleX</span></a><span> </span><a href="#local-6989586621679279200"><span class="hs-identifier hs-var">dc</span></a><span></span><span>
</span><a name="line-190"></a><span>       </span><a name="local-6989586621679279205"><a href="#local-6989586621679279205"><span class="hs-identifier">oldY</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesAL.html#dcGetUserScaleY"><span class="hs-identifier hs-var">dcGetUserScaleY</span></a><span> </span><a href="#local-6989586621679279200"><span class="hs-identifier hs-var">dc</span></a><span></span><span>
</span><a name="line-191"></a><span>       </span><a href="Graphics.UI.WXCore.WxcClassesAL.html#dcSetUserScale"><span class="hs-identifier hs-var">dcSetUserScale</span></a><span> </span><a href="#local-6989586621679279200"><span class="hs-identifier hs-var">dc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279204"><span class="hs-identifier hs-var">oldX</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679279201"><span class="hs-identifier hs-var">scaleX</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279205"><span class="hs-identifier hs-var">oldY</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679279202"><span class="hs-identifier hs-var">scaleY</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-192"></a><span>       </span><a name="local-6989586621679279206"><a href="#local-6989586621679279206"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679279203"><span class="hs-identifier hs-var">io</span></a><span></span><span>
</span><a name="line-193"></a><span>       </span><a href="Graphics.UI.WXCore.WxcClassesAL.html#dcSetUserScale"><span class="hs-identifier hs-var">dcSetUserScale</span></a><span> </span><a href="#local-6989586621679279200"><span class="hs-identifier hs-var">dc</span></a><span> </span><a href="#local-6989586621679279204"><span class="hs-identifier hs-var">oldX</span></a><span> </span><a href="#local-6989586621679279205"><span class="hs-identifier hs-var">oldY</span></a><span></span><span>
</span><a name="line-194"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679279206"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-195"></a><span></span><span>
</span><a name="line-196"></a><span class="hs-comment">{--------------------------------------------------------------------------
  preview and printIt
--------------------------------------------------------------------------}</span><span></span><span>
</span><a name="line-199"></a><span class="hs-comment">-- | Show a print dialog.</span><span>
</span><a name="line-200"></a><span class="hs-identifier">printDialog</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#PageSetupDialog"><span class="hs-identifier hs-type">PageSetupDialog</span></a><span> </span><a href="#local-6989586621679279126"><span class="hs-identifier hs-type">a</span></a><span> </span><span>
</span><a name="line-201"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span></span><span>
</span><a name="line-202"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageFunction"><span class="hs-identifier hs-type">PageFunction</span></a><span></span><span>
</span><a name="line-203"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintFunction"><span class="hs-identifier hs-type">PrintFunction</span></a><span> </span><span>
</span><a name="line-204"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-205"></a><a name="printDialog"><a href="Graphics.UI.WXCore.Print.html#printDialog"><span class="hs-identifier">printDialog</span></a></a><span> </span><a name="local-6989586621679279207"><a href="#local-6989586621679279207"><span class="hs-identifier">pageSetupDialog'</span></a></a><span> </span><a name="local-6989586621679279208"><a href="#local-6989586621679279208"><span class="hs-identifier">title</span></a></a><span> </span><a name="local-6989586621679279209"><a href="#local-6989586621679279209"><span class="hs-identifier">pageRangeFunction</span></a></a><span> </span><a name="local-6989586621679279210"><a href="#local-6989586621679279210"><span class="hs-identifier">printFunction</span></a></a><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-206"></a><span>  </span><span class="hs-keyword">do</span><span class="hs-special">{</span><span> </span><a name="local-6989586621679279211"><a href="#local-6989586621679279211"><span class="hs-identifier">pageSetupData</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#pageSetupDialogGetPageSetupData"><span class="hs-identifier hs-var">pageSetupDialogGetPageSetupData</span></a><span> </span><a href="#local-6989586621679279207"><span class="hs-identifier hs-var">pageSetupDialog'</span></a><span></span><span>
</span><a name="line-207"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279212"><a href="#local-6989586621679279212"><span class="hs-identifier">printData</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#pageSetupDialogDataGetPrintData"><span class="hs-identifier hs-var">pageSetupDialogDataGetPrintData</span></a><span> </span><a href="#local-6989586621679279211"><span class="hs-identifier hs-var">pageSetupData</span></a><span></span><span>
</span><a name="line-208"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279213"><a href="#local-6989586621679279213"><span class="hs-identifier">printDialogData</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#printDialogDataCreateFromData"><span class="hs-identifier hs-var">printDialogDataCreateFromData</span></a><span> </span><a href="#local-6989586621679279212"><span class="hs-identifier hs-var">printData</span></a><span></span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#printDialogDataSetAllPages"><span class="hs-identifier hs-var">printDialogDataSetAllPages</span></a><span> </span><a href="#local-6989586621679279213"><span class="hs-identifier hs-var">printDialogData</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span>
</span><a name="line-210"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279214"><a href="#local-6989586621679279214"><span class="hs-identifier">printer</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#printerCreate"><span class="hs-identifier hs-var">printerCreate</span></a><span> </span><a href="#local-6989586621679279213"><span class="hs-identifier hs-var">printDialogData</span></a><span></span><span>
</span><a name="line-211"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279215"><a href="#local-6989586621679279215"><span class="hs-identifier">printout</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#wxcPrintoutCreate"><span class="hs-identifier hs-var">wxcPrintoutCreate</span></a><span> </span><a href="#local-6989586621679279208"><span class="hs-identifier hs-var">title</span></a><span></span><span>
</span><a name="line-212"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279216"><a href="#local-6989586621679279216"><span class="hs-identifier">pageInfo</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.Print.html#pageSetupDataGetPageInfo"><span class="hs-identifier hs-var">pageSetupDataGetPageInfo</span></a><span> </span><a href="#local-6989586621679279211"><span class="hs-identifier hs-var">pageSetupData</span></a><span></span><span>
</span><a name="line-213"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.Print.html#printOutInitPageRange"><span class="hs-identifier hs-var">printOutInitPageRange</span></a><span> </span><a href="#local-6989586621679279215"><span class="hs-identifier hs-var">printout</span></a><span> </span><a href="#local-6989586621679279216"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279209"><span class="hs-identifier hs-var">pageRangeFunction</span></a><span></span><span>
</span><a name="line-214"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.Events.html#printOutOnPrint"><span class="hs-identifier hs-var">printOutOnPrint</span></a><span> </span><a href="#local-6989586621679279215"><span class="hs-identifier hs-var">printout</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#onPrint"><span class="hs-identifier hs-var">onPrint</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679279216"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279215"><span class="hs-identifier hs-var">printout</span></a><span> </span><a href="#local-6989586621679279209"><span class="hs-identifier hs-var">pageRangeFunction</span></a><span> </span><a href="#local-6989586621679279210"><span class="hs-identifier hs-var">printFunction</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-215"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279217"><a href="#local-6989586621679279217"><span class="hs-identifier">frame</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.Print.html#pageSetupDialogGetFrame"><span class="hs-identifier hs-var">pageSetupDialogGetFrame</span></a><span> </span><a href="#local-6989586621679279207"><span class="hs-identifier hs-var">pageSetupDialog'</span></a><span></span><span>
</span><a name="line-216"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#printerPrint"><span class="hs-identifier hs-var">printerPrint</span></a><span> </span><a href="#local-6989586621679279214"><span class="hs-identifier hs-var">printer</span></a><span> </span><a href="#local-6989586621679279217"><span class="hs-identifier hs-var">frame</span></a><span> </span><a href="#local-6989586621679279215"><span class="hs-identifier hs-var">printout</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">{- show printer setup? -}</span><span></span><span>
</span><a name="line-217"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#objectDelete"><span class="hs-identifier hs-var">objectDelete</span></a><span> </span><a href="#local-6989586621679279213"><span class="hs-identifier hs-var">printDialogData</span></a><span></span><span>
</span><a name="line-218"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#objectDelete"><span class="hs-identifier hs-var">objectDelete</span></a><span> </span><a href="#local-6989586621679279215"><span class="hs-identifier hs-var">printout</span></a><span></span><span>
</span><a name="line-219"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#objectDelete"><span class="hs-identifier hs-var">objectDelete</span></a><span> </span><a href="#local-6989586621679279214"><span class="hs-identifier hs-var">printer</span></a><span></span><span>
</span><a name="line-220"></a><span>    </span><span class="hs-special">}</span><span></span><span>
</span><a name="line-221"></a><span></span><span>
</span><a name="line-222"></a><span class="hs-comment">-- | Show a preview window</span><span>
</span><a name="line-223"></a><span class="hs-identifier">printPreview</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#PageSetupDialog"><span class="hs-identifier hs-type">PageSetupDialog</span></a><span> </span><a href="#local-6989586621679279125"><span class="hs-identifier hs-type">a</span></a><span> </span><span>
</span><a name="line-224"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span></span><span>
</span><a name="line-225"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageFunction"><span class="hs-identifier hs-type">PageFunction</span></a><span></span><span>
</span><a name="line-226"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintFunction"><span class="hs-identifier hs-type">PrintFunction</span></a><span></span><span>
</span><a name="line-227"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-228"></a><a name="printPreview"><a href="Graphics.UI.WXCore.Print.html#printPreview"><span class="hs-identifier">printPreview</span></a></a><span> </span><a name="local-6989586621679279218"><a href="#local-6989586621679279218"><span class="hs-identifier">pageSetupDialog'</span></a></a><span> </span><a name="local-6989586621679279219"><a href="#local-6989586621679279219"><span class="hs-identifier">title</span></a></a><span> </span><a name="local-6989586621679279220"><a href="#local-6989586621679279220"><span class="hs-identifier">pageRangeFunction</span></a></a><span> </span><a name="local-6989586621679279221"><a href="#local-6989586621679279221"><span class="hs-identifier">printFunction</span></a></a><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-229"></a><span>  </span><span class="hs-keyword">do</span><span class="hs-special">{</span><span> </span><a name="local-6989586621679279222"><a href="#local-6989586621679279222"><span class="hs-identifier">pageSetupData</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#pageSetupDialogGetPageSetupData"><span class="hs-identifier hs-var">pageSetupDialogGetPageSetupData</span></a><span> </span><a href="#local-6989586621679279218"><span class="hs-identifier hs-var">pageSetupDialog'</span></a><span></span><span>
</span><a name="line-230"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279223"><a href="#local-6989586621679279223"><span class="hs-identifier">pageInfo</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.Print.html#pageSetupDataGetPageInfo"><span class="hs-identifier hs-var">pageSetupDataGetPageInfo</span></a><span> </span><a href="#local-6989586621679279222"><span class="hs-identifier hs-var">pageSetupData</span></a><span></span><span>
</span><a name="line-231"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279224"><a href="#local-6989586621679279224"><span class="hs-identifier">printout1</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#wxcPrintoutCreate"><span class="hs-identifier hs-var">wxcPrintoutCreate</span></a><span> </span><span class="hs-string">&quot;Print to preview&quot;</span><span></span><span>
</span><a name="line-232"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279225"><a href="#local-6989586621679279225"><span class="hs-identifier">printout2</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#wxcPrintoutCreate"><span class="hs-identifier hs-var">wxcPrintoutCreate</span></a><span> </span><span class="hs-string">&quot;Print to printer&quot;</span><span></span><span>
</span><a name="line-233"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279226"><a href="#local-6989586621679279226"><span class="hs-identifier">startPage</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.Print.html#printOutInitPageRange"><span class="hs-identifier hs-var">printOutInitPageRange</span></a><span> </span><a href="#local-6989586621679279224"><span class="hs-identifier hs-var">printout1</span></a><span> </span><a href="#local-6989586621679279223"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279220"><span class="hs-identifier hs-var">pageRangeFunction</span></a><span></span><span>
</span><a name="line-234"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.Print.html#printOutInitPageRange"><span class="hs-identifier hs-var">printOutInitPageRange</span></a><span> </span><a href="#local-6989586621679279225"><span class="hs-identifier hs-var">printout2</span></a><span> </span><a href="#local-6989586621679279223"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279220"><span class="hs-identifier hs-var">pageRangeFunction</span></a><span></span><span>
</span><a name="line-235"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.Events.html#printOutOnPrint"><span class="hs-identifier hs-var">printOutOnPrint</span></a><span> </span><a href="#local-6989586621679279224"><span class="hs-identifier hs-var">printout1</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#onPrint"><span class="hs-identifier hs-var">onPrint</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><a href="#local-6989586621679279223"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279224"><span class="hs-identifier hs-var">printout1</span></a><span> </span><a href="#local-6989586621679279220"><span class="hs-identifier hs-var">pageRangeFunction</span></a><span> </span><a href="#local-6989586621679279221"><span class="hs-identifier hs-var">printFunction</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-236"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.Events.html#printOutOnPrint"><span class="hs-identifier hs-var">printOutOnPrint</span></a><span> </span><a href="#local-6989586621679279225"><span class="hs-identifier hs-var">printout2</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#onPrint"><span class="hs-identifier hs-var">onPrint</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679279223"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279225"><span class="hs-identifier hs-var">printout2</span></a><span> </span><a href="#local-6989586621679279220"><span class="hs-identifier hs-var">pageRangeFunction</span></a><span> </span><a href="#local-6989586621679279221"><span class="hs-identifier hs-var">printFunction</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-237"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279227"><a href="#local-6989586621679279227"><span class="hs-identifier">printData</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#pageSetupDialogDataGetPrintData"><span class="hs-identifier hs-var">pageSetupDialogDataGetPrintData</span></a><span> </span><a href="#local-6989586621679279222"><span class="hs-identifier hs-var">pageSetupData</span></a><span></span><span>
</span><a name="line-238"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279228"><a href="#local-6989586621679279228"><span class="hs-identifier">printDialogData</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#printDialogDataCreateFromData"><span class="hs-identifier hs-var">printDialogDataCreateFromData</span></a><span> </span><a href="#local-6989586621679279227"><span class="hs-identifier hs-var">printData</span></a><span></span><span>
</span><a name="line-239"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#printDialogDataSetAllPages"><span class="hs-identifier hs-var">printDialogDataSetAllPages</span></a><span> </span><a href="#local-6989586621679279228"><span class="hs-identifier hs-var">printDialogData</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span>
</span><a name="line-240"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279229"><a href="#local-6989586621679279229"><span class="hs-identifier">preview</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#printPreviewCreateFromDialogData"><span class="hs-identifier hs-var">printPreviewCreateFromDialogData</span></a><span> </span><a href="#local-6989586621679279224"><span class="hs-identifier hs-var">printout1</span></a><span> </span><a href="#local-6989586621679279225"><span class="hs-identifier hs-var">printout2</span></a><span> </span><a href="#local-6989586621679279228"><span class="hs-identifier hs-var">printDialogData</span></a><span></span><span>
</span><a name="line-241"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#printPreviewSetCurrentPage"><span class="hs-identifier hs-var">printPreviewSetCurrentPage</span></a><span> </span><a href="#local-6989586621679279229"><span class="hs-identifier hs-var">preview</span></a><span> </span><a href="#local-6989586621679279226"><span class="hs-identifier hs-var">startPage</span></a><span></span><span>
</span><a name="line-242"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279230"><a href="#local-6989586621679279230"><span class="hs-identifier">frame</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.Print.html#pageSetupDialogGetFrame"><span class="hs-identifier hs-var">pageSetupDialogGetFrame</span></a><span> </span><a href="#local-6989586621679279218"><span class="hs-identifier hs-var">pageSetupDialog'</span></a><span></span><span>
</span><a name="line-243"></a><span>    </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279231"><a href="#local-6989586621679279231"><span class="hs-identifier">previewFrame</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#previewFrameCreate"><span class="hs-identifier hs-var">previewFrameCreate</span></a><span> </span><a href="#local-6989586621679279229"><span class="hs-identifier hs-var">preview</span></a><span> </span><a href="#local-6989586621679279230"><span class="hs-identifier hs-var">frame</span></a><span> </span><a href="#local-6989586621679279219"><span class="hs-identifier hs-var">title</span></a><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#rectNull"><span class="hs-identifier hs-var">rectNull</span></a><span> </span><a href="Graphics.UI.WXCore.Frame.html#frameDefaultStyle"><span class="hs-identifier hs-var">frameDefaultStyle</span></a><span> </span><a href="#local-6989586621679279219"><span class="hs-identifier hs-var">title</span></a><span></span><span>
</span><a name="line-244"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#previewFrameInitialize"><span class="hs-identifier hs-var">previewFrameInitialize</span></a><span> </span><a href="#local-6989586621679279231"><span class="hs-identifier hs-var">previewFrame</span></a><span></span><span>
</span><a name="line-245"></a><span>    </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#windowShow"><span class="hs-identifier hs-var">windowShow</span></a><span> </span><a href="#local-6989586621679279231"><span class="hs-identifier hs-var">previewFrame</span></a><span> </span><span>
</span><a name="line-246"></a><span>    </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#windowRaise"><span class="hs-identifier hs-var">windowRaise</span></a><span> </span><a href="#local-6989586621679279231"><span class="hs-identifier hs-var">previewFrame</span></a><span></span><span>
</span><a name="line-247"></a><span>    </span><span class="hs-special">}</span><span></span><span>
</span><a name="line-248"></a><span></span><span>
</span><a name="line-249"></a><span></span><span>
</span><a name="line-250"></a><span class="hs-comment">{--------------------------------------------------------------------------
  Class helpers
--------------------------------------------------------------------------}</span><span></span><span>
</span><a name="line-253"></a><span></span><span>
</span><a name="line-254"></a><span class="hs-comment">-- | Set the correct page range for a printout.</span><span>
</span><a name="line-255"></a><span class="hs-identifier">printOutInitPageRange</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#WXCPrintout"><span class="hs-identifier hs-type">WXCPrintout</span></a><span> </span><a href="#local-6989586621679279124"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier hs-type">PageInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageFunction"><span class="hs-identifier hs-type">PageFunction</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Int</span><span></span><span>
</span><a name="line-256"></a><a name="printOutInitPageRange"><a href="Graphics.UI.WXCore.Print.html#printOutInitPageRange"><span class="hs-identifier">printOutInitPageRange</span></a></a><span> </span><a name="local-6989586621679279232"><a href="#local-6989586621679279232"><span class="hs-identifier">printOut</span></a></a><span> </span><a name="local-6989586621679279233"><a href="#local-6989586621679279233"><span class="hs-identifier">pageInfo</span></a></a><span> </span><a name="local-6989586621679279234"><a href="#local-6989586621679279234"><span class="hs-identifier">pageRangeFunction</span></a></a><span></span><span>
</span><a name="line-257"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span class="hs-special">{</span><span> </span><a name="local-6989586621679279235"><a href="#local-6989586621679279235"><span class="hs-identifier">printInfo</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.Print.html#printOutGetPrintInfo"><span class="hs-identifier hs-var">printOutGetPrintInfo</span></a><span> </span><a href="#local-6989586621679279232"><span class="hs-identifier hs-var">printOut</span></a><span></span><span>
</span><a name="line-258"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679279236"><a href="#local-6989586621679279236"><span class="hs-identifier">size</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Print.html#printableArea"><span class="hs-identifier hs-var">printableArea</span></a><span> </span><a href="#local-6989586621679279233"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279235"><span class="hs-identifier hs-var">printInfo</span></a><span></span><span>
</span><a name="line-259"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679279237"><a href="#local-6989586621679279237"><span class="hs-identifier">start</span></a></a><span class="hs-special">,</span><a name="local-6989586621679279238"><a href="#local-6989586621679279238"><span class="hs-identifier">end</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679279234"><span class="hs-identifier hs-var">pageRangeFunction</span></a><span> </span><a href="#local-6989586621679279233"><span class="hs-identifier hs-var">pageInfo</span></a><span> </span><a href="#local-6989586621679279235"><span class="hs-identifier hs-var">printInfo</span></a><span> </span><a href="#local-6989586621679279236"><span class="hs-identifier hs-var">size</span></a><span></span><span>
</span><a name="line-260"></a><span>      </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#wxcPrintoutSetPageLimits"><span class="hs-identifier hs-var">wxcPrintoutSetPageLimits</span></a><span> </span><a href="#local-6989586621679279232"><span class="hs-identifier hs-var">printOut</span></a><span> </span><a href="#local-6989586621679279237"><span class="hs-identifier hs-var">start</span></a><span> </span><a href="#local-6989586621679279238"><span class="hs-identifier hs-var">end</span></a><span> </span><a href="#local-6989586621679279237"><span class="hs-identifier hs-var">start</span></a><span> </span><a href="#local-6989586621679279238"><span class="hs-identifier hs-var">end</span></a><span></span><span>
</span><a name="line-261"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679279237"><span class="hs-identifier hs-var">start</span></a><span></span><span>
</span><a name="line-262"></a><span>      </span><span class="hs-special">}</span><span></span><span>
</span><a name="line-263"></a><span></span><span>
</span><a name="line-264"></a><span></span><span>
</span><a name="line-265"></a><span class="hs-comment">-- | Get the parent frame of a 'PageSetupDialog'.</span><span>
</span><a name="line-266"></a><span class="hs-identifier">pageSetupDialogGetFrame</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#PageSetupDialog"><span class="hs-identifier hs-type">PageSetupDialog</span></a><span> </span><a href="#local-6989586621679279123"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcClassTypes.html#Frame"><span class="hs-identifier hs-type">Frame</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-267"></a><a name="pageSetupDialogGetFrame"><a href="Graphics.UI.WXCore.Print.html#pageSetupDialogGetFrame"><span class="hs-identifier">pageSetupDialogGetFrame</span></a></a><span> </span><a name="local-6989586621679279239"><a href="#local-6989586621679279239"><span class="hs-identifier">pageSetupDialog'</span></a></a><span></span><span>
</span><a name="line-268"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679279240"><a href="#local-6989586621679279240"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#windowGetParent"><span class="hs-identifier hs-var">windowGetParent</span></a><span> </span><a href="#local-6989586621679279239"><span class="hs-identifier hs-var">pageSetupDialog'</span></a><span> </span><span>
</span><a name="line-269"></a><span>       </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcClassInfo.html#safeCast"><span class="hs-identifier hs-var">safeCast</span></a><span> </span><a href="#local-6989586621679279240"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="Graphics.UI.WXCore.WxcClassInfo.html#classFrame"><span class="hs-identifier hs-var">classFrame</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-270"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679279241"><a href="#local-6989586621679279241"><span class="hs-identifier">frame</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679279241"><span class="hs-identifier hs-var">frame</span></a><span></span><span>
</span><a name="line-271"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679279242"><a href="#local-6989586621679279242"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#wxcAppGetTopWindow"><span class="hs-identifier hs-var">wxcAppGetTopWindow</span></a><span></span><span>
</span><a name="line-272"></a><span>                          </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcClassInfo.html#safeCast"><span class="hs-identifier hs-var">safeCast</span></a><span> </span><a href="#local-6989586621679279242"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="Graphics.UI.WXCore.WxcClassInfo.html#classFrame"><span class="hs-identifier hs-var">classFrame</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-273"></a><span>                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679279243"><a href="#local-6989586621679279243"><span class="hs-identifier">frame</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679279243"><span class="hs-identifier hs-var">frame</span></a><span></span><span>
</span><a name="line-274"></a><span>                            </span><span class="hs-identifier hs-var">Nothing</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;pageSetupDialogGetFrame: no parent frame found!&quot;</span><span></span><span>
</span><a name="line-275"></a><span></span><span>
</span><a name="line-276"></a><span></span><span>
</span><a name="line-277"></a><span class="hs-comment">{--------------------------------------------------------------------------
    PageSetupDialog  
--------------------------------------------------------------------------}</span><span>  </span><span>
</span><a name="line-280"></a><span class="hs-comment">-- | Create a (hidden) page setup dialog that remembers printer settings.</span><span>
</span><a name="line-281"></a><span class="hs-comment">-- It is a parameter to the functions 'printDialog' and 'printPreview'.</span><span>
</span><a name="line-282"></a><span class="hs-comment">-- The creation function takes a parent frame and the initial page margins</span><span>
</span><a name="line-283"></a><span class="hs-comment">-- (in millimeters) as an argument.</span><span>
</span><a name="line-284"></a><span class="hs-identifier">pageSetupDialog</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#Frame"><span class="hs-identifier hs-type">Frame</span></a><span> </span><a href="#local-6989586621679279122"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcClassTypes.html#PageSetupDialog"><span class="hs-identifier hs-type">PageSetupDialog</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-285"></a><a name="pageSetupDialog"><a href="Graphics.UI.WXCore.Print.html#pageSetupDialog"><span class="hs-identifier">pageSetupDialog</span></a></a><span> </span><a name="local-6989586621679279244"><a href="#local-6989586621679279244"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679279245"><a href="#local-6989586621679279245"><span class="hs-identifier">margin</span></a></a><span></span><span>
</span><a name="line-286"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679279246"><a href="#local-6989586621679279246"><span class="hs-identifier">pageSetupData</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#pageSetupDialogDataCreate"><span class="hs-identifier hs-var">pageSetupDialogDataCreate</span></a><span></span><span>
</span><a name="line-287"></a><span>       </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679279245"><span class="hs-identifier hs-var">margin</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-288"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679279247"><a href="#local-6989586621679279247"><span class="hs-identifier">pageInfo</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.Print.html#pageSetupDataGetPageInfo"><span class="hs-identifier hs-var">pageSetupDataGetPageInfo</span></a><span> </span><a href="#local-6989586621679279246"><span class="hs-identifier hs-var">pageSetupData</span></a><span></span><span>
</span><a name="line-289"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679279248"><a href="#local-6989586621679279248"><span class="hs-identifier">p0</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#pt"><span class="hs-identifier hs-var">pt</span></a><span> </span><a href="#local-6989586621679279245"><span class="hs-identifier hs-var">margin</span></a><span> </span><a href="#local-6989586621679279245"><span class="hs-identifier hs-var">margin</span></a><span></span><span>
</span><a name="line-290"></a><span>                    </span><a name="local-6989586621679279249"><a href="#local-6989586621679279249"><span class="hs-identifier">p1</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Types.html#pointSub"><span class="hs-identifier hs-var">pointSub</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcTypes.html#pointFromSize"><span class="hs-identifier hs-var">pointFromSize</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pageSize</span><span> </span><a href="#local-6989586621679279247"><span class="hs-identifier hs-var">pageInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679279248"><span class="hs-identifier hs-var">p0</span></a><span></span><span>
</span><a name="line-291"></a><span>                    </span><a name="local-6989586621679279250"><a href="#local-6989586621679279250"><span class="hs-identifier">newInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679279247"><span class="hs-identifier hs-var">pageInfo</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">pageArea</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#rectBetween"><span class="hs-identifier hs-var">rectBetween</span></a><span> </span><a href="#local-6989586621679279248"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679279249"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">}</span><span></span><span>
</span><a name="line-292"></a><span>                </span><a href="Graphics.UI.WXCore.Print.html#pageSetupDataSetPageInfo"><span class="hs-identifier hs-var">pageSetupDataSetPageInfo</span></a><span> </span><a href="#local-6989586621679279246"><span class="hs-identifier hs-var">pageSetupData</span></a><span> </span><a href="#local-6989586621679279250"><span class="hs-identifier hs-var">newInfo</span></a><span></span><span>
</span><a name="line-293"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>                                                                                           </span><span>
</span><a name="line-294"></a><span>       </span><a name="local-6989586621679279251"><a href="#local-6989586621679279251"><span class="hs-identifier">pageSetupDialog'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#pageSetupDialogCreate"><span class="hs-identifier hs-var">pageSetupDialogCreate</span></a><span> </span><a href="#local-6989586621679279244"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679279246"><span class="hs-identifier hs-var">pageSetupData</span></a><span></span><span>
</span><a name="line-295"></a><span>       </span><a name="local-6989586621679279252"><a href="#local-6989586621679279252"><span class="hs-identifier">prev</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.Events.html#windowGetOnClose"><span class="hs-identifier hs-var">windowGetOnClose</span></a><span> </span><a href="#local-6989586621679279244"><span class="hs-identifier hs-var">f</span></a><span></span><span>
</span><a name="line-296"></a><span>       </span><a href="Graphics.UI.WXCore.Events.html#windowOnClose"><span class="hs-identifier hs-var">windowOnClose</span></a><span> </span><a href="#local-6989586621679279244"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span class="hs-special">{</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#objectDelete"><span class="hs-identifier hs-var">objectDelete</span></a><span> </span><a href="#local-6989586621679279251"><span class="hs-identifier hs-var">pageSetupDialog'</span></a><span class="hs-special">;</span><span> </span><a href="#local-6989586621679279252"><span class="hs-identifier hs-var">prev</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-297"></a><span>       </span><a href="Graphics.UI.WXCore.WxcTypes.html#objectDelete"><span class="hs-identifier hs-var">objectDelete</span></a><span> </span><a href="#local-6989586621679279246"><span class="hs-identifier hs-var">pageSetupData</span></a><span></span><span>
</span><a name="line-298"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679279251"><span class="hs-identifier hs-var">pageSetupDialog'</span></a><span></span><span>
</span><a name="line-299"></a><span></span><span>
</span><a name="line-300"></a><span class="hs-comment">-- | Show the page setup dialog</span><span>
</span><a name="line-301"></a><span class="hs-identifier">pageSetupShowModal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#PageSetupDialog"><span class="hs-identifier hs-type">PageSetupDialog</span></a><span> </span><a href="#local-6989586621679279121"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-302"></a><a name="pageSetupShowModal"><a href="Graphics.UI.WXCore.Print.html#pageSetupShowModal"><span class="hs-identifier">pageSetupShowModal</span></a></a><span> </span><a name="local-6989586621679279253"><a href="#local-6989586621679279253"><span class="hs-identifier">p</span></a></a><span></span><span>
</span><a name="line-303"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesAL.html#dialogShowModal"><span class="hs-identifier hs-var">dialogShowModal</span></a><span> </span><a href="#local-6989586621679279253"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-304"></a><span></span><span>
</span><a name="line-305"></a><span class="hs-comment">{--------------------------------------------------------------------------
  PageInfo and PrintInfo
--------------------------------------------------------------------------}</span><span></span><span>
</span><a name="line-308"></a><span></span><span>
</span><a name="line-309"></a><span class="hs-comment">-- | Information from the page setup dialog.</span><span>
</span><a name="line-310"></a><span class="hs-comment">--   All measurements are in millimeters.</span><span>
</span><a name="line-311"></a><span class="hs-keyword">data</span><span> </span><a name="PageInfo"><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier">PageInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="PageInfo"><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier">PageInfo</span></a></a><span class="hs-special">{</span><span> </span><a name="pageSize"><a href="Graphics.UI.WXCore.Print.html#pageSize"><span class="hs-identifier">pageSize</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#Size"><span class="hs-identifier hs-type">Size</span></a><span>  </span><span class="hs-comment">-- ^ The page size (in millimeters)</span><span>
</span><a name="line-312"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="pageArea"><a href="Graphics.UI.WXCore.Print.html#pageArea"><span class="hs-identifier">pageArea</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#Rect"><span class="hs-identifier hs-type">Rect</span></a><span>  </span><span class="hs-comment">-- ^ The available page area (=margins) (in millimeters)</span><span>
</span><a name="line-313"></a><span>                        </span><span class="hs-special">}</span><span> </span><span>
</span><a name="line-314"></a><span>                        </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Show</span><span></span><span>
</span><a name="line-315"></a><span></span><span>
</span><a name="line-316"></a><span class="hs-comment">-- | Get page info</span><span>
</span><a name="line-317"></a><span class="hs-identifier">pageSetupDataGetPageInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#PageSetupDialogData"><span class="hs-identifier hs-type">PageSetupDialogData</span></a><span> </span><a href="#local-6989586621679279120"><span class="hs-identifier hs-type">a</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier hs-type">PageInfo</span></a><span></span><span>
</span><a name="line-318"></a><a name="pageSetupDataGetPageInfo"><a href="Graphics.UI.WXCore.Print.html#pageSetupDataGetPageInfo"><span class="hs-identifier">pageSetupDataGetPageInfo</span></a></a><span> </span><a name="local-6989586621679279254"><a href="#local-6989586621679279254"><span class="hs-identifier">pageSetupData</span></a></a><span> </span><span>
</span><a name="line-319"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span class="hs-special">{</span><span> </span><a name="local-6989586621679279255"><a href="#local-6989586621679279255"><span class="hs-identifier">topLeft</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#pageSetupDialogDataGetMarginTopLeft"><span class="hs-identifier hs-var">pageSetupDialogDataGetMarginTopLeft</span></a><span> </span><a href="#local-6989586621679279254"><span class="hs-identifier hs-var">pageSetupData</span></a><span></span><span>
</span><a name="line-320"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279256"><a href="#local-6989586621679279256"><span class="hs-identifier">bottomRight</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#pageSetupDialogDataGetMarginBottomRight"><span class="hs-identifier hs-var">pageSetupDialogDataGetMarginBottomRight</span></a><span> </span><a href="#local-6989586621679279254"><span class="hs-identifier hs-var">pageSetupData</span></a><span></span><span>
</span><a name="line-321"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279257"><a href="#local-6989586621679279257"><span class="hs-identifier">paperSize</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#pageSetupDialogDataGetPaperSize"><span class="hs-identifier hs-var">pageSetupDialogDataGetPaperSize</span></a><span> </span><a href="#local-6989586621679279254"><span class="hs-identifier hs-var">pageSetupData</span></a><span></span><span>
</span><a name="line-322"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier hs-var">PageInfo</span></a><span></span><span>
</span><a name="line-323"></a><span>          </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pageSize</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679279257"><span class="hs-identifier hs-var">paperSize</span></a><span></span><span>
</span><a name="line-324"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pageArea</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#rectBetween"><span class="hs-identifier hs-var">rectBetween</span></a><span> </span><a href="#local-6989586621679279255"><span class="hs-identifier hs-var">topLeft</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Types.html#pointSub"><span class="hs-identifier hs-var">pointSub</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcTypes.html#pointFromSize"><span class="hs-identifier hs-var">pointFromSize</span></a><span> </span><a href="#local-6989586621679279257"><span class="hs-identifier hs-var">paperSize</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679279256"><span class="hs-identifier hs-var">bottomRight</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-325"></a><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-326"></a><span>      </span><span class="hs-special">}</span><span></span><span>
</span><a name="line-327"></a><span></span><span>
</span><a name="line-328"></a><span class="hs-comment">-- | Set page info</span><span>
</span><a name="line-329"></a><span class="hs-identifier">pageSetupDataSetPageInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#PageSetupDialogData"><span class="hs-identifier hs-type">PageSetupDialogData</span></a><span> </span><a href="#local-6989586621679279119"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PageInfo"><span class="hs-identifier hs-type">PageInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-330"></a><a name="pageSetupDataSetPageInfo"><a href="Graphics.UI.WXCore.Print.html#pageSetupDataSetPageInfo"><span class="hs-identifier">pageSetupDataSetPageInfo</span></a></a><span> </span><a name="local-6989586621679279258"><a href="#local-6989586621679279258"><span class="hs-identifier">pageSetupData</span></a></a><span> </span><a name="local-6989586621679279259"><a href="#local-6989586621679279259"><span class="hs-identifier">pageInfo</span></a></a><span></span><span>
</span><a name="line-331"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679279260"><a href="#local-6989586621679279260"><span class="hs-identifier">topLeft</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#rectTopLeft"><span class="hs-identifier hs-var">rectTopLeft</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pageArea</span><span> </span><a href="#local-6989586621679279259"><span class="hs-identifier hs-var">pageInfo</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-332"></a><span>            </span><a name="local-6989586621679279261"><a href="#local-6989586621679279261"><span class="hs-identifier">bottomRight</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.Types.html#pointSub"><span class="hs-identifier hs-var">pointSub</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcTypes.html#pointFromSize"><span class="hs-identifier hs-var">pointFromSize</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pageSize</span><span> </span><a href="#local-6989586621679279259"><span class="hs-identifier hs-var">pageInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.WxcTypes.html#rectBottomRight"><span class="hs-identifier hs-var">rectBottomRight</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pageArea</span><span> </span><a href="#local-6989586621679279259"><span class="hs-identifier hs-var">pageInfo</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-333"></a><span>      </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#pageSetupDialogDataSetMarginTopLeft"><span class="hs-identifier hs-var">pageSetupDialogDataSetMarginTopLeft</span></a><span> </span><a href="#local-6989586621679279258"><span class="hs-identifier hs-var">pageSetupData</span></a><span> </span><a href="#local-6989586621679279260"><span class="hs-identifier hs-var">topLeft</span></a><span></span><span>
</span><a name="line-334"></a><span>      </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#pageSetupDialogDataSetMarginBottomRight"><span class="hs-identifier hs-var">pageSetupDialogDataSetMarginBottomRight</span></a><span> </span><a href="#local-6989586621679279258"><span class="hs-identifier hs-var">pageSetupData</span></a><span> </span><a href="#local-6989586621679279261"><span class="hs-identifier hs-var">bottomRight</span></a><span></span><span>
</span><a name="line-335"></a><span>      </span><span class="hs-special">;</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#pageSetupDialogDataSetPaperSize"><span class="hs-identifier hs-var">pageSetupDialogDataSetPaperSize</span></a><span> </span><a href="#local-6989586621679279258"><span class="hs-identifier hs-var">pageSetupData</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pageSize</span><span> </span><a href="#local-6989586621679279259"><span class="hs-identifier hs-var">pageInfo</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-336"></a><span>      </span><span class="hs-special">}</span><span></span><span>
</span><a name="line-337"></a><span></span><span>
</span><a name="line-338"></a><span></span><span>
</span><a name="line-339"></a><span class="hs-comment">-- | Printer information.</span><span>
</span><a name="line-340"></a><span class="hs-keyword">data</span><span> </span><a name="PrintInfo"><a href="Graphics.UI.WXCore.Print.html#PrintInfo"><span class="hs-identifier">PrintInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="PrintInfo"><a href="Graphics.UI.WXCore.Print.html#PrintInfo"><span class="hs-identifier">PrintInfo</span></a></a><span>  </span><span class="hs-special">{</span><span> </span><a name="screenPPI"><a href="Graphics.UI.WXCore.Print.html#screenPPI"><span class="hs-identifier">screenPPI</span></a></a><span>         </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-comment">-- ^ screen pixels per inch</span><span>
</span><a name="line-341"></a><span>                            </span><span class="hs-special">,</span><span> </span><a name="printerPPI"><a href="Graphics.UI.WXCore.Print.html#printerPPI"><span class="hs-identifier">printerPPI</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-comment">-- ^ printer pixels per inch</span><span>
</span><a name="line-342"></a><span>                            </span><span class="hs-special">,</span><span> </span><a name="printPageSize"><a href="Graphics.UI.WXCore.Print.html#printPageSize"><span class="hs-identifier">printPageSize</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#Size"><span class="hs-identifier hs-type">Size</span></a><span> </span><span class="hs-comment">-- ^ printable area (in pixels) = PageInfo pageSize minus printer margins</span><span>
</span><a name="line-343"></a><span>                            </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Show</span><span></span><span>
</span><a name="line-344"></a><span></span><span>
</span><a name="line-345"></a><span class="hs-comment">-- | Extract print info    </span><span>
</span><a name="line-346"></a><span class="hs-identifier">printOutGetPrintInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WXCore.WxcClassTypes.html#Printout"><span class="hs-identifier hs-type">Printout</span></a><span> </span><a href="#local-6989586621679279118"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Graphics.UI.WXCore.Print.html#PrintInfo"><span class="hs-identifier hs-type">PrintInfo</span></a><span></span><span>
</span><a name="line-347"></a><a name="printOutGetPrintInfo"><a href="Graphics.UI.WXCore.Print.html#printOutGetPrintInfo"><span class="hs-identifier">printOutGetPrintInfo</span></a></a><span> </span><a name="local-6989586621679279262"><a href="#local-6989586621679279262"><span class="hs-identifier">printOut</span></a></a><span> </span><span>
</span><a name="line-348"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span class="hs-special">{</span><span> </span><a name="local-6989586621679279263"><a href="#local-6989586621679279263"><span class="hs-identifier">thePrinterPPI</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#printoutGetPPIPrinter"><span class="hs-identifier hs-var">printoutGetPPIPrinter</span></a><span> </span><a href="#local-6989586621679279262"><span class="hs-identifier hs-var">printOut</span></a><span></span><span>
</span><a name="line-349"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279264"><a href="#local-6989586621679279264"><span class="hs-identifier">theScreenPPI</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#printoutGetPPIScreen"><span class="hs-identifier hs-var">printoutGetPPIScreen</span></a><span> </span><a href="#local-6989586621679279262"><span class="hs-identifier hs-var">printOut</span></a><span></span><span>
</span><a name="line-350"></a><span>      </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679279265"><a href="#local-6989586621679279265"><span class="hs-identifier">thePageSizePixels</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WXCore.WxcClassesMZ.html#printoutGetPageSizePixels"><span class="hs-identifier hs-var">printoutGetPageSizePixels</span></a><span> </span><a href="#local-6989586621679279262"><span class="hs-identifier hs-var">printOut</span></a><span></span><span>
</span><a name="line-351"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WXCore.Print.html#PrintInfo"><span class="hs-identifier hs-var">PrintInfo</span></a><span> </span><span>
</span><a name="line-352"></a><span>          </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">printerPPI</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#sizeFromPoint"><span class="hs-identifier hs-var">sizeFromPoint</span></a><span> </span><a href="#local-6989586621679279263"><span class="hs-identifier hs-var">thePrinterPPI</span></a><span></span><span>
</span><a name="line-353"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">screenPPI</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WXCore.WxcTypes.html#sizeFromPoint"><span class="hs-identifier hs-var">sizeFromPoint</span></a><span> </span><a href="#local-6989586621679279264"><span class="hs-identifier hs-var">theScreenPPI</span></a><span></span><span>
</span><a name="line-354"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">printPageSize</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679279265"><span class="hs-identifier hs-var">thePageSizePixels</span></a><span></span><span>
</span><a name="line-355"></a><span>          </span><span class="hs-special">}</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-356"></a><span>      </span><span class="hs-special">}</span><span> </span><span>
</span><a name="line-357"></a><span></span><span>
</span><a name="line-358"></a></pre></body></html>