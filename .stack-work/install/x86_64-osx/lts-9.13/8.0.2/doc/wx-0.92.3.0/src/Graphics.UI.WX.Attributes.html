<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span></span><span>
</span><a name="line-2"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-3"></a><span class="hs-comment">{-|
Module      :  Attributes
Copyright   :  (c) Daan Leijen 2003
License     :  wxWindows

Maintainer  :  wxhaskell-devel@lists.sourceforge.net
Stability   :  provisional
Portability :  portable


Widgets @w@ can have attributes of type @a@ represented by the type 'Attr' @w a@.
An example of an attribute is 'Graphics.UI.WX.Classes.text' with type:

&gt; text :: Attr (Window a) String

This means that any object derived from 'Window' has a 'Graphics.UI.WX.Classes.text' attribute of type 'String'.
An attribute can be read with the 'get' function:

&gt; get w title           :: IO String

When an attribute is associated with a value, we call it a /property/ of type 'Prop' @w@.
Properties are constructed by assigning a value to an attribute with the (':=') constructor:

&gt; text := &quot;hello world&quot;      :: Prop (Window a)

A list of properties can be set with the 'set' function:

&gt; set w [text := &quot;Hi&quot;]   :: IO ()

The (':~') constructor is used to transform an attribute value with an update function.
For example, the 'interval' on a timer can be doubled with the following expression.

&gt; set timer [interval :~ (*2)]

The functions 'get', 'set', (':='), and (':~') are polymorphic and work for all widgets, but
the @text@ attribute just works for windows. Many attributes work for different kind
of objects and are organised into type classes. Actually, the real type of the
'Graphics.UI.WX.Classes.text' attribute is:

&gt; Textual w =&gt; Attr w String

and 'Window' derived objects are part of this class:

&gt; instance Textual (Window a)

But also menus and status fields:

&gt; instance Textual (Menu a)
&gt; instance Textual (StatusField)

Sometimes, it is convenient to also get a reference to the object itself when setting
a property. The operators ('::=') and ('::~') provide this reference.
-}</span><span></span><span>
</span><a name="line-56"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-57"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WX</span><span class="hs-operator">.</span><span class="hs-identifier">Attributes</span><span></span><span>
</span><a name="line-58"></a><span>    </span><span class="hs-special">(</span><span></span><span>
</span><a name="line-59"></a><span>    </span><span class="hs-comment">-- * Attributes</span><span>
</span><a name="line-60"></a><span>      </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#%3A~"><span class="hs-operator hs-var">:~</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#%3A%3A%3D"><span class="hs-operator hs-var">::=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#%3A%3A~"><span class="hs-operator hs-var">::~</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#ReadAttr"><span class="hs-identifier hs-type">ReadAttr</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#WriteAttr"><span class="hs-identifier hs-type">WriteAttr</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#CreateAttr"><span class="hs-identifier hs-type">CreateAttr</span></a><span></span><span>
</span><a name="line-61"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#get"><span class="hs-identifier hs-var">get</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#set"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#swap"><span class="hs-identifier hs-var">swap</span></a><span></span><span>
</span><a name="line-62"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#mapAttr"><span class="hs-identifier hs-var">mapAttr</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#mapAttrW"><span class="hs-identifier hs-var">mapAttrW</span></a><span></span><span>
</span><a name="line-63"></a><span></span><span>
</span><a name="line-64"></a><span></span><span>
</span><a name="line-65"></a><span>    </span><span class="hs-comment">-- * Internal</span><span>
</span><a name="line-66"></a><span></span><span>
</span><a name="line-67"></a><span>    </span><span class="hs-comment">-- ** Attributes</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#readAttr"><span class="hs-identifier hs-var">readAttr</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#writeAttr"><span class="hs-identifier hs-var">writeAttr</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#nullAttr"><span class="hs-identifier hs-var">nullAttr</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#constAttr"><span class="hs-identifier hs-var">constAttr</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#makeAttr"><span class="hs-identifier hs-var">makeAttr</span></a><span></span><span>
</span><a name="line-69"></a><span>    </span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-comment">-- ** Reflection</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#attrName"><span class="hs-identifier hs-var">attrName</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#propName"><span class="hs-identifier hs-var">propName</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#containsProperty"><span class="hs-identifier hs-var">containsProperty</span></a><span></span><span>
</span><a name="line-72"></a><span>    </span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-comment">-- ** Reflective attributes</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#reflectiveAttr"><span class="hs-identifier hs-var">reflectiveAttr</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#createAttr"><span class="hs-identifier hs-var">createAttr</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#withProperty"><span class="hs-identifier hs-var">withProperty</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#findProperty"><span class="hs-identifier hs-var">findProperty</span></a><span></span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#withStyleProperty"><span class="hs-identifier hs-var">withStyleProperty</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#withStylePropertyNot"><span class="hs-identifier hs-var">withStylePropertyNot</span></a><span></span><span>
</span><a name="line-76"></a><span></span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-comment">-- *** Filter</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier hs-type">PropValue</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-79"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#filterProperty"><span class="hs-identifier hs-var">filterProperty</span></a><span> </span><span>
</span><a name="line-80"></a><span></span><span>
</span><a name="line-81"></a><span>    </span><span class="hs-comment">-- ** Cast</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#castAttr"><span class="hs-identifier hs-var">castAttr</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#castProp"><span class="hs-identifier hs-var">castProp</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Attributes.html#castProps"><span class="hs-identifier hs-var">castProps</span></a><span></span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-84"></a><span></span><span>
</span><a name="line-85"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.UI.WX.Types.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WX</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span></span><span>
</span><a name="line-86"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Dynamic</span><span></span><span>
</span><a name="line-87"></a><span></span><span>
</span><a name="line-88"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator">:=</span><span class="hs-special">,</span><span class="hs-operator">:~</span><span class="hs-special">,</span><span class="hs-operator">::=</span><span class="hs-special">,</span><span class="hs-operator">::~</span><span></span><span>
</span><a name="line-89"></a><span></span><span>
</span><a name="line-90"></a><span class="hs-comment">-- | A property of a widget @w@ is an attribute that</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- is already associated with a value. .</span><span>
</span><a name="line-92"></a><span class="hs-keyword">data</span><span> </span><a name="Prop"><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier">Prop</span></a></a><span> </span><a name="local-6989586621679061973"><a href="#local-6989586621679061973"><span class="hs-identifier">w</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679061974"><a href="#local-6989586621679061974"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679061973"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061974"><span class="hs-identifier hs-type">a</span></a><span> </span><a name="%3A%3D"><a href="Graphics.UI.WX.Attributes.html#%3A%3D"><span class="hs-operator">:=</span></a></a><span> </span><a href="#local-6989586621679061974"><span class="hs-identifier hs-type">a</span></a><span>         </span><span class="hs-comment">-- ^ Assign a value to an attribute.</span><span>
</span><a name="line-93"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679061975"><a href="#local-6989586621679061975"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679061973"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061975"><span class="hs-identifier hs-type">a</span></a><span> </span><a name="%3A~"><a href="Graphics.UI.WX.Attributes.html#%3A~"><span class="hs-operator">:~</span></a></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061975"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061975"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Apply an update function to an attribute.</span><span>
</span><a name="line-94"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679061976"><a href="#local-6989586621679061976"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679061973"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061976"><span class="hs-identifier hs-type">a</span></a><span> </span><a name="%3A%3A%3D"><a href="Graphics.UI.WX.Attributes.html#%3A%3A%3D"><span class="hs-operator">::=</span></a></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061973"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061976"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Assign a value to an attribute with the widget as argument.</span><span>
</span><a name="line-95"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679061977"><a href="#local-6989586621679061977"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679061973"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061977"><span class="hs-identifier hs-type">a</span></a><span> </span><a name="%3A%3A~"><a href="Graphics.UI.WX.Attributes.html#%3A%3A~"><span class="hs-operator">::~</span></a></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061973"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061977"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061977"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Apply an update function to an attribute with the widget as an argument.</span><span>
</span><a name="line-96"></a><span></span><span>
</span><a name="line-97"></a><span class="hs-comment">-- For debugging purposes</span><span>
</span><a name="line-98"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679063110"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679063110"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-99"></a><span>  </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063111"><a href="#local-6989586621679063111"><span class="hs-identifier">string</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Attr \&quot;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679063111"><span class="hs-identifier hs-var">string</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\&quot; _ _ _ _ :=  _&quot;</span><span></span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063112"><a href="#local-6989586621679063112"><span class="hs-identifier">string</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A~"><span class="hs-operator hs-var">:~</span></a><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Attr \&quot;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679063112"><span class="hs-identifier hs-var">string</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\&quot; _ _ _ _ :~  _&quot;</span><span></span><span>
</span><a name="line-101"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063113"><a href="#local-6989586621679063113"><span class="hs-identifier">string</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3A%3D"><span class="hs-operator hs-var">::=</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Attr \&quot;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679063113"><span class="hs-identifier hs-var">string</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\&quot; _ _ _ _ ::= _&quot;</span><span></span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063114"><a href="#local-6989586621679063114"><span class="hs-identifier">string</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3A~"><span class="hs-operator hs-var">::~</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Attr \&quot;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679063114"><span class="hs-identifier hs-var">string</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\&quot; _ _ _ _ ::~ _&quot;</span><span></span><span>
</span><a name="line-103"></a><span></span><span>
</span><a name="line-104"></a><span></span><span>
</span><a name="line-105"></a><span class="hs-comment">-- | An attribute that should be specified at creation time. Just for documentation purposes.</span><span>
</span><a name="line-106"></a><span class="hs-keyword">type</span><span> </span><a name="CreateAttr"><a href="Graphics.UI.WX.Attributes.html#CreateAttr"><span class="hs-identifier">CreateAttr</span></a></a><span> </span><a name="local-6989586621679061971"><a href="#local-6989586621679061971"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679061972"><a href="#local-6989586621679061972"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679061971"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061972"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-107"></a><span></span><span>
</span><a name="line-108"></a><span class="hs-comment">-- | A read-only attribute. Just for documentation purposes.</span><span>
</span><a name="line-109"></a><span class="hs-keyword">type</span><span> </span><a name="ReadAttr"><a href="Graphics.UI.WX.Attributes.html#ReadAttr"><span class="hs-identifier">ReadAttr</span></a></a><span> </span><a name="local-6989586621679061969"><a href="#local-6989586621679061969"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679061970"><a href="#local-6989586621679061970"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679061969"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061970"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-110"></a><span></span><span>
</span><a name="line-111"></a><span class="hs-comment">-- | A write-only attribute. Just for documentation purposes.</span><span>
</span><a name="line-112"></a><span class="hs-keyword">type</span><span> </span><a name="WriteAttr"><a href="Graphics.UI.WX.Attributes.html#WriteAttr"><span class="hs-identifier">WriteAttr</span></a></a><span> </span><a name="local-6989586621679061967"><a href="#local-6989586621679061967"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679061968"><a href="#local-6989586621679061968"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679061967"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061968"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-113"></a><span></span><span>
</span><a name="line-114"></a><span class="hs-comment">-- | Widgets @w@ can have attributes of type @a@.</span><span>
</span><a name="line-115"></a><span class="hs-keyword">data</span><span> </span><a name="Attr"><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier">Attr</span></a></a><span> </span><a name="local-6989586621679061965"><a href="#local-6989586621679061965"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679061966"><a href="#local-6989586621679061966"><span class="hs-identifier">a</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a name="Attr"><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier">Attr</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061966"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Dynamic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Dynamic</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679061966"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- name, dynamic conversion</span><span>
</span><a name="line-116"></a><span>                              </span><span class="hs-special">(</span><a href="#local-6989586621679061965"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679061966"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061965"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061966"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>               </span><span class="hs-comment">-- getter setter </span><span>
</span><a name="line-117"></a><span>                              </span><span class="hs-special">(</span><a href="#local-6989586621679061965"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061966"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061966"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679061966"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>                     </span><span class="hs-comment">-- updater      </span><span>
</span><a name="line-118"></a><span></span><span>
</span><a name="line-119"></a><span class="hs-comment">-- For debugging purposes</span><span>
</span><a name="line-120"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679063107"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679063108"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679063107"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-121"></a><span>  </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063109"><a href="#local-6989586621679063109"><span class="hs-identifier">string</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-string">&quot;Attr \&quot;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679063109"><span class="hs-identifier hs-var">string</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\&quot; _ _ _ _&quot;</span><span></span><span>
</span><a name="line-123"></a><span></span><span>
</span><a name="line-124"></a><span></span><span>
</span><a name="line-125"></a><span class="hs-comment">-- | Cast attributes.</span><span>
</span><a name="line-126"></a><span class="hs-identifier">castAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062191"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062192"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062192"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062193"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062191"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679062193"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-127"></a><a name="castAttr"><a href="Graphics.UI.WX.Attributes.html#castAttr"><span class="hs-identifier">castAttr</span></a></a><span> </span><a name="local-6989586621679062194"><a href="#local-6989586621679062194"><span class="hs-identifier">coerce</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679062195"><a href="#local-6989586621679062195"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679062196"><a href="#local-6989586621679062196"><span class="hs-identifier">mbdyn</span></a></a><span> </span><a name="local-6989586621679062197"><a href="#local-6989586621679062197"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679062198"><a href="#local-6989586621679062198"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679062199"><a href="#local-6989586621679062199"><span class="hs-identifier">upd</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-128"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a href="#local-6989586621679062195"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679062196"><span class="hs-identifier hs-var">mbdyn</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062200"><a href="#local-6989586621679062200"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062197"><span class="hs-identifier hs-var">getter</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062194"><span class="hs-identifier hs-var">coerce</span></a><span> </span><a href="#local-6989586621679062200"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062201"><a href="#local-6989586621679062201"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679062202"><a href="#local-6989586621679062202"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062198"><span class="hs-identifier hs-var">setter</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062194"><span class="hs-identifier hs-var">coerce</span></a><span> </span><a href="#local-6989586621679062201"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062202"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-129"></a><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062203"><a href="#local-6989586621679062203"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679062204"><a href="#local-6989586621679062204"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062199"><span class="hs-identifier hs-var">upd</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062194"><span class="hs-identifier hs-var">coerce</span></a><span> </span><a href="#local-6989586621679062203"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062204"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-130"></a><span></span><span>
</span><a name="line-131"></a><span class="hs-comment">-- | Cast properties</span><span>
</span><a name="line-132"></a><span class="hs-identifier">castProp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062189"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062190"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679062190"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679062189"><span class="hs-identifier hs-type">v</span></a><span></span><span>
</span><a name="line-133"></a><a name="castProp"><a href="Graphics.UI.WX.Attributes.html#castProp"><span class="hs-identifier">castProp</span></a></a><span> </span><a name="local-6989586621679062205"><a href="#local-6989586621679062205"><span class="hs-identifier">coerce</span></a></a><span> </span><a name="local-6989586621679062206"><a href="#local-6989586621679062206"><span class="hs-identifier">prop</span></a></a><span></span><span>
</span><a name="line-134"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679062206"><span class="hs-identifier hs-var">prop</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-135"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679062207"><a href="#local-6989586621679062207"><span class="hs-identifier">attr</span></a></a><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a><span> </span><a name="local-6989586621679062208"><a href="#local-6989586621679062208"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#castAttr"><span class="hs-identifier hs-var">castAttr</span></a><span> </span><a href="#local-6989586621679062205"><span class="hs-identifier hs-var">coerce</span></a><span> </span><a href="#local-6989586621679062207"><span class="hs-identifier hs-var">attr</span></a><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a><span> </span><a href="#local-6989586621679062208"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-136"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679062209"><a href="#local-6989586621679062209"><span class="hs-identifier">attr</span></a></a><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A~"><span class="hs-operator hs-var">:~</span></a><span> </span><a name="local-6989586621679062210"><a href="#local-6989586621679062210"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#castAttr"><span class="hs-identifier hs-var">castAttr</span></a><span> </span><a href="#local-6989586621679062205"><span class="hs-identifier hs-var">coerce</span></a><span> </span><a href="#local-6989586621679062209"><span class="hs-identifier hs-var">attr</span></a><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A~"><span class="hs-operator hs-var">:~</span></a><span> </span><a href="#local-6989586621679062210"><span class="hs-identifier hs-var">f</span></a><span></span><span>
</span><a name="line-137"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679062211"><a href="#local-6989586621679062211"><span class="hs-identifier">attr</span></a></a><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3A%3D"><span class="hs-operator hs-var">::=</span></a><span> </span><a name="local-6989586621679062212"><a href="#local-6989586621679062212"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#castAttr"><span class="hs-identifier hs-var">castAttr</span></a><span> </span><a href="#local-6989586621679062205"><span class="hs-identifier hs-var">coerce</span></a><span> </span><a href="#local-6989586621679062211"><span class="hs-identifier hs-var">attr</span></a><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3A%3D"><span class="hs-operator hs-var">::=</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062213"><a href="#local-6989586621679062213"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062212"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062205"><span class="hs-identifier hs-var">coerce</span></a><span> </span><a href="#local-6989586621679062213"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-138"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679062214"><a href="#local-6989586621679062214"><span class="hs-identifier">attr</span></a></a><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3A~"><span class="hs-operator hs-var">::~</span></a><span> </span><a name="local-6989586621679062215"><a href="#local-6989586621679062215"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#castAttr"><span class="hs-identifier hs-var">castAttr</span></a><span> </span><a href="#local-6989586621679062205"><span class="hs-identifier hs-var">coerce</span></a><span> </span><a href="#local-6989586621679062214"><span class="hs-identifier hs-var">attr</span></a><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3A~"><span class="hs-operator hs-var">::~</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062216"><a href="#local-6989586621679062216"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679062217"><a href="#local-6989586621679062217"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062215"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062205"><span class="hs-identifier hs-var">coerce</span></a><span> </span><a href="#local-6989586621679062216"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062217"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-139"></a><span></span><span>
</span><a name="line-140"></a><span class="hs-comment">-- | Cast a list of properties.</span><span>
</span><a name="line-141"></a><span class="hs-identifier">castProps</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062187"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062188"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679062188"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679062187"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-142"></a><a name="castProps"><a href="Graphics.UI.WX.Attributes.html#castProps"><span class="hs-identifier">castProps</span></a></a><span> </span><a name="local-6989586621679062218"><a href="#local-6989586621679062218"><span class="hs-identifier">coerce</span></a></a><span> </span><a name="local-6989586621679062219"><a href="#local-6989586621679062219"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#castProp"><span class="hs-identifier hs-var">castProp</span></a><span> </span><a href="#local-6989586621679062218"><span class="hs-identifier hs-var">coerce</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062219"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-144"></a><span></span><span>
</span><a name="line-145"></a><span class="hs-comment">-- | Create a /reflective/ attribute with a specified name: value can possibly be</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- retrieved using 'getPropValue'. Note: the use of this function is discouraged</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- as it leads to non-compositional code.</span><span>
</span><a name="line-148"></a><span class="hs-identifier">reflectiveAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679062185"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062186"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679062185"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062186"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062185"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062186"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062185"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-149"></a><a name="reflectiveAttr"><a href="Graphics.UI.WX.Attributes.html#reflectiveAttr"><span class="hs-identifier">reflectiveAttr</span></a></a><span> </span><a name="local-6989586621679062220"><a href="#local-6989586621679062220"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679062221"><a href="#local-6989586621679062221"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679062222"><a href="#local-6989586621679062222"><span class="hs-identifier">setter</span></a></a><span></span><span>
</span><a name="line-150"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a href="#local-6989586621679062220"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toDyn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromDynamic</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062221"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679062222"><span class="hs-identifier hs-var">setter</span></a><span> </span><a href="#local-6989586621679062223"><span class="hs-identifier hs-var">updater</span></a><span> </span><span>
</span><a name="line-151"></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-152"></a><span>    </span><a name="local-6989586621679062223"><a href="#local-6989586621679062223"><span class="hs-identifier">updater</span></a></a><span> </span><a name="local-6989586621679062224"><a href="#local-6989586621679062224"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679062225"><a href="#local-6989586621679062225"><span class="hs-identifier">f</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679062226"><a href="#local-6989586621679062226"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679062221"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679062224"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">;</span><span> </span><a href="#local-6989586621679062222"><span class="hs-identifier hs-var">setter</span></a><span> </span><a href="#local-6989586621679062224"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062225"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679062226"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679062226"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-153"></a><span></span><span>
</span><a name="line-154"></a><span class="hs-comment">-- | Create a /reflective/ attribute with a specified name: value can possibly be</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- retrieved using 'getPropValue'. Note: the use of this function is discouraged</span><span>
</span><a name="line-156"></a><span class="hs-comment">-- as it leads to non-compositional code.</span><span>
</span><a name="line-157"></a><span class="hs-identifier">createAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679062183"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062184"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679062183"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062184"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062183"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#CreateAttr"><span class="hs-identifier hs-type">CreateAttr</span></a><span> </span><a href="#local-6989586621679062184"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062183"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-158"></a><a name="createAttr"><a href="Graphics.UI.WX.Attributes.html#createAttr"><span class="hs-identifier">createAttr</span></a></a><span> </span><a name="local-6989586621679062227"><a href="#local-6989586621679062227"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679062228"><a href="#local-6989586621679062228"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679062229"><a href="#local-6989586621679062229"><span class="hs-identifier">setter</span></a></a><span></span><span>
</span><a name="line-159"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#reflectiveAttr"><span class="hs-identifier hs-var">reflectiveAttr</span></a><span> </span><a href="#local-6989586621679062227"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679062228"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679062229"><span class="hs-identifier hs-var">setter</span></a><span></span><span>
</span><a name="line-160"></a><span></span><span>
</span><a name="line-161"></a><span class="hs-comment">-- | Create a new attribute with a specified name, getter, setter, and updater function.</span><span>
</span><a name="line-162"></a><span class="hs-identifier">makeAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062181"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679062182"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062181"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062182"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062181"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062182"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062182"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679062182"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062181"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062182"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-163"></a><a name="makeAttr"><a href="Graphics.UI.WX.Attributes.html#makeAttr"><span class="hs-identifier">makeAttr</span></a></a><span> </span><a name="local-6989586621679062230"><a href="#local-6989586621679062230"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679062231"><a href="#local-6989586621679062231"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679062232"><a href="#local-6989586621679062232"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679062233"><a href="#local-6989586621679062233"><span class="hs-identifier">updater</span></a></a><span></span><span>
</span><a name="line-164"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a href="#local-6989586621679062230"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679062231"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679062232"><span class="hs-identifier hs-var">setter</span></a><span> </span><a href="#local-6989586621679062233"><span class="hs-identifier hs-var">updater</span></a><span> </span><span>
</span><a name="line-165"></a><span></span><span>
</span><a name="line-166"></a><span></span><span>
</span><a name="line-167"></a><span class="hs-comment">-- | Create a new attribute with a specified name, getter and setter function.</span><span>
</span><a name="line-168"></a><span class="hs-identifier">newAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062179"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679062180"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062179"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062180"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062179"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062180"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-169"></a><a name="newAttr"><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier">newAttr</span></a></a><span> </span><a name="local-6989586621679062234"><a href="#local-6989586621679062234"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679062235"><a href="#local-6989586621679062235"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679062236"><a href="#local-6989586621679062236"><span class="hs-identifier">setter</span></a></a><span></span><span>
</span><a name="line-170"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#makeAttr"><span class="hs-identifier hs-var">makeAttr</span></a><span> </span><a href="#local-6989586621679062234"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679062235"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679062236"><span class="hs-identifier hs-var">setter</span></a><span> </span><a href="#local-6989586621679062237"><span class="hs-identifier hs-var">updater</span></a><span> </span><span>
</span><a name="line-171"></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-172"></a><span>    </span><a name="local-6989586621679062237"><a href="#local-6989586621679062237"><span class="hs-identifier">updater</span></a></a><span> </span><a name="local-6989586621679062238"><a href="#local-6989586621679062238"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679062239"><a href="#local-6989586621679062239"><span class="hs-identifier">f</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679062240"><a href="#local-6989586621679062240"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679062235"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679062238"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">;</span><span> </span><a href="#local-6989586621679062236"><span class="hs-identifier hs-var">setter</span></a><span> </span><a href="#local-6989586621679062238"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062239"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679062240"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679062240"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-173"></a><span></span><span>
</span><a name="line-174"></a><span></span><span>
</span><a name="line-175"></a><span class="hs-comment">-- | Define a read-only attribute.</span><span>
</span><a name="line-176"></a><span class="hs-identifier">readAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062177"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679062178"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#ReadAttr"><span class="hs-identifier hs-type">ReadAttr</span></a><span> </span><a href="#local-6989586621679062177"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062178"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-177"></a><a name="readAttr"><a href="Graphics.UI.WX.Attributes.html#readAttr"><span class="hs-identifier">readAttr</span></a></a><span> </span><a name="local-6989586621679062241"><a href="#local-6989586621679062241"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679062242"><a href="#local-6989586621679062242"><span class="hs-identifier">getter</span></a></a><span></span><span>
</span><a name="line-178"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><a href="#local-6989586621679062241"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679062242"><span class="hs-identifier hs-var">getter</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062243"><a href="#local-6989586621679062243"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679062244"><a href="#local-6989586621679062244"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">ioError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">userError</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;attribute '&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679062241"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;' is read-only.&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-179"></a><span></span><span>
</span><a name="line-180"></a><span class="hs-comment">-- | Define a write-only attribute.</span><span>
</span><a name="line-181"></a><span class="hs-identifier">writeAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062175"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062176"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#WriteAttr"><span class="hs-identifier hs-type">WriteAttr</span></a><span> </span><a href="#local-6989586621679062175"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062176"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-182"></a><a name="writeAttr"><a href="Graphics.UI.WX.Attributes.html#writeAttr"><span class="hs-identifier">writeAttr</span></a></a><span> </span><a name="local-6989586621679062949"><a href="#local-6989586621679062949"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679062950"><a href="#local-6989586621679062950"><span class="hs-identifier">setter</span></a></a><span></span><span>
</span><a name="line-183"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><a href="#local-6989586621679062949"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062951"><a href="#local-6989586621679062951"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">ioError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">userError</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;attribute '&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679062949"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;' is write-only.&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062950"><span class="hs-identifier hs-var">setter</span></a><span></span><span>
</span><a name="line-184"></a><span></span><span>
</span><a name="line-185"></a><span class="hs-comment">-- | A dummy attribute.</span><span>
</span><a name="line-186"></a><span class="hs-identifier">nullAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#WriteAttr"><span class="hs-identifier hs-type">WriteAttr</span></a><span> </span><a href="#local-6989586621679062173"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062174"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-187"></a><a name="nullAttr"><a href="Graphics.UI.WX.Attributes.html#nullAttr"><span class="hs-identifier">nullAttr</span></a></a><span> </span><a name="local-6989586621679062952"><a href="#local-6989586621679062952"><span class="hs-identifier">name</span></a></a><span></span><span>
</span><a name="line-188"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#writeAttr"><span class="hs-identifier hs-var">writeAttr</span></a><span> </span><a href="#local-6989586621679062952"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062953"><a href="#local-6989586621679062953"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679062954"><a href="#local-6989586621679062954"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-189"></a><span></span><span>
</span><a name="line-190"></a><span class="hs-comment">-- | A constant attribute.</span><span>
</span><a name="line-191"></a><span class="hs-identifier">constAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679062171"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062171"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062172"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062171"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-192"></a><a name="constAttr"><a href="Graphics.UI.WX.Attributes.html#constAttr"><span class="hs-identifier">constAttr</span></a></a><span> </span><a name="local-6989586621679062955"><a href="#local-6989586621679062955"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679062956"><a href="#local-6989586621679062956"><span class="hs-identifier">x</span></a></a><span></span><span>
</span><a name="line-193"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><a href="#local-6989586621679062955"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062957"><a href="#local-6989586621679062957"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679062956"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062958"><a href="#local-6989586621679062958"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679062959"><a href="#local-6989586621679062959"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-194"></a><span></span><span>
</span><a name="line-195"></a><span></span><span>
</span><a name="line-196"></a><span class="hs-comment">-- | (@mapAttr get set attr@) maps an attribute of @Attr w a@ to</span><span>
</span><a name="line-197"></a><span class="hs-comment">-- @Attr w b@ where (@get :: a -&gt; b@) is used when the attribute is</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- requested and (@set :: a -&gt; b -&gt; a@) is applied to current</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- value when the attribute is set.</span><span>
</span><a name="line-200"></a><span class="hs-identifier">mapAttr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062168"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062169"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062168"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062169"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062168"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062170"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062168"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062170"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062169"><span class="hs-identifier hs-type">b</span></a><span></span><span>
</span><a name="line-201"></a><a name="mapAttr"><a href="Graphics.UI.WX.Attributes.html#mapAttr"><span class="hs-identifier">mapAttr</span></a></a><span> </span><a name="local-6989586621679062960"><a href="#local-6989586621679062960"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-6989586621679062961"><a href="#local-6989586621679062961"><span class="hs-identifier">set</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679062962"><a href="#local-6989586621679062962"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679062963"><a href="#local-6989586621679062963"><span class="hs-identifier">reflect</span></a></a><span> </span><a name="local-6989586621679062964"><a href="#local-6989586621679062964"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679062965"><a href="#local-6989586621679062965"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679062966"><a href="#local-6989586621679062966"><span class="hs-identifier">updater</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-202"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a href="#local-6989586621679062962"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span></span><span>
</span><a name="line-203"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062967"><a href="#local-6989586621679062967"><span class="hs-identifier">w</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679062968"><a href="#local-6989586621679062968"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679062964"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679062967"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062960"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621679062968"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-204"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062969"><a href="#local-6989586621679062969"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679062970"><a href="#local-6989586621679062970"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679062971"><a href="#local-6989586621679062971"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679062964"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679062969"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">;</span><span> </span><a href="#local-6989586621679062965"><span class="hs-identifier hs-var">setter</span></a><span> </span><a href="#local-6989586621679062969"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062961"><span class="hs-identifier hs-var">set</span></a><span> </span><a href="#local-6989586621679062971"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679062970"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-205"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062972"><a href="#local-6989586621679062972"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679062973"><a href="#local-6989586621679062973"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679062975"><a href="#local-6989586621679062975"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679062966"><span class="hs-identifier hs-var">updater</span></a><span> </span><a href="#local-6989586621679062972"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679062974"><a href="#local-6989586621679062974"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062961"><span class="hs-identifier hs-var">set</span></a><span> </span><a href="#local-6989586621679062974"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062973"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062960"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621679062974"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062960"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621679062975"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><a name="line-206"></a><span></span><span>
</span><a name="line-207"></a><span class="hs-comment">-- | (@mapAttrW conv attr@) maps an attribute of @Attr w a@ to</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- @Attr v a@ where (@conv :: v -&gt; w@) is used to convert a widget</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- @v@ into a widget of type @w@.</span><span>
</span><a name="line-210"></a><span class="hs-identifier">mapAttrW</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062165"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062166"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062166"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062167"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062165"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679062167"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-211"></a><a name="mapAttrW"><a href="Graphics.UI.WX.Attributes.html#mapAttrW"><span class="hs-identifier">mapAttrW</span></a></a><span> </span><a name="local-6989586621679062976"><a href="#local-6989586621679062976"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679062977"><a href="#local-6989586621679062977"><span class="hs-identifier">attr</span></a></a><span></span><span>
</span><a name="line-212"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#castAttr"><span class="hs-identifier hs-var">castAttr</span></a><span> </span><a href="#local-6989586621679062976"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679062977"><span class="hs-identifier hs-var">attr</span></a><span></span><span>
</span><a name="line-213"></a><span></span><span>
</span><a name="line-214"></a><span class="hs-comment">-- | Get the value of an attribute</span><span>
</span><a name="line-215"></a><span class="hs-comment">--</span><span>
</span><a name="line-216"></a><span class="hs-comment">-- &gt; t &lt;- get w text</span><span>
</span><a name="line-217"></a><span class="hs-comment">--</span><span>
</span><a name="line-218"></a><span class="hs-identifier">get</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679062163"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062163"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062164"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679062164"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-219"></a><a name="get"><a href="Graphics.UI.WX.Attributes.html#get"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-6989586621679062978"><a href="#local-6989586621679062978"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679062979"><a href="#local-6989586621679062979"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679062980"><a href="#local-6989586621679062980"><span class="hs-identifier">reflect</span></a></a><span> </span><a name="local-6989586621679062981"><a href="#local-6989586621679062981"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679062982"><a href="#local-6989586621679062982"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679062983"><a href="#local-6989586621679062983"><span class="hs-identifier">updater</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-220"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062981"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679062978"><span class="hs-identifier hs-var">w</span></a><span></span><span>
</span><a name="line-221"></a><span></span><span>
</span><a name="line-222"></a><span class="hs-comment">-- | Set a list of properties.</span><span>
</span><a name="line-223"></a><span class="hs-comment">--</span><span>
</span><a name="line-224"></a><span class="hs-comment">-- &gt; set w [text := &quot;Hi&quot;]</span><span>
</span><a name="line-225"></a><span class="hs-comment">--</span><span>
</span><a name="line-226"></a><span class="hs-identifier">set</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679062162"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679062162"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-227"></a><a name="set"><a href="Graphics.UI.WX.Attributes.html#set"><span class="hs-identifier">set</span></a></a><span> </span><a name="local-6989586621679062984"><a href="#local-6989586621679062984"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679062985"><a href="#local-6989586621679062985"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-228"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span> </span><a href="#local-6989586621679062986"><span class="hs-identifier hs-var">setprop</span></a><span> </span><a href="#local-6989586621679062985"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-229"></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-230"></a><span>    </span><a name="local-6989586621679062986"><a href="#local-6989586621679062986"><span class="hs-identifier">setprop</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679062987"><a href="#local-6989586621679062987"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679062988"><a href="#local-6989586621679062988"><span class="hs-identifier">reflect</span></a></a><span> </span><a name="local-6989586621679062989"><a href="#local-6989586621679062989"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679062990"><a href="#local-6989586621679062990"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679062991"><a href="#local-6989586621679062991"><span class="hs-identifier">updater</span></a></a><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a><span> </span><a name="local-6989586621679062992"><a href="#local-6989586621679062992"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-231"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062990"><span class="hs-identifier hs-var">setter</span></a><span> </span><a href="#local-6989586621679062984"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679062992"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-232"></a><span>    </span><span class="hs-identifier">setprop</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679062993"><a href="#local-6989586621679062993"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679062994"><a href="#local-6989586621679062994"><span class="hs-identifier">reflect</span></a></a><span> </span><a name="local-6989586621679062995"><a href="#local-6989586621679062995"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679062996"><a href="#local-6989586621679062996"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679062997"><a href="#local-6989586621679062997"><span class="hs-identifier">updater</span></a></a><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A~"><span class="hs-operator hs-var">:~</span></a><span> </span><a name="local-6989586621679062998"><a href="#local-6989586621679062998"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-233"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="#local-6989586621679062997"><span class="hs-identifier hs-var">updater</span></a><span> </span><a href="#local-6989586621679062984"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679062998"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-234"></a><span>    </span><span class="hs-identifier">setprop</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679062999"><a href="#local-6989586621679062999"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679063000"><a href="#local-6989586621679063000"><span class="hs-identifier">reflect</span></a></a><span> </span><a name="local-6989586621679063001"><a href="#local-6989586621679063001"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679063002"><a href="#local-6989586621679063002"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679063003"><a href="#local-6989586621679063003"><span class="hs-identifier">updater</span></a></a><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3A%3D"><span class="hs-operator hs-var">::=</span></a><span> </span><a name="local-6989586621679063004"><a href="#local-6989586621679063004"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-235"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063002"><span class="hs-identifier hs-var">setter</span></a><span> </span><a href="#local-6989586621679062984"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063004"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679062984"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-236"></a><span>    </span><span class="hs-identifier">setprop</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063005"><a href="#local-6989586621679063005"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679063006"><a href="#local-6989586621679063006"><span class="hs-identifier">reflect</span></a></a><span> </span><a name="local-6989586621679063007"><a href="#local-6989586621679063007"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679063008"><a href="#local-6989586621679063008"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679063009"><a href="#local-6989586621679063009"><span class="hs-identifier">updater</span></a></a><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3A~"><span class="hs-operator hs-var">::~</span></a><span> </span><a name="local-6989586621679063010"><a href="#local-6989586621679063010"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-237"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="#local-6989586621679063009"><span class="hs-identifier hs-var">updater</span></a><span> </span><a href="#local-6989586621679062984"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063010"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679062984"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-238"></a><span></span><span>
</span><a name="line-239"></a><span class="hs-comment">-- | Set the value of an attribute and return the old value.</span><span>
</span><a name="line-240"></a><span class="hs-identifier">swap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679062160"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062160"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062161"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062161"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679062161"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-241"></a><a name="swap"><a href="Graphics.UI.WX.Attributes.html#swap"><span class="hs-identifier">swap</span></a></a><span> </span><a name="local-6989586621679063011"><a href="#local-6989586621679063011"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063012"><a href="#local-6989586621679063012"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679063013"><a href="#local-6989586621679063013"><span class="hs-identifier">reflect</span></a></a><span> </span><a name="local-6989586621679063014"><a href="#local-6989586621679063014"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679063015"><a href="#local-6989586621679063015"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679063016"><a href="#local-6989586621679063016"><span class="hs-identifier">updater</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679063017"><a href="#local-6989586621679063017"><span class="hs-identifier">x</span></a></a><span></span><span>
</span><a name="line-242"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063016"><span class="hs-identifier hs-var">updater</span></a><span> </span><a href="#local-6989586621679063011"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621679063017"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-243"></a><span></span><span>
</span><a name="line-244"></a><span class="hs-comment">-- | Retrieve the name of an attribute</span><span>
</span><a name="line-245"></a><span class="hs-identifier">attrName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062158"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062159"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span></span><span>
</span><a name="line-246"></a><a name="attrName"><a href="Graphics.UI.WX.Attributes.html#attrName"><span class="hs-identifier">attrName</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063018"><a href="#local-6989586621679063018"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-247"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063018"><span class="hs-identifier hs-var">name</span></a><span></span><span>
</span><a name="line-248"></a><span></span><span>
</span><a name="line-249"></a><span class="hs-comment">-- | Retrieve the name of a property.</span><span>
</span><a name="line-250"></a><span class="hs-identifier">propName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679062157"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span></span><span>
</span><a name="line-251"></a><a name="propName"><a href="Graphics.UI.WX.Attributes.html#propName"><span class="hs-identifier">propName</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679063019"><a href="#local-6989586621679063019"><span class="hs-identifier">attr</span></a></a><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a><span> </span><a name="local-6989586621679063020"><a href="#local-6989586621679063020"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#attrName"><span class="hs-identifier hs-var">attrName</span></a><span> </span><a href="#local-6989586621679063019"><span class="hs-identifier hs-var">attr</span></a><span></span><span>
</span><a name="line-252"></a><span class="hs-identifier">propName</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679063021"><a href="#local-6989586621679063021"><span class="hs-identifier">attr</span></a></a><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A~"><span class="hs-operator hs-var">:~</span></a><span> </span><a name="local-6989586621679063022"><a href="#local-6989586621679063022"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#attrName"><span class="hs-identifier hs-var">attrName</span></a><span> </span><a href="#local-6989586621679063021"><span class="hs-identifier hs-var">attr</span></a><span></span><span>
</span><a name="line-253"></a><span class="hs-identifier">propName</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679063023"><a href="#local-6989586621679063023"><span class="hs-identifier">attr</span></a></a><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3A%3D"><span class="hs-operator hs-var">::=</span></a><span> </span><a name="local-6989586621679063024"><a href="#local-6989586621679063024"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#attrName"><span class="hs-identifier hs-var">attrName</span></a><span> </span><a href="#local-6989586621679063023"><span class="hs-identifier hs-var">attr</span></a><span></span><span>
</span><a name="line-254"></a><span class="hs-identifier">propName</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679063025"><a href="#local-6989586621679063025"><span class="hs-identifier">attr</span></a></a><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3A~"><span class="hs-operator hs-var">::~</span></a><span> </span><a name="local-6989586621679063026"><a href="#local-6989586621679063026"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#attrName"><span class="hs-identifier hs-var">attrName</span></a><span> </span><a href="#local-6989586621679063025"><span class="hs-identifier hs-var">attr</span></a><span></span><span>
</span><a name="line-255"></a><span></span><span>
</span><a name="line-256"></a><span></span><span>
</span><a name="line-257"></a><span class="hs-comment">-- | Is a certain property in a list of properties?</span><span>
</span><a name="line-258"></a><span class="hs-identifier">containsProperty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062155"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062156"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679062155"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span></span><span>
</span><a name="line-259"></a><a name="containsProperty"><a href="Graphics.UI.WX.Attributes.html#containsProperty"><span class="hs-identifier">containsProperty</span></a></a><span> </span><a name="local-6989586621679063027"><a href="#local-6989586621679063027"><span class="hs-identifier">attr</span></a></a><span> </span><a name="local-6989586621679063028"><a href="#local-6989586621679063028"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-260"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#containsPropName"><span class="hs-identifier hs-var">containsPropName</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#attrName"><span class="hs-identifier hs-var">attrName</span></a><span> </span><a href="#local-6989586621679063027"><span class="hs-identifier hs-var">attr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063028"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-261"></a><span></span><span>
</span><a name="line-262"></a><span class="hs-comment">-- | Is a certain property in a list of properties?</span><span>
</span><a name="line-263"></a><span class="hs-identifier">containsPropName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679062154"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span></span><span>
</span><a name="line-264"></a><a name="containsPropName"><a href="Graphics.UI.WX.Attributes.html#containsPropName"><span class="hs-identifier">containsPropName</span></a></a><span> </span><a name="local-6989586621679063029"><a href="#local-6989586621679063029"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679063030"><a href="#local-6989586621679063030"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-265"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679063031"><a href="#local-6989586621679063031"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#propName"><span class="hs-identifier hs-var">propName</span></a><span> </span><a href="#local-6989586621679063031"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679063029"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063030"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-266"></a><span></span><span>
</span><a name="line-267"></a><span></span><span>
</span><a name="line-268"></a><span class="hs-comment">-- | Property value: used when retrieving a property from a list.</span><span>
</span><a name="line-269"></a><span class="hs-keyword">data</span><span> </span><a name="PropValue"><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier">PropValue</span></a></a><span> </span><a name="local-6989586621679061964"><a href="#local-6989586621679061964"><span class="hs-identifier">a</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="PropValue"><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier">PropValue</span></a></a><span>  </span><a href="#local-6989586621679061964"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-270"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="PropModify"><a href="Graphics.UI.WX.Attributes.html#PropModify"><span class="hs-identifier">PropModify</span></a></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061964"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061964"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-271"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="PropNone"><a href="Graphics.UI.WX.Attributes.html#PropNone"><span class="hs-identifier">PropNone</span></a></a><span></span><span>
</span><a name="line-272"></a><span></span><span>
</span><a name="line-273"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679063104"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier hs-type">PropValue</span></a><span> </span><a href="#local-6989586621679063104"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-274"></a><span>  </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier hs-var">PropValue</span></a><span> </span><a name="local-6989586621679063105"><a href="#local-6989586621679063105"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;PropValue &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679063105"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-275"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropModify"><span class="hs-identifier hs-var">PropModify</span></a><span> </span><a name="local-6989586621679063106"><a href="#local-6989586621679063106"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;PropModify&quot;</span><span></span><span>
</span><a name="line-276"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropNone"><span class="hs-identifier hs-var">PropNone</span></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;PropNone&quot;</span><span></span><span>
</span><a name="line-277"></a><span></span><span>
</span><a name="line-278"></a><span class="hs-comment">-- | Retrieve the value of a property and the list with the property removed.</span><span>
</span><a name="line-279"></a><span class="hs-identifier">filterProperty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679062152"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062153"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062152"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679062153"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier hs-type">PropValue</span></a><span> </span><a href="#local-6989586621679062152"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679062153"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-280"></a><a name="filterProperty"><a href="Graphics.UI.WX.Attributes.html#filterProperty"><span class="hs-identifier">filterProperty</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063032"><a href="#local-6989586621679063032"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679063033"><a href="#local-6989586621679063033"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-281"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063034"><span class="hs-identifier hs-var">walk</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="Graphics.UI.WX.Attributes.html#PropNone"><span class="hs-identifier hs-var">PropNone</span></a><span> </span><a href="#local-6989586621679063033"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-282"></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-283"></a><span>    </span><span class="hs-comment">-- Daan: oh, how a simple thing like properties can result into this... ;-)</span><span>
</span><a name="line-284"></a><span>    </span><span class="hs-identifier">walk</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679063035"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679063036"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier hs-type">PropValue</span></a><span> </span><a href="#local-6989586621679063035"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679063036"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier hs-type">PropValue</span></a><span> </span><a href="#local-6989586621679063035"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679063036"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-285"></a><span>    </span><a name="local-6989586621679063034"><a href="#local-6989586621679063034"><span class="hs-identifier">walk</span></a></a><span> </span><a name="local-6989586621679063037"><a href="#local-6989586621679063037"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621679063038"><a href="#local-6989586621679063038"><span class="hs-identifier">res</span></a></a><span> </span><a name="local-6989586621679063039"><a href="#local-6989586621679063039"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-286"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679063039"><span class="hs-identifier hs-var">props</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-287"></a><span>          </span><span class="hs-comment">-- Property setter found.</span><span>
</span><a name="line-288"></a><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063041"><a href="#local-6989586621679063041"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679063042"><a href="#local-6989586621679063042"><span class="hs-identifier">todyn</span></a></a><span class="hs-special">,</span><a name="local-6989586621679063043"><a href="#local-6989586621679063043"><span class="hs-identifier">fromdyn</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a><span> </span><a name="local-6989586621679063044"><a href="#local-6989586621679063044"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679063045"><a href="#local-6989586621679063045"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679063032"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679063041"><span class="hs-identifier hs-var">attr</span></a><span></span><span>
</span><a name="line-289"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">fromDynamic</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063042"><span class="hs-identifier hs-var">todyn</span></a><span> </span><a href="#local-6989586621679063044"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-290"></a><span>                   </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063046"><a href="#local-6989586621679063046"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063034"><span class="hs-identifier hs-var">walk</span></a><span> </span><a href="#local-6989586621679063037"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier hs-var">PropValue</span></a><span> </span><a href="#local-6989586621679063046"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063045"><span class="hs-identifier hs-var">rest</span></a><span></span><span>
</span><a name="line-291"></a><span>                   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063034"><span class="hs-identifier hs-var">walk</span></a><span> </span><a href="#local-6989586621679063037"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621679063038"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679063039"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-292"></a><span>                   </span><span>
</span><a name="line-293"></a><span>          </span><span class="hs-comment">-- Property modifier found.</span><span>
</span><a name="line-294"></a><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063047"><a href="#local-6989586621679063047"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679063048"><a href="#local-6989586621679063048"><span class="hs-identifier">todyn</span></a></a><span class="hs-special">,</span><a name="local-6989586621679063049"><a href="#local-6989586621679063049"><span class="hs-identifier">fromdyn</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A~"><span class="hs-operator hs-var">:~</span></a><span> </span><a name="local-6989586621679063050"><a href="#local-6989586621679063050"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679063051"><a href="#local-6989586621679063051"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679063032"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679063047"><span class="hs-identifier hs-var">attr</span></a><span></span><span>
</span><a name="line-295"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679063052"><a href="#local-6989586621679063052"><span class="hs-identifier">dynf</span></a></a><span> </span><a name="local-6989586621679063053"><a href="#local-6989586621679063053"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679063049"><span class="hs-identifier hs-var">fromdyn</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toDyn</span><span> </span><a href="#local-6989586621679063053"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-296"></a><span>                                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063054"><a href="#local-6989586621679063054"><span class="hs-identifier">xx</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">fromDynamic</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063048"><span class="hs-identifier hs-var">todyn</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063050"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679063054"><span class="hs-identifier hs-var">xx</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-297"></a><span>                                             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063055"><a href="#local-6989586621679063055"><span class="hs-identifier">y</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063055"><span class="hs-identifier hs-var">y</span></a><span></span><span>
</span><a name="line-298"></a><span>                                             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063053"><span class="hs-identifier hs-var">x</span></a><span>  </span><span class="hs-comment">-- identity</span><span>
</span><a name="line-299"></a><span>                                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063053"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-comment">-- identity</span><span>
</span><a name="line-300"></a><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679063038"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-301"></a><span>                      </span><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier hs-var">PropValue</span></a><span> </span><a name="local-6989586621679063056"><a href="#local-6989586621679063056"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063034"><span class="hs-identifier hs-var">walk</span></a><span> </span><a href="#local-6989586621679063037"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier hs-var">PropValue</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063052"><span class="hs-identifier hs-var">dynf</span></a><span> </span><a href="#local-6989586621679063056"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063051"><span class="hs-identifier hs-var">rest</span></a><span></span><span>
</span><a name="line-302"></a><span>                      </span><a href="Graphics.UI.WX.Attributes.html#PropModify"><span class="hs-identifier hs-var">PropModify</span></a><span> </span><a name="local-6989586621679063057"><a href="#local-6989586621679063057"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063034"><span class="hs-identifier hs-var">walk</span></a><span> </span><a href="#local-6989586621679063037"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropModify"><span class="hs-identifier hs-var">PropModify</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063052"><span class="hs-identifier hs-var">dynf</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679063057"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063051"><span class="hs-identifier hs-var">rest</span></a><span></span><span>
</span><a name="line-303"></a><span>                      </span><a href="Graphics.UI.WX.Attributes.html#PropNone"><span class="hs-identifier hs-var">PropNone</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063034"><span class="hs-identifier hs-var">walk</span></a><span> </span><a href="#local-6989586621679063037"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropModify"><span class="hs-identifier hs-var">PropModify</span></a><span> </span><a href="#local-6989586621679063052"><span class="hs-identifier hs-var">dynf</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063051"><span class="hs-identifier hs-var">rest</span></a><span></span><span>
</span><a name="line-304"></a><span></span><span>
</span><a name="line-305"></a><span>          </span><span class="hs-comment">-- Property found, but with the wrong arguments</span><span>
</span><a name="line-306"></a><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063058"><a href="#local-6989586621679063058"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679063059"><a href="#local-6989586621679063059"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679063032"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679063058"><span class="hs-identifier hs-var">attr</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063040"><span class="hs-identifier hs-var">stop</span></a><span></span><span>
</span><a name="line-307"></a><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063060"><a href="#local-6989586621679063060"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A~"><span class="hs-operator hs-var">:~</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679063061"><a href="#local-6989586621679063061"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679063032"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679063060"><span class="hs-identifier hs-var">attr</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063040"><span class="hs-identifier hs-var">stop</span></a><span></span><span>
</span><a name="line-308"></a><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063062"><a href="#local-6989586621679063062"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3A%3D"><span class="hs-operator hs-var">::=</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679063063"><a href="#local-6989586621679063063"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679063032"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679063062"><span class="hs-identifier hs-var">attr</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063040"><span class="hs-identifier hs-var">stop</span></a><span></span><span>
</span><a name="line-309"></a><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><a name="local-6989586621679063064"><a href="#local-6989586621679063064"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3A~"><span class="hs-operator hs-var">::~</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679063065"><a href="#local-6989586621679063065"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679063032"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679063064"><span class="hs-identifier hs-var">attr</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063040"><span class="hs-identifier hs-var">stop</span></a><span></span><span>
</span><a name="line-310"></a><span></span><span>
</span><a name="line-311"></a><span>          </span><span class="hs-comment">-- Defaults</span><span>
</span><a name="line-312"></a><span>          </span><span class="hs-special">(</span><a name="local-6989586621679063066"><a href="#local-6989586621679063066"><span class="hs-identifier">prop</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679063067"><a href="#local-6989586621679063067"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-313"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063034"><span class="hs-identifier hs-var">walk</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063066"><span class="hs-identifier hs-var">prop</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679063037"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063038"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679063067"><span class="hs-identifier hs-var">rest</span></a><span></span><span>
</span><a name="line-314"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063040"><span class="hs-identifier hs-var">stop</span></a><span></span><span>
</span><a name="line-315"></a><span>       </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-316"></a><span>        </span><a name="local-6989586621679063040"><a href="#local-6989586621679063040"><span class="hs-identifier">stop</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063038"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679063037"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679063039"><span class="hs-identifier hs-var">props</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-317"></a><span>  </span><span>
</span><a name="line-318"></a><span>               </span><span>
</span><a name="line-319"></a><span class="hs-comment">-- | Try to find a property value and call the contination function with that value</span><span>
</span><a name="line-320"></a><span class="hs-comment">-- and the property list witht the searched property removed. If the property is not</span><span>
</span><a name="line-321"></a><span class="hs-comment">-- found, use the default value and the unchanged property list.</span><span>
</span><a name="line-322"></a><span class="hs-identifier">withProperty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679062149"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679062150"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679062149"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062149"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062149"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679062150"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062151"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679062150"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062151"><span class="hs-identifier hs-type">b</span></a><span></span><span>
</span><a name="line-323"></a><a name="withProperty"><a href="Graphics.UI.WX.Attributes.html#withProperty"><span class="hs-identifier">withProperty</span></a></a><span> </span><a name="local-6989586621679063068"><a href="#local-6989586621679063068"><span class="hs-identifier">attr</span></a></a><span> </span><a name="local-6989586621679063069"><a href="#local-6989586621679063069"><span class="hs-identifier">def</span></a></a><span> </span><a name="local-6989586621679063070"><a href="#local-6989586621679063070"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679063071"><a href="#local-6989586621679063071"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-324"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Graphics.UI.WX.Attributes.html#filterProperty"><span class="hs-identifier hs-var">filterProperty</span></a><span> </span><a href="#local-6989586621679063068"><span class="hs-identifier hs-var">attr</span></a><span> </span><a href="#local-6989586621679063071"><span class="hs-identifier hs-var">props</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-325"></a><span>      </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier hs-var">PropValue</span></a><span> </span><a name="local-6989586621679063072"><a href="#local-6989586621679063072"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063073"><a href="#local-6989586621679063073"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063070"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679063072"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679063073"><span class="hs-identifier hs-var">ps</span></a><span></span><span>
</span><a name="line-326"></a><span>      </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropModify"><span class="hs-identifier hs-var">PropModify</span></a><span> </span><a name="local-6989586621679063074"><a href="#local-6989586621679063074"><span class="hs-identifier">f</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063075"><a href="#local-6989586621679063075"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063070"><span class="hs-identifier hs-var">cont</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063074"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679063069"><span class="hs-identifier hs-var">def</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063075"><span class="hs-identifier hs-var">ps</span></a><span></span><span>
</span><a name="line-327"></a><span>      </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropNone"><span class="hs-identifier hs-var">PropNone</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063076"><a href="#local-6989586621679063076"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063070"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679063069"><span class="hs-identifier hs-var">def</span></a><span> </span><a href="#local-6989586621679063076"><span class="hs-identifier hs-var">ps</span></a><span></span><span>
</span><a name="line-328"></a><span></span><span>
</span><a name="line-329"></a><span class="hs-comment">-- | Try to find a property value. Return @Nothing@ if not found at all.</span><span>
</span><a name="line-330"></a><span class="hs-identifier">findProperty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679061984"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679061985"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061984"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061984"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679061985"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061984"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679061985"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-331"></a><a name="findProperty"><a href="Graphics.UI.WX.Attributes.html#findProperty"><span class="hs-identifier">findProperty</span></a></a><span> </span><a name="local-6989586621679063077"><a href="#local-6989586621679063077"><span class="hs-identifier">attr</span></a></a><span> </span><a name="local-6989586621679063078"><a href="#local-6989586621679063078"><span class="hs-identifier">def</span></a></a><span> </span><a name="local-6989586621679063079"><a href="#local-6989586621679063079"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-332"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Graphics.UI.WX.Attributes.html#filterProperty"><span class="hs-identifier hs-var">filterProperty</span></a><span> </span><a href="#local-6989586621679063077"><span class="hs-identifier hs-var">attr</span></a><span> </span><a href="#local-6989586621679063079"><span class="hs-identifier hs-var">props</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-333"></a><span>      </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier hs-var">PropValue</span></a><span> </span><a name="local-6989586621679063080"><a href="#local-6989586621679063080"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063081"><a href="#local-6989586621679063081"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063080"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679063081"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-334"></a><span>      </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropModify"><span class="hs-identifier hs-var">PropModify</span></a><span> </span><a name="local-6989586621679063082"><a href="#local-6989586621679063082"><span class="hs-identifier">f</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063083"><a href="#local-6989586621679063083"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063082"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679063078"><span class="hs-identifier hs-var">def</span></a><span class="hs-special">,</span><a href="#local-6989586621679063083"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-335"></a><span>      </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropNone"><span class="hs-identifier hs-var">PropNone</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063084"><a href="#local-6989586621679063084"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span></span><span>
</span><a name="line-336"></a><span></span><span>
</span><a name="line-337"></a><span></span><span>
</span><a name="line-338"></a><span></span><span>
</span><a name="line-339"></a><span class="hs-comment">-- | Transform the properties based on a style property.</span><span>
</span><a name="line-340"></a><span class="hs-identifier">withStyleProperty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679061982"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Style</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679061982"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Style</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061983"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679061982"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Style</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061983"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-341"></a><a name="withStyleProperty"><a href="Graphics.UI.WX.Attributes.html#withStyleProperty"><span class="hs-identifier">withStyleProperty</span></a></a><span> </span><a name="local-6989586621679063085"><a href="#local-6989586621679063085"><span class="hs-identifier">prop</span></a></a><span> </span><a name="local-6989586621679063086"><a href="#local-6989586621679063086"><span class="hs-identifier">flag</span></a></a><span> </span><span>
</span><a name="line-342"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#withStylePropertyEx"><span class="hs-identifier hs-var">withStylePropertyEx</span></a><span> </span><a href="#local-6989586621679063085"><span class="hs-identifier hs-var">prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bitsSet</span><span> </span><a href="#local-6989586621679063086"><span class="hs-identifier hs-var">flag</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679063087"><a href="#local-6989586621679063087"><span class="hs-identifier">isSet</span></a></a><span> </span><a name="local-6989586621679063088"><a href="#local-6989586621679063088"><span class="hs-identifier">style</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679063087"><span class="hs-identifier hs-var">isSet</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063088"><span class="hs-identifier hs-var">style</span></a><span> </span><span class="hs-operator hs-var">.+.</span><span> </span><a href="#local-6989586621679063086"><span class="hs-identifier hs-var">flag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063088"><span class="hs-identifier hs-var">style</span></a><span> </span><span class="hs-operator hs-var">.-.</span><span> </span><a href="#local-6989586621679063086"><span class="hs-identifier hs-var">flag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><a name="line-343"></a><span></span><span>
</span><a name="line-344"></a><span class="hs-comment">-- | Transform the properties based on a style property. The flag is interpreted negatively, i.e. @True@</span><span>
</span><a name="line-345"></a><span class="hs-comment">-- removes the bit instead of setting it.</span><span>
</span><a name="line-346"></a><span class="hs-identifier">withStylePropertyNot</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679061980"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Style</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679061980"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Style</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061981"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679061980"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Style</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061981"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-347"></a><a name="withStylePropertyNot"><a href="Graphics.UI.WX.Attributes.html#withStylePropertyNot"><span class="hs-identifier">withStylePropertyNot</span></a></a><span> </span><a name="local-6989586621679063089"><a href="#local-6989586621679063089"><span class="hs-identifier">prop</span></a></a><span> </span><a name="local-6989586621679063090"><a href="#local-6989586621679063090"><span class="hs-identifier">flag</span></a></a><span> </span><span>
</span><a name="line-348"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#withStylePropertyEx"><span class="hs-identifier hs-var">withStylePropertyEx</span></a><span> </span><a href="#local-6989586621679063089"><span class="hs-identifier hs-var">prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">bitsSet</span><span> </span><a href="#local-6989586621679063090"><span class="hs-identifier hs-var">flag</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679063091"><a href="#local-6989586621679063091"><span class="hs-identifier">isSet</span></a></a><span> </span><a name="local-6989586621679063092"><a href="#local-6989586621679063092"><span class="hs-identifier">style</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679063091"><span class="hs-identifier hs-var">isSet</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063092"><span class="hs-identifier hs-var">style</span></a><span> </span><span class="hs-operator hs-var">.-.</span><span> </span><a href="#local-6989586621679063090"><span class="hs-identifier hs-var">flag</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063092"><span class="hs-identifier hs-var">style</span></a><span> </span><span class="hs-operator hs-var">.+.</span><span> </span><a href="#local-6989586621679063090"><span class="hs-identifier hs-var">flag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><a name="line-349"></a><span></span><span>
</span><a name="line-350"></a><span></span><span>
</span><a name="line-351"></a><span class="hs-comment">-- | Transform the properties based on a style property.</span><span>
</span><a name="line-352"></a><span class="hs-identifier">withStylePropertyEx</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="#local-6989586621679061978"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Style</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Style</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Style</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679061978"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Style</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061979"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="#local-6989586621679061978"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Style</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061979"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-353"></a><a name="withStylePropertyEx"><a href="Graphics.UI.WX.Attributes.html#withStylePropertyEx"><span class="hs-identifier">withStylePropertyEx</span></a></a><span> </span><a name="local-6989586621679063093"><a href="#local-6989586621679063093"><span class="hs-identifier">prop</span></a></a><span> </span><a name="local-6989586621679063094"><a href="#local-6989586621679063094"><span class="hs-identifier">def</span></a></a><span> </span><a name="local-6989586621679063095"><a href="#local-6989586621679063095"><span class="hs-identifier">transform</span></a></a><span> </span><a name="local-6989586621679063096"><a href="#local-6989586621679063096"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679063097"><a href="#local-6989586621679063097"><span class="hs-identifier">props</span></a></a><span> </span><a name="local-6989586621679063098"><a href="#local-6989586621679063098"><span class="hs-identifier">style</span></a></a><span></span><span>
</span><a name="line-354"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Graphics.UI.WX.Attributes.html#filterProperty"><span class="hs-identifier hs-var">filterProperty</span></a><span> </span><a href="#local-6989586621679063093"><span class="hs-identifier hs-var">prop</span></a><span> </span><a href="#local-6989586621679063097"><span class="hs-identifier hs-var">props</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-355"></a><span>      </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropValue"><span class="hs-identifier hs-var">PropValue</span></a><span> </span><a name="local-6989586621679063099"><a href="#local-6989586621679063099"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063100"><a href="#local-6989586621679063100"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063096"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679063100"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063095"><span class="hs-identifier hs-var">transform</span></a><span> </span><a href="#local-6989586621679063099"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679063098"><span class="hs-identifier hs-var">style</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-356"></a><span>      </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropModify"><span class="hs-identifier hs-var">PropModify</span></a><span> </span><a name="local-6989586621679063101"><a href="#local-6989586621679063101"><span class="hs-identifier">f</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063102"><a href="#local-6989586621679063102"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063096"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679063102"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063095"><span class="hs-identifier hs-var">transform</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063101"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063094"><span class="hs-identifier hs-var">def</span></a><span> </span><a href="#local-6989586621679063098"><span class="hs-identifier hs-var">style</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063098"><span class="hs-identifier hs-var">style</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-357"></a><span>      </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#PropNone"><span class="hs-identifier hs-var">PropNone</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063103"><a href="#local-6989586621679063103"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063096"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679063103"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621679063098"><span class="hs-identifier hs-var">style</span></a><span></span><span>
</span><a name="line-358"></a></pre></body></html>