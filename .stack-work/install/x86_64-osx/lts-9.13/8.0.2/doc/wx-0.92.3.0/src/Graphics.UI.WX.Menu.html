<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TypeSynonymInstances, FlexibleInstances #-}</span><span></span><span>
</span><a name="line-2"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-3"></a><span class="hs-comment">{-|
Module      :  Menu
Copyright   :  (c) Daan Leijen 2003
               (c) Shelarcy (shelarcy@gmail.com) 2006
License     :  wxWindows

Maintainer  :  wxhaskell-devel@lists.sourceforge.net
Stability   :  provisional
Portability :  portable

Defines Menus, toolbars, and statusbars.
    
The function 'menuPane' is used to create a menu
that can contain 'menuItem's. Menu items can contain event handlers
using ('on' 'command'), but they can also be set, using the 'menu'
function, on a frame or (mdi) window so that the menu command is handled
in the context of the active window, instead of the context of the
entire application. 

&gt; do frame  &lt;- frame    [text := &quot;Demo&quot;]
&gt;    file   &lt;- menuPane [text := &quot;&amp;File&quot;]
&gt;    mclose &lt;- menuItem file [text := &quot;&amp;Close\tCtrl+C&quot;, help := &quot;Close the document&quot;] 
&gt;    set frame [menuBar          := [file] 
&gt;              ,on (menu mclose) := ...] 

-}</span><span></span><span>
</span><a name="line-29"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-30"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WX</span><span class="hs-operator">.</span><span class="hs-identifier">Menu</span><span></span><span>
</span><a name="line-31"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- * Menu</span><span>
</span><a name="line-32"></a><span>      </span><span class="hs-comment">-- ** Menu containers</span><span>
</span><a name="line-33"></a><span>      </span><span class="hs-identifier hs-type">MenuBar</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Menu</span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuBar"><span class="hs-identifier hs-var">menuBar</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuPopup"><span class="hs-identifier hs-var">menuPopup</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuPane"><span class="hs-identifier hs-var">menuPane</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuHelp"><span class="hs-identifier hs-var">menuHelp</span></a><span></span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuRes"><span class="hs-identifier hs-var">menuRes</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuBarLoadRes"><span class="hs-identifier hs-var">menuBarLoadRes</span></a><span></span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-comment">-- ** Menu events</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menu"><span class="hs-identifier hs-var">menu</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuId"><span class="hs-identifier hs-var">menuId</span></a><span></span><span>
</span><a name="line-37"></a><span>      </span><span class="hs-comment">-- ** Menu items</span><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MenuItem</span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuItem"><span class="hs-identifier hs-var">menuItem</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuQuit"><span class="hs-identifier hs-var">menuQuit</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuAbout"><span class="hs-identifier hs-var">menuAbout</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuItemEx"><span class="hs-identifier hs-var">menuItemEx</span></a><span></span><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuItemOnCommandRes"><span class="hs-identifier hs-var">menuItemOnCommandRes</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuLine"><span class="hs-identifier hs-var">menuLine</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuSub"><span class="hs-identifier hs-var">menuSub</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuRadioItem"><span class="hs-identifier hs-var">menuRadioItem</span></a><span></span><span>
</span><a name="line-40"></a><span>    </span><span class="hs-comment">-- * Tool bar</span><span>
</span><a name="line-41"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToolBar</span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#toolBar"><span class="hs-identifier hs-var">toolBar</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#toolBarEx"><span class="hs-identifier hs-var">toolBarEx</span></a><span></span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#toolMenu"><span class="hs-identifier hs-var">toolMenu</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#toolMenuFromBitmap"><span class="hs-identifier hs-var">toolMenuFromBitmap</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#toolItem"><span class="hs-identifier hs-var">toolItem</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#toolControl"><span class="hs-identifier hs-var">toolControl</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#tool"><span class="hs-identifier hs-var">tool</span></a><span></span><span>
</span><a name="line-43"></a><span>    </span><span class="hs-comment">-- * Status bar</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#StatusField"><span class="hs-identifier hs-type">StatusField</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#statusBar"><span class="hs-identifier hs-var">statusBar</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#statusField"><span class="hs-identifier hs-var">statusField</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#statusWidth"><span class="hs-identifier hs-var">statusWidth</span></a><span></span><span>
</span><a name="line-45"></a><span>    </span><span class="hs-comment">-- * Deprecated</span><span>
</span><a name="line-46"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuList"><span class="hs-identifier hs-var">menuList</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#menubar"><span class="hs-identifier hs-var">menubar</span></a><span class="hs-special">,</span><span> </span><a href="Graphics.UI.WX.Menu.html#statusbar"><span class="hs-identifier hs-var">statusbar</span></a><span></span><span>
</span><a name="line-47"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-48"></a><span></span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">toUpper</span><span> </span><span class="hs-special">)</span><span></span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">partition</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">intersperse</span><span> </span><span class="hs-special">)</span><span></span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Unsafe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unsafePerformIO</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">Ptr</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">nullPtr</span><span> </span><span class="hs-special">)</span><span></span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WXCore</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Event</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-54"></a><span></span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.UI.WX.Types.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WX</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span></span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.UI.WX.Attributes.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WX</span><span class="hs-operator">.</span><span class="hs-identifier">Attributes</span></a><span></span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.UI.WX.Layout.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WX</span><span class="hs-operator">.</span><span class="hs-identifier">Layout</span></a><span></span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.UI.WX.Classes.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WX</span><span class="hs-operator">.</span><span class="hs-identifier">Classes</span></a><span></span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.UI.WX.Events.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">UI</span><span class="hs-operator">.</span><span class="hs-identifier">WX</span><span class="hs-operator">.</span><span class="hs-identifier">Events</span></a><span></span><span>
</span><a name="line-60"></a><span></span><span>
</span><a name="line-61"></a><span></span><span>
</span><a name="line-62"></a><span class="hs-comment">{--------------------------------------------------------------------------------
  Menubar
--------------------------------------------------------------------------------}</span><span></span><span>
</span><a name="line-65"></a><span class="hs-pragma">{-# DEPRECATED menubar &quot;Use menuBar instead&quot; #-}</span><span></span><span>
</span><a name="line-66"></a><span class="hs-comment">-- | /Deprecated/: use 'menuBar'.</span><span>
</span><a name="line-67"></a><span class="hs-identifier">menubar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WX.Attributes.html#WriteAttr"><span class="hs-identifier hs-type">WriteAttr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Frame</span><span> </span><a href="#local-6989586621679096705"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Menu</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-68"></a><a name="menubar"><a href="Graphics.UI.WX.Menu.html#menubar"><span class="hs-identifier">menubar</span></a></a><span></span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuBar"><span class="hs-identifier hs-var">menuBar</span></a><span></span><span>
</span><a name="line-70"></a><span></span><span>
</span><a name="line-71"></a><span class="hs-comment">-- | Set the menu bar of a frame.</span><span>
</span><a name="line-72"></a><span class="hs-identifier">menuBar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WX.Attributes.html#WriteAttr"><span class="hs-identifier hs-type">WriteAttr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Frame</span><span> </span><a href="#local-6989586621679096704"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Menu</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-73"></a><a name="menuBar"><a href="Graphics.UI.WX.Menu.html#menuBar"><span class="hs-identifier">menuBar</span></a></a><span></span><span>
</span><a name="line-74"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#writeAttr"><span class="hs-identifier hs-var">writeAttr</span></a><span> </span><span class="hs-string">&quot;menubar&quot;</span><span> </span><a href="#local-6989586621679096706"><span class="hs-identifier hs-var">setter</span></a><span></span><span>
</span><a name="line-75"></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-76"></a><span>    </span><a name="local-6989586621679096706"><a href="#local-6989586621679096706"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679096708"><a href="#local-6989586621679096708"><span class="hs-identifier">frame</span></a></a><span> </span><a name="local-6989586621679096709"><a href="#local-6989586621679096709"><span class="hs-identifier">menus</span></a></a><span></span><span>
</span><a name="line-77"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679096710"><a href="#local-6989586621679096710"><span class="hs-identifier">mb</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">menuBarCreate</span><span> </span><span class="hs-identifier hs-var">wxMB_DOCKABLE</span><span></span><span>
</span><a name="line-78"></a><span>           </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096707"><span class="hs-identifier hs-var">append</span></a><span> </span><a href="#local-6989586621679096710"><span class="hs-identifier hs-var">mb</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096709"><span class="hs-identifier hs-var">menus</span></a><span></span><span>
</span><a name="line-79"></a><span>           </span><span class="hs-identifier hs-var">frameSetMenuBar</span><span> </span><a href="#local-6989586621679096708"><span class="hs-identifier hs-var">frame</span></a><span> </span><a href="#local-6989586621679096710"><span class="hs-identifier hs-var">mb</span></a><span></span><span>
</span><a name="line-80"></a><span>           </span><span class="hs-comment">-- set delayed menu handlers on the frame</span><span>
</span><a name="line-81"></a><span>           </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#evtHandlerSetAndResetMenuCommands"><span class="hs-identifier hs-var">evtHandlerSetAndResetMenuCommands</span></a><span> </span><a href="#local-6989586621679096708"><span class="hs-identifier hs-var">frame</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096709"><span class="hs-identifier hs-var">menus</span></a><span></span><span>
</span><a name="line-82"></a><span>           </span><span class="hs-comment">-- work around menu bug in wxMac 2.5.1</span><span>
</span><a name="line-83"></a><span>           </span><a name="local-6989586621679096711"><a href="#local-6989586621679096711"><span class="hs-identifier">vis</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">windowIsShown</span><span> </span><a href="#local-6989586621679096708"><span class="hs-identifier hs-var">frame</span></a><span></span><span>
</span><a name="line-84"></a><span>           </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096711"><span class="hs-identifier hs-var">vis</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">wxToolkit</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">WxMac</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">div</span><span> </span><span class="hs-identifier hs-var">wxVersion</span><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">25</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-85"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">windowHide</span><span> </span><a href="#local-6989586621679096708"><span class="hs-identifier hs-var">frame</span></a><span></span><span>
</span><a name="line-86"></a><span>                    </span><span class="hs-identifier hs-var">windowShow</span><span> </span><a href="#local-6989586621679096708"><span class="hs-identifier hs-var">frame</span></a><span></span><span>
</span><a name="line-87"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-88"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-89"></a><span></span><span>
</span><a name="line-90"></a><span>    </span><a name="local-6989586621679096707"><a href="#local-6989586621679096707"><span class="hs-identifier">append</span></a></a><span> </span><a name="local-6989586621679096849"><a href="#local-6989586621679096849"><span class="hs-identifier">mb</span></a></a><span> </span><a name="local-6989586621679096850"><a href="#local-6989586621679096850"><span class="hs-identifier">menu</span></a></a><span></span><span>
</span><a name="line-91"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679096851"><a href="#local-6989586621679096851"><span class="hs-identifier">title</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">menuGetTitle</span><span> </span><a href="#local-6989586621679096850"><span class="hs-identifier hs-var">menu</span></a><span></span><span>
</span><a name="line-92"></a><span>           </span><span class="hs-identifier hs-var">menuSetTitle</span><span> </span><a href="#local-6989586621679096850"><span class="hs-identifier hs-var">menu</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span></span><span>
</span><a name="line-93"></a><span>           </span><span class="hs-identifier hs-var">menuBarAppend</span><span> </span><a href="#local-6989586621679096849"><span class="hs-identifier hs-var">mb</span></a><span> </span><a href="#local-6989586621679096850"><span class="hs-identifier hs-var">menu</span></a><span> </span><a href="#local-6989586621679096851"><span class="hs-identifier hs-var">title</span></a><span></span><span>
</span><a name="line-94"></a><span></span><span>
</span><a name="line-95"></a><span class="hs-comment">-- | Retrieve a menu bar instance which has been constructed by loading</span><span>
</span><a name="line-96"></a><span class="hs-comment">--   a resource file for a given top level window.</span><span>
</span><a name="line-97"></a><span class="hs-identifier">menuBarLoadRes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Window</span><span> </span><a href="#local-6989586621679096703"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuBar</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-98"></a><a name="menuBarLoadRes"><a href="Graphics.UI.WX.Menu.html#menuBarLoadRes"><span class="hs-identifier">menuBarLoadRes</span></a></a><span> </span><a name="local-6989586621679096852"><a href="#local-6989586621679096852"><span class="hs-identifier">parent</span></a></a><span> </span><a name="local-6989586621679096853"><a href="#local-6989586621679096853"><span class="hs-identifier">rc</span></a></a><span> </span><a name="local-6989586621679096854"><a href="#local-6989586621679096854"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-keyword">do</span><span></span><span>
</span><a name="line-100"></a><span>      </span><a name="local-6989586621679096855"><a href="#local-6989586621679096855"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">xmlResourceCreateFromFile</span><span> </span><a href="#local-6989586621679096853"><span class="hs-identifier hs-var">rc</span></a><span> </span><span class="hs-identifier hs-var">wxXRC_USE_LOCALE</span><span></span><span>
</span><a name="line-101"></a><span>      </span><a name="local-6989586621679096856"><a href="#local-6989586621679096856"><span class="hs-identifier">m</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">xmlResourceLoadMenuBar</span><span> </span><a href="#local-6989586621679096855"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679096852"><span class="hs-identifier hs-var">parent</span></a><span> </span><a href="#local-6989586621679096854"><span class="hs-identifier hs-var">name</span></a><span></span><span>
</span><a name="line-102"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679096856"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-103"></a><span></span><span>
</span><a name="line-104"></a><span class="hs-comment">-- | Show a popup menu for a certain window.</span><span>
</span><a name="line-105"></a><span class="hs-identifier">menuPopup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096701"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Point</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Window</span><span> </span><a href="#local-6989586621679096702"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-106"></a><a name="menuPopup"><a href="Graphics.UI.WX.Menu.html#menuPopup"><span class="hs-identifier">menuPopup</span></a></a><span> </span><a name="local-6989586621679096857"><a href="#local-6989586621679096857"><span class="hs-identifier">menu</span></a></a><span> </span><a name="local-6989586621679096858"><a href="#local-6989586621679096858"><span class="hs-identifier">pt</span></a></a><span> </span><a name="local-6989586621679096859"><a href="#local-6989586621679096859"><span class="hs-identifier">parent</span></a></a><span></span><span>
</span><a name="line-107"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">windowPopupMenu</span><span> </span><a href="#local-6989586621679096859"><span class="hs-identifier hs-var">parent</span></a><span> </span><a href="#local-6989586621679096857"><span class="hs-identifier hs-var">menu</span></a><span> </span><a href="#local-6989586621679096858"><span class="hs-identifier hs-var">pt</span></a><span></span><span>
</span><a name="line-108"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-109"></a><span></span><span>
</span><a name="line-110"></a><span class="hs-comment">{--------------------------------------------------------------------------------
  Menu
--------------------------------------------------------------------------------}</span><span></span><span>
</span><a name="line-113"></a><span class="hs-pragma">{-# DEPRECATED menuList &quot;Use menuPane instead&quot; #-}</span><span></span><span>
</span><a name="line-114"></a><span class="hs-comment">-- | /Deprecated/: use 'menuPane'.</span><span>
</span><a name="line-115"></a><span class="hs-identifier">menuList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Menu</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Menu</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-116"></a><a name="menuList"><a href="Graphics.UI.WX.Menu.html#menuList"><span class="hs-identifier">menuList</span></a></a><span> </span><span>
</span><a name="line-117"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuPane"><span class="hs-identifier hs-var">menuPane</span></a><span> </span><span>
</span><a name="line-118"></a><span></span><span>
</span><a name="line-119"></a><span class="hs-comment">-- | Create a new menu with a certain title (corresponds with 'text' attribute).</span><span>
</span><a name="line-120"></a><span class="hs-comment">--</span><span>
</span><a name="line-121"></a><span class="hs-comment">-- * Instances: 'Textual'</span><span>
</span><a name="line-122"></a><span class="hs-comment">--</span><span>
</span><a name="line-123"></a><span class="hs-identifier">menuPane</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Menu</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Menu</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-124"></a><a name="menuPane"><a href="Graphics.UI.WX.Menu.html#menuPane"><span class="hs-identifier">menuPane</span></a></a><span> </span><a name="local-6989586621679096860"><a href="#local-6989586621679096860"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-125"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679096861"><a href="#local-6989586621679096861"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">menuCreate</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier hs-var">wxMENU_TEAROFF</span><span></span><span>
</span><a name="line-126"></a><span>       </span><a href="Graphics.UI.WX.Attributes.html#set"><span class="hs-identifier hs-var">set</span></a><span> </span><a href="#local-6989586621679096861"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679096860"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-127"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679096861"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-128"></a><span></span><span>
</span><a name="line-129"></a><span class="hs-comment">-- | Append a /help/ menu item (@&quot;&amp;Help&quot;@). On some platforms,</span><span>
</span><a name="line-130"></a><span class="hs-comment">-- the /help/ menu is handled specially</span><span>
</span><a name="line-131"></a><span class="hs-identifier">menuHelp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Menu</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Menu</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-132"></a><a name="menuHelp"><a href="Graphics.UI.WX.Menu.html#menuHelp"><span class="hs-identifier">menuHelp</span></a></a><span> </span><a name="local-6989586621679096862"><a href="#local-6989586621679096862"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-133"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuPane"><span class="hs-identifier hs-var">menuPane</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Graphics.UI.WX.Classes.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a><span> </span><span class="hs-string">&quot;&amp;Help&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679096862"><span class="hs-identifier hs-var">props</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-134"></a><span></span><span>
</span><a name="line-135"></a><span class="hs-comment">-- | Get a menu by name from a menu loaded from a resource file, </span><span>
</span><a name="line-136"></a><span class="hs-comment">--   given the frame which owns the menu. You</span><span>
</span><a name="line-137"></a><span class="hs-comment">--   can directly set properties on the item as part of the call, which</span><span>
</span><a name="line-138"></a><span class="hs-comment">--   enables simple connection of event handlers (e.g. on command).</span><span>
</span><a name="line-139"></a><span class="hs-identifier">menuRes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Window</span><span> </span><a href="#local-6989586621679096700"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Menu</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Menu</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-140"></a><a name="menuRes"><a href="Graphics.UI.WX.Menu.html#menuRes"><span class="hs-identifier">menuRes</span></a></a><span> </span><a name="local-6989586621679096863"><a href="#local-6989586621679096863"><span class="hs-identifier">parent</span></a></a><span> </span><a name="local-6989586621679096864"><a href="#local-6989586621679096864"><span class="hs-identifier">menu_name</span></a></a><span> </span><a name="local-6989586621679096865"><a href="#local-6989586621679096865"><span class="hs-identifier">props</span></a></a><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-141"></a><span>    </span><span class="hs-keyword">do</span><span></span><span>
</span><a name="line-142"></a><span>      </span><a name="local-6989586621679096866"><a href="#local-6989586621679096866"><span class="hs-identifier">menu</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">xmlResourceGetMenu</span><span> </span><a href="#local-6989586621679096863"><span class="hs-identifier hs-var">parent</span></a><span> </span><a href="#local-6989586621679096864"><span class="hs-identifier hs-var">menu_name</span></a><span></span><span>
</span><a name="line-143"></a><span>      </span><a href="Graphics.UI.WX.Attributes.html#set"><span class="hs-identifier hs-var">set</span></a><span> </span><a href="#local-6989586621679096866"><span class="hs-identifier hs-var">menu</span></a><span> </span><a href="#local-6989586621679096865"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-144"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679096866"><span class="hs-identifier hs-var">menu</span></a><span></span><span>
</span><a name="line-145"></a><span></span><span>
</span><a name="line-146"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Classes.html#Textual"><span class="hs-identifier hs-type">Textual</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679097990"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-147"></a><span>  </span><a name="local-8214565720323840038"><a href="Graphics.UI.WX.Classes.html#text"><span class="hs-identifier">text</span></a></a><span></span><span>
</span><a name="line-148"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><span class="hs-string">&quot;text&quot;</span><span> </span><span class="hs-identifier hs-var">menuGetTitle</span><span> </span><span class="hs-identifier hs-var">menuSetTitle</span><span></span><span>
</span><a name="line-149"></a><span></span><span>
</span><a name="line-150"></a><span class="hs-comment">{--------------------------------------------------------------------------------
  Menu items
--------------------------------------------------------------------------------}</span><span></span><span>
</span><a name="line-153"></a><span class="hs-comment">-- | Create a submenu item.</span><span>
</span><a name="line-154"></a><span class="hs-identifier">menuSub</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096698"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096699"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-155"></a><a name="menuSub"><a href="Graphics.UI.WX.Menu.html#menuSub"><span class="hs-identifier">menuSub</span></a></a><span> </span><a name="local-6989586621679096867"><a href="#local-6989586621679096867"><span class="hs-identifier">parent</span></a></a><span> </span><a name="local-6989586621679096868"><a href="#local-6989586621679096868"><span class="hs-identifier">menu</span></a></a><span> </span><a name="local-6989586621679096869"><a href="#local-6989586621679096869"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-156"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679096870"><a href="#local-6989586621679096870"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">idCreate</span><span></span><span>
</span><a name="line-157"></a><span>       </span><a name="local-6989586621679096873"><a href="#local-6989586621679096873"><span class="hs-identifier">label</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#findProperty"><span class="hs-identifier hs-var">findProperty</span></a><span> </span><a href="Graphics.UI.WX.Classes.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-6989586621679096869"><span class="hs-identifier hs-var">props</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><a name="line-158"></a><span>                  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679096871"><a href="#local-6989586621679096871"><span class="hs-identifier">txt</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679096871"><span class="hs-identifier hs-var">txt</span></a><span></span><span>
</span><a name="line-159"></a><span>                  </span><span class="hs-identifier hs-var">Nothing</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679096872"><a href="#local-6989586621679096872"><span class="hs-identifier">title</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">menuGetTitle</span><span> </span><a href="#local-6989586621679096868"><span class="hs-identifier hs-var">menu</span></a><span></span><span>
</span><a name="line-160"></a><span>                                     </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679096872"><span class="hs-identifier hs-var">title</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-161"></a><span>                                      </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-string">&quot;&lt;empty&gt;&quot;</span><span></span><span>
</span><a name="line-162"></a><span>                                      </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679096872"><span class="hs-identifier hs-var">title</span></a><span>                  </span><span>
</span><a name="line-163"></a><span>       </span><span class="hs-identifier hs-var">menuSetTitle</span><span> </span><a href="#local-6989586621679096868"><span class="hs-identifier hs-var">menu</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>           </span><span class="hs-comment">-- remove title on submenus</span><span>
</span><a name="line-164"></a><span>       </span><span class="hs-identifier hs-var">menuAppendSub</span><span> </span><a href="#local-6989586621679096867"><span class="hs-identifier hs-var">parent</span></a><span> </span><a href="#local-6989586621679096870"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679096873"><span class="hs-identifier hs-var">label</span></a><span> </span><a href="#local-6989586621679096868"><span class="hs-identifier hs-var">menu</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span></span><span>
</span><a name="line-165"></a><span>       </span><a href="Graphics.UI.WX.Menu.html#menuPropagateEvtHandlers"><span class="hs-identifier hs-var">menuPropagateEvtHandlers</span></a><span> </span><a href="#local-6989586621679096868"><span class="hs-identifier hs-var">menu</span></a><span>  </span><span class="hs-comment">-- move the evtHandlers to the parent</span><span>
</span><a name="line-166"></a><span>       </span><a name="local-6989586621679096874"><a href="#local-6989586621679096874"><span class="hs-identifier">item</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">menuFindItem</span><span> </span><a href="#local-6989586621679096867"><span class="hs-identifier hs-var">parent</span></a><span> </span><a href="#local-6989586621679096870"><span class="hs-identifier hs-var">id</span></a><span></span><span>
</span><a name="line-167"></a><span>       </span><a href="Graphics.UI.WX.Attributes.html#set"><span class="hs-identifier hs-var">set</span></a><span> </span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">item</span></a><span> </span><a href="#local-6989586621679096869"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-168"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">item</span></a><span></span><span>
</span><a name="line-169"></a><span></span><span>
</span><a name="line-170"></a><span class="hs-comment">-- | Add a menu seperator.</span><span>
</span><a name="line-171"></a><span class="hs-identifier">menuLine</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096697"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-172"></a><a name="menuLine"><a href="Graphics.UI.WX.Menu.html#menuLine"><span class="hs-identifier">menuLine</span></a></a><span> </span><a name="local-6989586621679096875"><a href="#local-6989586621679096875"><span class="hs-identifier">menu</span></a></a><span></span><span>
</span><a name="line-173"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">menuAppendSeparator</span><span> </span><a href="#local-6989586621679096875"><span class="hs-identifier hs-var">menu</span></a><span></span><span>
</span><a name="line-174"></a><span></span><span>
</span><a name="line-175"></a><span></span><span>
</span><a name="line-176"></a><span class="hs-comment">-- | Append a menu item. The label can contain</span><span>
</span><a name="line-177"></a><span class="hs-comment">-- menu accellerators by using an ampersand. It can also contain keyboard accellerators</span><span>
</span><a name="line-178"></a><span class="hs-comment">-- after a tab (@'\t'@) character.</span><span>
</span><a name="line-179"></a><span class="hs-comment">--</span><span>
</span><a name="line-180"></a><span class="hs-comment">-- &gt; menuItem menu [text := &quot;&amp;Open\tCtrl+O&quot;, help := &quot;Opens an existing document&quot;] </span><span>
</span><a name="line-181"></a><span class="hs-comment">--</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- You can create a checkable menu item by setting 'checkable' to 'True' in the</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- properties of a menu item.</span><span>
</span><a name="line-184"></a><span class="hs-comment">--</span><span>
</span><a name="line-185"></a><span class="hs-comment">-- Note: on GTK, it is required to set the 'text' attribute immediately at creation time.</span><span>
</span><a name="line-186"></a><span class="hs-comment">--</span><span>
</span><a name="line-187"></a><span class="hs-comment">-- * Events: 'menu', 'menuId'</span><span>
</span><a name="line-188"></a><span class="hs-comment">--</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- * Instances: 'Textual', 'Able', 'Help', 'Checkable', 'Identity', 'Commanding'.</span><span>
</span><a name="line-190"></a><span class="hs-comment">--</span><span>
</span><a name="line-191"></a><span class="hs-identifier">menuItem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096696"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-192"></a><a name="menuItem"><a href="Graphics.UI.WX.Menu.html#menuItem"><span class="hs-identifier">menuItem</span></a></a><span> </span><a name="local-6989586621679096876"><a href="#local-6989586621679096876"><span class="hs-identifier">menu</span></a></a><span> </span><a name="local-6989586621679096877"><a href="#local-6989586621679096877"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-193"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096878"><a href="#local-6989586621679096878"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#findProperty"><span class="hs-identifier hs-var">findProperty</span></a><span> </span><a href="Graphics.UI.WX.Classes.html#checkable"><span class="hs-identifier hs-var">checkable</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679096877"><span class="hs-identifier hs-var">props</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-194"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">wxITEM_CHECK</span><span></span><span>
</span><a name="line-195"></a><span>                    </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">wxITEM_NORMAL</span><span></span><span>
</span><a name="line-196"></a><span>       </span><a href="Graphics.UI.WX.Menu.html#menuItemKind"><span class="hs-identifier hs-var">menuItemKind</span></a><span> </span><a href="#local-6989586621679096876"><span class="hs-identifier hs-var">menu</span></a><span> </span><a href="#local-6989586621679096878"><span class="hs-identifier hs-var">kind</span></a><span> </span><a href="#local-6989586621679096877"><span class="hs-identifier hs-var">props</span></a><span>                     </span><span>
</span><a name="line-197"></a><span></span><span>
</span><a name="line-198"></a><span class="hs-comment">-- | Append a radio menu item. These items are 'checkable' by default.</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- A sequence of radio menu items form automatically a group. </span><span>
</span><a name="line-200"></a><span class="hs-comment">-- A different kind of menu item, like  a 'menuLine', terminates the group.</span><span>
</span><a name="line-201"></a><span class="hs-comment">-- Note: one sometimes has to set the first selected radio item </span><span>
</span><a name="line-202"></a><span class="hs-comment">-- specifically after setting the &quot;menubar&quot; property, or otherwise the</span><span>
</span><a name="line-203"></a><span class="hs-comment">-- radio item bullet is not displayed on windows.</span><span>
</span><a name="line-204"></a><span class="hs-comment">-- See 'menuItem' for other properties of menu radio items.</span><span>
</span><a name="line-205"></a><span class="hs-identifier">menuRadioItem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096695"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-206"></a><a name="menuRadioItem"><a href="Graphics.UI.WX.Menu.html#menuRadioItem"><span class="hs-identifier">menuRadioItem</span></a></a><span> </span><a name="local-6989586621679096879"><a href="#local-6989586621679096879"><span class="hs-identifier">menu</span></a></a><span> </span><a name="local-6989586621679096880"><a href="#local-6989586621679096880"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-207"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuItemKind"><span class="hs-identifier hs-var">menuItemKind</span></a><span> </span><a href="#local-6989586621679096879"><span class="hs-identifier hs-var">menu</span></a><span> </span><span class="hs-identifier hs-var">wxITEM_RADIO</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Graphics.UI.WX.Classes.html#checked"><span class="hs-identifier hs-var">checked</span></a><span> </span><a href="Graphics.UI.WX.Attributes.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679096880"><span class="hs-identifier hs-var">props</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-208"></a><span></span><span>
</span><a name="line-209"></a><a name="menuItemKind"><a href="Graphics.UI.WX.Menu.html#menuItemKind"><span class="hs-identifier">menuItemKind</span></a></a><span> </span><a name="local-6989586621679096881"><a href="#local-6989586621679096881"><span class="hs-identifier">menu</span></a></a><span> </span><a name="local-6989586621679096882"><a href="#local-6989586621679096882"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679096883"><a href="#local-6989586621679096883"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-210"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679096884"><a href="#local-6989586621679096884"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">idCreate</span><span></span><span>
</span><a name="line-211"></a><span>       </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096885"><a href="#local-6989586621679096885"><span class="hs-identifier">label</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#findProperty"><span class="hs-identifier hs-var">findProperty</span></a><span> </span><a href="Graphics.UI.WX.Classes.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-6989586621679096883"><span class="hs-identifier hs-var">props</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><a name="line-212"></a><span>                     </span><span class="hs-identifier hs-var">Nothing</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;empty&gt;&quot;</span><span></span><span>
</span><a name="line-213"></a><span>                     </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679096886"><a href="#local-6989586621679096886"><span class="hs-identifier">txt</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679096886"><span class="hs-identifier hs-var">txt</span></a><span></span><span>
</span><a name="line-214"></a><span>       </span><a href="Graphics.UI.WX.Menu.html#menuItemEx"><span class="hs-identifier hs-var">menuItemEx</span></a><span> </span><a href="#local-6989586621679096881"><span class="hs-identifier hs-var">menu</span></a><span> </span><a href="#local-6989586621679096884"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679096885"><span class="hs-identifier hs-var">label</span></a><span> </span><a href="#local-6989586621679096882"><span class="hs-identifier hs-var">kind</span></a><span> </span><a href="#local-6989586621679096883"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-215"></a><span>       </span><span>
</span><a name="line-216"></a><span></span><span>
</span><a name="line-217"></a><span></span><span>
</span><a name="line-218"></a><span class="hs-comment">-- | Append an /about/ menu item (@&quot;&amp;About...&quot;@). On some platforms,</span><span>
</span><a name="line-219"></a><span class="hs-comment">-- the /about/ menu is handled specially.</span><span>
</span><a name="line-220"></a><span class="hs-comment">--</span><span>
</span><a name="line-221"></a><span class="hs-comment">-- * Events: 'menu', 'menuId'</span><span>
</span><a name="line-222"></a><span class="hs-comment">--</span><span>
</span><a name="line-223"></a><span class="hs-comment">-- * Instances: 'Textual', 'Able', 'Help', 'Checkable', 'Identity', 'Commanding'.</span><span>
</span><a name="line-224"></a><span class="hs-comment">--</span><span>
</span><a name="line-225"></a><span class="hs-identifier">menuAbout</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096694"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-226"></a><a name="menuAbout"><a href="Graphics.UI.WX.Menu.html#menuAbout"><span class="hs-identifier">menuAbout</span></a></a><span> </span><a name="local-6989586621679096887"><a href="#local-6989586621679096887"><span class="hs-identifier">menu</span></a></a><span> </span><a name="local-6989586621679096888"><a href="#local-6989586621679096888"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-227"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuItemId"><span class="hs-identifier hs-var">menuItemId</span></a><span> </span><a href="#local-6989586621679096887"><span class="hs-identifier hs-var">menu</span></a><span> </span><span class="hs-identifier hs-var">wxID_ABOUT</span><span> </span><span class="hs-string">&quot;&amp;About...&quot;</span><span> </span><a href="#local-6989586621679096888"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-228"></a><span></span><span>
</span><a name="line-229"></a><span class="hs-comment">-- | Append an /quit/ menu item (@&quot;&amp;Quit\tCtrl+Q&quot;@). On some platforms,</span><span>
</span><a name="line-230"></a><span class="hs-comment">-- the /quit/ menu is handled specially</span><span>
</span><a name="line-231"></a><span class="hs-comment">--</span><span>
</span><a name="line-232"></a><span class="hs-comment">-- * Events: 'menu', 'menuId'</span><span>
</span><a name="line-233"></a><span class="hs-comment">--</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- * Instances: 'Textual', 'Able', 'Help', 'Checkable', 'Identity', 'Commanding'.</span><span>
</span><a name="line-235"></a><span class="hs-comment">--</span><span>
</span><a name="line-236"></a><span class="hs-identifier">menuQuit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096693"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-237"></a><a name="menuQuit"><a href="Graphics.UI.WX.Menu.html#menuQuit"><span class="hs-identifier">menuQuit</span></a></a><span> </span><a name="local-6989586621679096889"><a href="#local-6989586621679096889"><span class="hs-identifier">menu</span></a></a><span> </span><a name="local-6989586621679096890"><a href="#local-6989586621679096890"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-238"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuItemId"><span class="hs-identifier hs-var">menuItemId</span></a><span> </span><a href="#local-6989586621679096889"><span class="hs-identifier hs-var">menu</span></a><span> </span><span class="hs-identifier hs-var">wxID_EXIT</span><span> </span><span class="hs-string">&quot;&amp;Quit\tCtrl+Q&quot;</span><span> </span><a href="#local-6989586621679096890"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-239"></a><span></span><span>
</span><a name="line-240"></a><span class="hs-comment">-- | Append a menu item with a specific id and label.</span><span>
</span><a name="line-241"></a><span class="hs-comment">--</span><span>
</span><a name="line-242"></a><span class="hs-comment">-- * Events: 'menu', 'menuId'</span><span>
</span><a name="line-243"></a><span class="hs-comment">--</span><span>
</span><a name="line-244"></a><span class="hs-comment">-- * Instances: 'Textual', 'Able', 'Help', 'Checkable', 'Identity', 'Commanding'.</span><span>
</span><a name="line-245"></a><span class="hs-comment">--</span><span>
</span><a name="line-246"></a><span class="hs-identifier">menuItemId</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096692"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-247"></a><a name="menuItemId"><a href="Graphics.UI.WX.Menu.html#menuItemId"><span class="hs-identifier">menuItemId</span></a></a><span> </span><a name="local-6989586621679096891"><a href="#local-6989586621679096891"><span class="hs-identifier">menu</span></a></a><span> </span><a name="local-6989586621679096892"><a href="#local-6989586621679096892"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679096893"><a href="#local-6989586621679096893"><span class="hs-identifier">label</span></a></a><span> </span><a name="local-6989586621679096894"><a href="#local-6989586621679096894"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-248"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuItemEx"><span class="hs-identifier hs-var">menuItemEx</span></a><span> </span><a href="#local-6989586621679096891"><span class="hs-identifier hs-var">menu</span></a><span> </span><a href="#local-6989586621679096892"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679096893"><span class="hs-identifier hs-var">label</span></a><span> </span><span class="hs-identifier hs-var">wxITEM_NORMAL</span><span> </span><a href="#local-6989586621679096894"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-249"></a><span></span><span>
</span><a name="line-250"></a><span class="hs-comment">-- | Append a menu item with a specific id, label, and kind (like 'wxITEM_CHECK').</span><span>
</span><a name="line-251"></a><span class="hs-comment">--</span><span>
</span><a name="line-252"></a><span class="hs-comment">-- * Events: 'menu', 'menuId'</span><span>
</span><a name="line-253"></a><span class="hs-comment">--</span><span>
</span><a name="line-254"></a><span class="hs-comment">-- * Instances: 'Textual', 'Able', 'Help', 'Checkable', 'Identity', 'Commanding'.</span><span>
</span><a name="line-255"></a><span class="hs-comment">--</span><span>
</span><a name="line-256"></a><span class="hs-identifier">menuItemEx</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096691"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-257"></a><a name="menuItemEx"><a href="Graphics.UI.WX.Menu.html#menuItemEx"><span class="hs-identifier">menuItemEx</span></a></a><span> </span><a name="local-6989586621679096895"><a href="#local-6989586621679096895"><span class="hs-identifier">menu</span></a></a><span> </span><a name="local-6989586621679096896"><a href="#local-6989586621679096896"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679096897"><a href="#local-6989586621679096897"><span class="hs-identifier">label</span></a></a><span> </span><a name="local-6989586621679096898"><a href="#local-6989586621679096898"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679096899"><a href="#local-6989586621679096899"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-258"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096898"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">wxITEM_RADIO</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-259"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">menuAppendRadioItem</span><span> </span><a href="#local-6989586621679096895"><span class="hs-identifier hs-var">menu</span></a><span> </span><a href="#local-6989586621679096896"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679096897"><span class="hs-identifier hs-var">label</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span></span><span>
</span><a name="line-260"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">menuAppend</span><span> </span><a href="#local-6989586621679096895"><span class="hs-identifier hs-var">menu</span></a><span> </span><a href="#local-6989586621679096896"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679096897"><span class="hs-identifier hs-var">label</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096898"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">wxITEM_CHECK</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-261"></a><span>       </span><a name="local-6989586621679096900"><a href="#local-6989586621679096900"><span class="hs-identifier">item</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">menuFindItem</span><span> </span><a href="#local-6989586621679096895"><span class="hs-identifier hs-var">menu</span></a><span> </span><a href="#local-6989586621679096896"><span class="hs-identifier hs-var">id</span></a><span></span><span>
</span><a name="line-262"></a><span>       </span><a href="Graphics.UI.WX.Attributes.html#set"><span class="hs-identifier hs-var">set</span></a><span> </span><a href="#local-6989586621679096900"><span class="hs-identifier hs-var">item</span></a><span> </span><a href="#local-6989586621679096899"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-263"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679096900"><span class="hs-identifier hs-var">item</span></a><span></span><span>
</span><a name="line-264"></a><span></span><span>
</span><a name="line-265"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Classes.html#Able"><span class="hs-identifier hs-type">Able</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><a href="#local-6989586621679097989"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-266"></a><span>  </span><a name="local-8214565720323839989"><a href="Graphics.UI.WX.Classes.html#enabled"><span class="hs-identifier">enabled</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><span class="hs-string">&quot;enabled&quot;</span><span> </span><span class="hs-identifier hs-var">menuItemIsEnabled</span><span> </span><span class="hs-identifier hs-var">menuItemEnable</span><span></span><span>
</span><a name="line-267"></a><span></span><span>
</span><a name="line-268"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Classes.html#Textual"><span class="hs-identifier hs-type">Textual</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><a href="#local-6989586621679097988"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-269"></a><span>  </span><a name="local-8214565720323840038"><a href="Graphics.UI.WX.Classes.html#text"><span class="hs-identifier">text</span></a></a><span></span><span>
</span><a name="line-270"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#reflectiveAttr"><span class="hs-identifier hs-var">reflectiveAttr</span></a><span> </span><span class="hs-string">&quot;text&quot;</span><span> </span><span class="hs-identifier hs-var">menuItemGetItemLabel</span><span> </span><span class="hs-identifier hs-var">menuItemSetItemLabel</span><span></span><span>
</span><a name="line-271"></a><span></span><span>
</span><a name="line-272"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Classes.html#Help"><span class="hs-identifier hs-type">Help</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><a href="#local-6989586621679097987"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-273"></a><span>  </span><a name="local-8214565720323839987"><a href="Graphics.UI.WX.Classes.html#help"><span class="hs-identifier">help</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><span class="hs-string">&quot;help&quot;</span><span> </span><span class="hs-identifier hs-var">menuItemGetHelp</span><span> </span><span class="hs-identifier hs-var">menuItemSetHelp</span><span></span><span>
</span><a name="line-274"></a><span></span><span>
</span><a name="line-275"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Classes.html#Checkable"><span class="hs-identifier hs-type">Checkable</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><a href="#local-6989586621679097984"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-276"></a><span>  </span><a name="local-8214565720323839984"><a href="Graphics.UI.WX.Classes.html#checkable"><span class="hs-identifier">checkable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#reflectiveAttr"><span class="hs-identifier hs-var">reflectiveAttr</span></a><span> </span><span class="hs-string">&quot;checkable&quot;</span><span> </span><span class="hs-identifier hs-var">menuItemIsCheckable</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097985"><a href="#local-6989586621679097985"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679097986"><a href="#local-6989586621679097986"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">menuItemSetCheckable</span><span> </span><a href="#local-6989586621679097985"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679097986"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-277"></a><span>  </span><a name="local-8214565720323839985"><a href="Graphics.UI.WX.Classes.html#checked"><span class="hs-identifier">checked</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><span class="hs-string">&quot;checked&quot;</span><span>   </span><span class="hs-identifier hs-var">menuItemIsChecked</span><span> </span><span class="hs-identifier hs-var">menuItemCheck</span><span></span><span>
</span><a name="line-278"></a><span></span><span>
</span><a name="line-279"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Classes.html#Identity"><span class="hs-identifier hs-type">Identity</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><a href="#local-6989586621679097983"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-280"></a><span>  </span><a name="local-8214565720323839982"><a href="Graphics.UI.WX.Classes.html#identity"><span class="hs-identifier">identity</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><span class="hs-string">&quot;identity&quot;</span><span> </span><span class="hs-identifier hs-var">menuItemGetId</span><span> </span><span class="hs-identifier hs-var">menuItemSetId</span><span></span><span>
</span><a name="line-281"></a><span></span><span>
</span><a name="line-282"></a><span class="hs-comment">{--------------------------------------------------------------------------------
  Events
--------------------------------------------------------------------------------}</span><span></span><span>
</span><a name="line-285"></a><span class="hs-comment">-- | React to menu events.</span><span>
</span><a name="line-286"></a><span class="hs-identifier">menu</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MenuItem</span><span> </span><a href="#local-6989586621679096689"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Events.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Window</span><span> </span><a href="#local-6989586621679096690"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-287"></a><a name="menu"><a href="Graphics.UI.WX.Menu.html#menu"><span class="hs-identifier">menu</span></a></a><span> </span><a name="local-6989586621679096901"><a href="#local-6989586621679096901"><span class="hs-identifier">item</span></a></a><span></span><span>
</span><a name="line-288"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096902"><a href="#local-6989586621679096902"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Attributes.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621679096901"><span class="hs-identifier hs-var">item</span></a><span> </span><a href="Graphics.UI.WX.Classes.html#identity"><span class="hs-identifier hs-var">identity</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-289"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><a href="Graphics.UI.WX.Menu.html#menuId"><span class="hs-identifier hs-var">menuId</span></a><span> </span><a href="#local-6989586621679096902"><span class="hs-identifier hs-var">id</span></a><span></span><span>
</span><a name="line-290"></a><span></span><span>
</span><a name="line-291"></a><span class="hs-comment">-- | React to a menu event based on identity.</span><span>
</span><a name="line-292"></a><span class="hs-identifier">menuId</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Events.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Window</span><span> </span><a href="#local-6989586621679096688"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-293"></a><a name="menuId"><a href="Graphics.UI.WX.Menu.html#menuId"><span class="hs-identifier">menuId</span></a></a><span> </span><a name="local-6989586621679096903"><a href="#local-6989586621679096903"><span class="hs-identifier">id</span></a></a><span></span><span>
</span><a name="line-294"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Events.html#newEvent"><span class="hs-identifier hs-var">newEvent</span></a><span> </span><span class="hs-string">&quot;menu&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096904"><a href="#local-6989586621679096904"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">evtHandlerGetOnMenuCommand</span><span> </span><a href="#local-6989586621679096904"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679096903"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096905"><a href="#local-6989586621679096905"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679096906"><a href="#local-6989586621679096906"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">evtHandlerOnMenuCommand</span><span> </span><a href="#local-6989586621679096905"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679096903"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679096906"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-295"></a><span>              </span><span>
</span><a name="line-296"></a><span class="hs-comment">{--------------------------------------------------------------------------------
  Menu commands:

  Ok, we would like to set command handlers in two ways:
  1) As an &quot;on command&quot; on the menu item itself. 
  2) With an &quot;on (menu xxx)&quot; on a window. 

  Unfortunately, wxWidgets does not support method (1) for menus that are
  part of a menubar and assumes they are set on using (2) on the associated
  frame. We can't tell whether a menu is part of a menubar or popup menu until
  the user sets it. Thus we both set the event handlers always directly on the
  top level menu (this is good enough for popup menus) and we maintain 
  a list of menu item id's and associated event handler as client data on the
  top level menu. When the menu is set as part of a menu bar, we install the
  handlers on the associated frame.
--------------------------------------------------------------------------------}</span><span></span><span>
</span><a name="line-312"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Events.html#Commanding"><span class="hs-identifier hs-type">Commanding</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MenuItem</span><span> </span><a href="#local-6989586621679097982"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-313"></a><span>  </span><a name="local-8214565720323846304"><a href="Graphics.UI.WX.Events.html#command"><span class="hs-identifier">command</span></a></a><span></span><span>
</span><a name="line-314"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Events.html#newEvent"><span class="hs-identifier hs-var">newEvent</span></a><span> </span><span class="hs-string">&quot;command&quot;</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuItemGetOnCommand"><span class="hs-identifier hs-var">menuItemGetOnCommand</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#menuItemOnCommand"><span class="hs-identifier hs-var">menuItemOnCommand</span></a><span></span><span>
</span><a name="line-315"></a><span></span><span>
</span><a name="line-316"></a><span class="hs-identifier">menuItemGetOnCommand</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MenuItem</span><span> </span><a href="#local-6989586621679096687"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-317"></a><a name="menuItemGetOnCommand"><a href="Graphics.UI.WX.Menu.html#menuItemGetOnCommand"><span class="hs-identifier">menuItemGetOnCommand</span></a></a><span> </span><a name="local-6989586621679096907"><a href="#local-6989586621679096907"><span class="hs-identifier">item</span></a></a><span> </span><span>
</span><a name="line-318"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679096908"><a href="#local-6989586621679096908"><span class="hs-identifier">id</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Attributes.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621679096907"><span class="hs-identifier hs-var">item</span></a><span> </span><a href="Graphics.UI.WX.Classes.html#identity"><span class="hs-identifier hs-var">identity</span></a><span></span><span>
</span><a name="line-319"></a><span>       </span><a name="local-6989586621679096909"><a href="#local-6989586621679096909"><span class="hs-identifier">topmenu</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuItemGetTopMenu"><span class="hs-identifier hs-var">menuItemGetTopMenu</span></a><span> </span><a href="#local-6989586621679096907"><span class="hs-identifier hs-var">item</span></a><span></span><span>
</span><a name="line-320"></a><span>       </span><span class="hs-identifier hs-var">evtHandlerGetOnMenuCommand</span><span> </span><a href="#local-6989586621679096909"><span class="hs-identifier hs-var">topmenu</span></a><span> </span><a href="#local-6989586621679096908"><span class="hs-identifier hs-var">id</span></a><span></span><span>
</span><a name="line-321"></a><span></span><span>
</span><a name="line-322"></a><span class="hs-identifier">menuItemOnCommand</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MenuItem</span><span> </span><a href="#local-6989586621679096686"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-323"></a><a name="menuItemOnCommand"><a href="Graphics.UI.WX.Menu.html#menuItemOnCommand"><span class="hs-identifier">menuItemOnCommand</span></a></a><span> </span><a name="local-6989586621679096910"><a href="#local-6989586621679096910"><span class="hs-identifier">item</span></a></a><span> </span><a name="local-6989586621679096911"><a href="#local-6989586621679096911"><span class="hs-identifier">io</span></a></a><span></span><span>
</span><a name="line-324"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679096920"><a href="#local-6989586621679096920"><span class="hs-identifier">id</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Attributes.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621679096910"><span class="hs-identifier hs-var">item</span></a><span> </span><a href="Graphics.UI.WX.Classes.html#identity"><span class="hs-identifier hs-var">identity</span></a><span></span><span>
</span><a name="line-325"></a><span>       </span><a name="local-6989586621679096921"><a href="#local-6989586621679096921"><span class="hs-identifier">topmenu</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuItemGetTopMenu"><span class="hs-identifier hs-var">menuItemGetTopMenu</span></a><span> </span><a href="#local-6989586621679096910"><span class="hs-identifier hs-var">item</span></a><span></span><span>
</span><a name="line-326"></a><span>       </span><span class="hs-comment">-- always set it on the menu itself (has only effect on popup menus)</span><span>
</span><a name="line-327"></a><span>       </span><span class="hs-identifier hs-var">evtHandlerOnMenuCommand</span><span> </span><a href="#local-6989586621679096921"><span class="hs-identifier hs-var">topmenu</span></a><span> </span><a href="#local-6989586621679096920"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679096911"><span class="hs-identifier hs-var">io</span></a><span></span><span>
</span><a name="line-328"></a><span>       </span><span class="hs-comment">-- update the Haskell event handler list for delayed frame installation</span><span>
</span><a name="line-329"></a><span>       </span><a href="Graphics.UI.WX.Menu.html#menuUpdateEvtHandlers"><span class="hs-identifier hs-var">menuUpdateEvtHandlers</span></a><span> </span><a href="#local-6989586621679096921"><span class="hs-identifier hs-var">topmenu</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096912"><span class="hs-identifier hs-var">insert</span></a><span> </span><a href="#local-6989586621679096920"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679096911"><span class="hs-identifier hs-var">io</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-330"></a><span>       </span><span class="hs-comment">-- and set it directly on the frame if already instantiated. </span><span>
</span><a name="line-331"></a><span>       </span><a name="local-6989586621679096922"><a href="#local-6989586621679096922"><span class="hs-identifier">frame</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuGetFrame"><span class="hs-identifier hs-var">menuGetFrame</span></a><span> </span><a href="#local-6989586621679096921"><span class="hs-identifier hs-var">topmenu</span></a><span></span><span>
</span><a name="line-332"></a><span>       </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">objectIsNull</span><span> </span><a href="#local-6989586621679096922"><span class="hs-identifier hs-var">frame</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">evtHandlerOnMenuCommand</span><span> </span><a href="#local-6989586621679096922"><span class="hs-identifier hs-var">frame</span></a><span> </span><a href="#local-6989586621679096920"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679096911"><span class="hs-identifier hs-var">io</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-333"></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-334"></a><span>    </span><a name="local-6989586621679096912"><a href="#local-6989586621679096912"><span class="hs-identifier">insert</span></a></a><span> </span><a name="local-6989586621679096913"><a href="#local-6989586621679096913"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679096914"><a href="#local-6989586621679096914"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679096913"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">,</span><a href="#local-6989586621679096914"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-335"></a><span>    </span><span class="hs-identifier">insert</span><span> </span><a name="local-6989586621679096915"><a href="#local-6989586621679096915"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679096916"><a href="#local-6989586621679096916"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679096917"><a href="#local-6989586621679096917"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><a name="local-6989586621679096918"><a href="#local-6989586621679096918"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679096919"><a href="#local-6989586621679096919"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679096915"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679096917"><span class="hs-identifier hs-var">k</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096915"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">,</span><a href="#local-6989586621679096916"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679096919"><span class="hs-identifier hs-var">xs</span></a><span></span><span>
</span><a name="line-336"></a><span>                              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096917"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679096918"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679096912"><span class="hs-identifier hs-var">insert</span></a><span> </span><a href="#local-6989586621679096915"><span class="hs-identifier hs-var">key</span></a><span> </span><a href="#local-6989586621679096916"><span class="hs-identifier hs-var">val</span></a><span> </span><a href="#local-6989586621679096919"><span class="hs-identifier hs-var">xs</span></a><span></span><span>
</span><a name="line-337"></a><span></span><span>
</span><a name="line-338"></a><span class="hs-comment">-- | When setting event handlers on menu items which have been loaded from</span><span>
</span><a name="line-339"></a><span class="hs-comment">--   XRC resource files, properties cannot be used as the menu item</span><span>
</span><a name="line-340"></a><span class="hs-comment">--   instances are opaque to wxHaskell.</span><span>
</span><a name="line-341"></a><span class="hs-comment">--</span><span>
</span><a name="line-342"></a><span class="hs-comment">--   This function offers a convenient way to attach menu item event</span><span>
</span><a name="line-343"></a><span class="hs-comment">--   handlers, given the identity of the window which owns the menu containing</span><span>
</span><a name="line-344"></a><span class="hs-comment">--   the menu item, and the name of the menu item</span><span>
</span><a name="line-345"></a><span></span><span>
</span><a name="line-346"></a><span class="hs-identifier">menuItemOnCommandRes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Window</span><span> </span><a href="#local-6989586621679096685"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-347"></a><a name="menuItemOnCommandRes"><a href="Graphics.UI.WX.Menu.html#menuItemOnCommandRes"><span class="hs-identifier">menuItemOnCommandRes</span></a></a><span> </span><a name="local-6989586621679096923"><a href="#local-6989586621679096923"><span class="hs-identifier">win</span></a></a><span> </span><a name="local-6989586621679096924"><a href="#local-6989586621679096924"><span class="hs-identifier">item_name</span></a></a><span> </span><a name="local-6989586621679096925"><a href="#local-6989586621679096925"><span class="hs-identifier">handler</span></a></a><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-348"></a><span>    </span><span class="hs-keyword">do</span><span></span><span>
</span><a name="line-349"></a><span>      </span><a name="local-6989586621679096926"><a href="#local-6989586621679096926"><span class="hs-identifier">res</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">xmlResourceGet</span><span></span><span>
</span><a name="line-350"></a><span>      </span><a name="local-6989586621679096927"><a href="#local-6989586621679096927"><span class="hs-identifier">item_id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">xmlResourceGetXRCID</span><span> </span><a href="#local-6989586621679096926"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679096924"><span class="hs-identifier hs-var">item_name</span></a><span></span><span>
</span><a name="line-351"></a><span>      </span><span class="hs-identifier hs-var">evtHandlerOnMenuCommand</span><span> </span><a href="#local-6989586621679096923"><span class="hs-identifier hs-var">win</span></a><span> </span><a href="#local-6989586621679096927"><span class="hs-identifier hs-var">item_id</span></a><span> </span><a href="#local-6989586621679096925"><span class="hs-identifier hs-var">handler</span></a><span></span><span>
</span><a name="line-352"></a><span></span><span>
</span><a name="line-353"></a><span class="hs-comment">-- Propagate the (delayed) event handlers of a submenu to the parent menu.</span><span>
</span><a name="line-354"></a><span class="hs-comment">-- This is necessary for event handlers set on menu items in a submenu that</span><span>
</span><a name="line-355"></a><span class="hs-comment">-- was not yet assigned to a parent menu.</span><span>
</span><a name="line-356"></a><span class="hs-identifier">menuPropagateEvtHandlers</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096684"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-357"></a><a name="menuPropagateEvtHandlers"><a href="Graphics.UI.WX.Menu.html#menuPropagateEvtHandlers"><span class="hs-identifier">menuPropagateEvtHandlers</span></a></a><span> </span><a name="local-6989586621679096928"><a href="#local-6989586621679096928"><span class="hs-identifier">menu</span></a></a><span></span><span>
</span><a name="line-358"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679096929"><a href="#local-6989586621679096929"><span class="hs-identifier">parent</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuGetTopMenu"><span class="hs-identifier hs-var">menuGetTopMenu</span></a><span> </span><a href="#local-6989586621679096928"><span class="hs-identifier hs-var">menu</span></a><span></span><span>
</span><a name="line-359"></a><span>       </span><a name="local-6989586621679096930"><a href="#local-6989586621679096930"><span class="hs-identifier">handlers</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuGetEvtHandlers"><span class="hs-identifier hs-var">menuGetEvtHandlers</span></a><span> </span><a href="#local-6989586621679096928"><span class="hs-identifier hs-var">menu</span></a><span></span><span>
</span><a name="line-360"></a><span>       </span><a href="Graphics.UI.WX.Menu.html#menuSetEvtHandlers"><span class="hs-identifier hs-var">menuSetEvtHandlers</span></a><span> </span><a href="#local-6989586621679096928"><span class="hs-identifier hs-var">menu</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-361"></a><span>       </span><a href="Graphics.UI.WX.Menu.html#menuSetEvtHandlers"><span class="hs-identifier hs-var">menuSetEvtHandlers</span></a><span> </span><a href="#local-6989586621679096929"><span class="hs-identifier hs-var">parent</span></a><span> </span><a href="#local-6989586621679096930"><span class="hs-identifier hs-var">handlers</span></a><span></span><span>
</span><a name="line-362"></a><span></span><span>
</span><a name="line-363"></a><span class="hs-comment">-- Get associated frame of a menu in a menubar. Returns NULL for popup and sub menus.</span><span>
</span><a name="line-364"></a><span class="hs-identifier">menuGetFrame</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096683"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Frame</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-365"></a><a name="menuGetFrame"><a href="Graphics.UI.WX.Menu.html#menuGetFrame"><span class="hs-identifier">menuGetFrame</span></a></a><span> </span><a name="local-6989586621679096931"><a href="#local-6989586621679096931"><span class="hs-identifier">menu</span></a></a><span></span><span>
</span><a name="line-366"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679096932"><a href="#local-6989586621679096932"><span class="hs-identifier">menubar</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">menuGetMenuBar</span><span> </span><a href="#local-6989586621679096931"><span class="hs-identifier hs-var">menu</span></a><span></span><span>
</span><a name="line-367"></a><span>       </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">objectIsNull</span><span> </span><a href="#local-6989586621679096932"><span class="hs-identifier hs-var">menubar</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-368"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">objectNull</span><span></span><span>
</span><a name="line-369"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">menuBarGetFrame</span><span> </span><a href="#local-6989586621679096932"><span class="hs-identifier hs-var">menubar</span></a><span></span><span>
</span><a name="line-370"></a><span></span><span>
</span><a name="line-371"></a><span class="hs-comment">-- Get top level menu of a menu item (never null)</span><span>
</span><a name="line-372"></a><span class="hs-identifier">menuItemGetTopMenu</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MenuItem</span><span> </span><a href="#local-6989586621679096682"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Menu</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-373"></a><a name="menuItemGetTopMenu"><a href="Graphics.UI.WX.Menu.html#menuItemGetTopMenu"><span class="hs-identifier">menuItemGetTopMenu</span></a></a><span> </span><a name="local-6989586621679096933"><a href="#local-6989586621679096933"><span class="hs-identifier">item</span></a></a><span></span><span>
</span><a name="line-374"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679096934"><a href="#local-6989586621679096934"><span class="hs-identifier">menu</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">menuItemGetMenu</span><span> </span><a href="#local-6989586621679096933"><span class="hs-identifier hs-var">item</span></a><span></span><span>
</span><a name="line-375"></a><span>       </span><a href="Graphics.UI.WX.Menu.html#menuGetTopMenu"><span class="hs-identifier hs-var">menuGetTopMenu</span></a><span> </span><a href="#local-6989586621679096934"><span class="hs-identifier hs-var">menu</span></a><span></span><span>
</span><a name="line-376"></a><span></span><span>
</span><a name="line-377"></a><span class="hs-comment">-- Get the top level menu of a possible sub menu </span><span>
</span><a name="line-378"></a><span class="hs-identifier">menuGetTopMenu</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096681"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Menu</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-379"></a><a name="menuGetTopMenu"><a href="Graphics.UI.WX.Menu.html#menuGetTopMenu"><span class="hs-identifier">menuGetTopMenu</span></a></a><span> </span><a name="local-6989586621679096935"><a href="#local-6989586621679096935"><span class="hs-identifier">menu</span></a></a><span></span><span>
</span><a name="line-380"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679096936"><a href="#local-6989586621679096936"><span class="hs-identifier">parent</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">menuGetParent</span><span> </span><a href="#local-6989586621679096935"><span class="hs-identifier hs-var">menu</span></a><span></span><span>
</span><a name="line-381"></a><span>       </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">objectIsNull</span><span> </span><a href="#local-6989586621679096936"><span class="hs-identifier hs-var">parent</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-382"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">downcastMenu</span><span> </span><a href="#local-6989586621679096935"><span class="hs-identifier hs-var">menu</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-383"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuGetTopMenu"><span class="hs-identifier hs-var">menuGetTopMenu</span></a><span> </span><a href="#local-6989586621679096936"><span class="hs-identifier hs-var">parent</span></a><span></span><span>
</span><a name="line-384"></a><span></span><span>
</span><a name="line-385"></a><span class="hs-comment">-- Set all menu event handlers on a certain window (EvtHandler)</span><span>
</span><a name="line-386"></a><span class="hs-identifier">evtHandlerSetAndResetMenuCommands</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">EvtHandler</span><span> </span><a href="#local-6989586621679096679"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096680"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-387"></a><a name="evtHandlerSetAndResetMenuCommands"><a href="Graphics.UI.WX.Menu.html#evtHandlerSetAndResetMenuCommands"><span class="hs-identifier">evtHandlerSetAndResetMenuCommands</span></a></a><span> </span><a name="local-6989586621679097778"><a href="#local-6989586621679097778"><span class="hs-identifier">evtHandler</span></a></a><span> </span><a name="local-6989586621679097779"><a href="#local-6989586621679097779"><span class="hs-identifier">menu</span></a></a><span></span><span>
</span><a name="line-388"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097780"><a href="#local-6989586621679097780"><span class="hs-identifier">handlers</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuGetEvtHandlers"><span class="hs-identifier hs-var">menuGetEvtHandlers</span></a><span> </span><a href="#local-6989586621679097779"><span class="hs-identifier hs-var">menu</span></a><span></span><span>
</span><a name="line-389"></a><span>       </span><a href="Graphics.UI.WX.Menu.html#menuSetEvtHandlers"><span class="hs-identifier hs-var">menuSetEvtHandlers</span></a><span> </span><a href="#local-6989586621679097779"><span class="hs-identifier hs-var">menu</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-390"></a><span>       </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679097781"><a href="#local-6989586621679097781"><span class="hs-identifier">id</span></a></a><span class="hs-special">,</span><a name="local-6989586621679097782"><a href="#local-6989586621679097782"><span class="hs-identifier">io</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">evtHandlerOnMenuCommand</span><span> </span><a href="#local-6989586621679097778"><span class="hs-identifier hs-var">evtHandler</span></a><span> </span><a href="#local-6989586621679097781"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679097782"><span class="hs-identifier hs-var">io</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097780"><span class="hs-identifier hs-var">handlers</span></a><span></span><span>
</span><a name="line-391"></a><span></span><span>
</span><a name="line-392"></a><span class="hs-comment">-- Update the menu event handler list.</span><span>
</span><a name="line-393"></a><a name="menuUpdateEvtHandlers"><a href="Graphics.UI.WX.Menu.html#menuUpdateEvtHandlers"><span class="hs-identifier">menuUpdateEvtHandlers</span></a></a><span> </span><a name="local-6989586621679097783"><a href="#local-6989586621679097783"><span class="hs-identifier">menu</span></a></a><span> </span><a name="local-6989586621679097784"><a href="#local-6989586621679097784"><span class="hs-identifier">f</span></a></a><span></span><span>
</span><a name="line-394"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097785"><a href="#local-6989586621679097785"><span class="hs-identifier">hs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Menu.html#menuGetEvtHandlers"><span class="hs-identifier hs-var">menuGetEvtHandlers</span></a><span> </span><a href="#local-6989586621679097783"><span class="hs-identifier hs-var">menu</span></a><span></span><span>
</span><a name="line-395"></a><span>       </span><a href="Graphics.UI.WX.Menu.html#menuSetEvtHandlers"><span class="hs-identifier hs-var">menuSetEvtHandlers</span></a><span> </span><a href="#local-6989586621679097783"><span class="hs-identifier hs-var">menu</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097784"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679097785"><span class="hs-identifier hs-var">hs</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-396"></a><span></span><span>
</span><a name="line-397"></a><span class="hs-identifier">menuGetEvtHandlers</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096678"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Id</span><span class="hs-special">,</span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-398"></a><a name="menuGetEvtHandlers"><a href="Graphics.UI.WX.Menu.html#menuGetEvtHandlers"><span class="hs-identifier">menuGetEvtHandlers</span></a></a><span> </span><a name="local-6989586621679097786"><a href="#local-6989586621679097786"><span class="hs-identifier">menu</span></a></a><span> </span><span>
</span><a name="line-399"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097787"><a href="#local-6989586621679097787"><span class="hs-identifier">mbHandlers</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">unsafeEvtHandlerGetClientData</span><span> </span><a href="#local-6989586621679097786"><span class="hs-identifier hs-var">menu</span></a><span></span><span>
</span><a name="line-400"></a><span>       </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679097787"><span class="hs-identifier hs-var">mbHandlers</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-401"></a><span>         </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-402"></a><span>         </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679097788"><a href="#local-6989586621679097788"><span class="hs-identifier">hs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679097788"><span class="hs-identifier hs-var">hs</span></a><span></span><span>
</span><a name="line-403"></a><span></span><span>
</span><a name="line-404"></a><span class="hs-identifier">menuSetEvtHandlers</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Menu</span><span> </span><a href="#local-6989586621679096677"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Id</span><span class="hs-special">,</span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-405"></a><a name="menuSetEvtHandlers"><a href="Graphics.UI.WX.Menu.html#menuSetEvtHandlers"><span class="hs-identifier">menuSetEvtHandlers</span></a></a><span> </span><a name="local-6989586621679097789"><a href="#local-6989586621679097789"><span class="hs-identifier">menu</span></a></a><span> </span><a name="local-6989586621679097790"><a href="#local-6989586621679097790"><span class="hs-identifier">hs</span></a></a><span></span><span>
</span><a name="line-406"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">evtHandlerSetClientData</span><span> </span><a href="#local-6989586621679097789"><span class="hs-identifier hs-var">menu</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097790"><span class="hs-identifier hs-var">hs</span></a><span> </span><span>
</span><a name="line-407"></a><span></span><span>
</span><a name="line-408"></a><span></span><span>
</span><a name="line-409"></a><span class="hs-comment">{--------------------------------------------------------------------------------
  Toolbar
--------------------------------------------------------------------------------}</span><span></span><span>
</span><a name="line-412"></a><span class="hs-comment">-- | Create a toolbar window with a divider and text labels.</span><span>
</span><a name="line-413"></a><span class="hs-comment">-- Normally, you can use 'toolMenu' to add tools in the toolbar</span><span>
</span><a name="line-414"></a><span class="hs-comment">-- that behave like normal menu items.</span><span>
</span><a name="line-415"></a><span class="hs-comment">--</span><span>
</span><a name="line-416"></a><span class="hs-comment">-- &gt;  tbar   &lt;- toolBar f []</span><span>
</span><a name="line-417"></a><span class="hs-comment">-- &gt;  toolMenu tbar open  &quot;Open&quot;  &quot;open.png&quot;  []</span><span>
</span><a name="line-418"></a><span class="hs-comment">-- &gt;  toolMenu tbar about &quot;About&quot; &quot;about.png&quot; []</span><span>
</span><a name="line-419"></a><span class="hs-comment">--</span><span>
</span><a name="line-420"></a><span class="hs-identifier">toolBar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Frame</span><span> </span><a href="#local-6989586621679096676"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToolBar</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToolBar</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-421"></a><a name="toolBar"><a href="Graphics.UI.WX.Menu.html#toolBar"><span class="hs-identifier">toolBar</span></a></a><span> </span><a name="local-6989586621679097791"><a href="#local-6989586621679097791"><span class="hs-identifier">parent</span></a></a><span> </span><a name="local-6989586621679097792"><a href="#local-6989586621679097792"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-422"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Menu.html#toolBarEx"><span class="hs-identifier hs-var">toolBarEx</span></a><span> </span><a href="#local-6989586621679097791"><span class="hs-identifier hs-var">parent</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-6989586621679097792"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-423"></a><span></span><span>
</span><a name="line-424"></a><span class="hs-comment">-- | Create a toolbar window. The second argument specifies whether text labels</span><span>
</span><a name="line-425"></a><span class="hs-comment">-- should be shown, and the third argument whether a divider line is present</span><span>
</span><a name="line-426"></a><span class="hs-comment">-- above the toolbar.</span><span>
</span><a name="line-427"></a><span class="hs-identifier">toolBarEx</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Frame</span><span> </span><a href="#local-6989586621679096675"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToolBar</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToolBar</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-428"></a><a name="toolBarEx"><a href="Graphics.UI.WX.Menu.html#toolBarEx"><span class="hs-identifier">toolBarEx</span></a></a><span> </span><a name="local-6989586621679097793"><a href="#local-6989586621679097793"><span class="hs-identifier">parent</span></a></a><span> </span><a name="local-6989586621679097794"><a href="#local-6989586621679097794"><span class="hs-identifier">showText</span></a></a><span> </span><a name="local-6989586621679097795"><a href="#local-6989586621679097795"><span class="hs-identifier">showDivider</span></a></a><span> </span><a name="local-6989586621679097796"><a href="#local-6989586621679097796"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-429"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097797"><a href="#local-6989586621679097797"><span class="hs-identifier">style</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">wxTB_DOCKABLE</span><span> </span><span class="hs-operator hs-var">.+.</span><span> </span><span class="hs-identifier hs-var">wxTB_FLAT</span><span></span><span>
</span><a name="line-430"></a><span>                   </span><span class="hs-operator hs-var">.+.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097794"><span class="hs-identifier hs-var">showText</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">wxTB_TEXT</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-431"></a><span>                   </span><span class="hs-operator hs-var">.+.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097795"><span class="hs-identifier hs-var">showDivider</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">wxTB_NODIVIDER</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-432"></a><span>                   </span><span class="hs-special">)</span><span></span><span>
</span><a name="line-433"></a><span>       </span><a name="local-6989586621679097798"><a href="#local-6989586621679097798"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">toolBarCreate</span><span> </span><a href="#local-6989586621679097793"><span class="hs-identifier hs-var">parent</span></a><span> </span><span class="hs-identifier hs-var">idAny</span><span> </span><span class="hs-identifier hs-var">rectNull</span><span> </span><a href="#local-6989586621679097797"><span class="hs-identifier hs-var">style</span></a><span></span><span>
</span><a name="line-434"></a><span>       </span><span class="hs-identifier hs-var">frameSetToolBar</span><span> </span><a href="#local-6989586621679097793"><span class="hs-identifier hs-var">parent</span></a><span> </span><a href="#local-6989586621679097798"><span class="hs-identifier hs-var">t</span></a><span></span><span>
</span><a name="line-435"></a><span>       </span><span class="hs-comment">{-
       t &lt;- frameCreateToolBar parent style 
       -}</span><span></span><span>
</span><a name="line-438"></a><span>       </span><a href="Graphics.UI.WX.Attributes.html#set"><span class="hs-identifier hs-var">set</span></a><span> </span><a href="#local-6989586621679097798"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679097796"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-439"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679097798"><span class="hs-identifier hs-var">t</span></a><span></span><span>
</span><a name="line-440"></a><span></span><span>
</span><a name="line-441"></a><span class="hs-comment">-- | A tool in a toolbar.</span><span>
</span><a name="line-442"></a><span class="hs-comment">--</span><span>
</span><a name="line-443"></a><span class="hs-comment">-- * Events: 'tool'</span><span>
</span><a name="line-444"></a><span class="hs-comment">--</span><span>
</span><a name="line-445"></a><span class="hs-comment">-- * Instances: 'Able', 'Help', 'Tipped', 'Checkable', 'Identity', 'Commanding'.</span><span>
</span><a name="line-446"></a><span class="hs-comment">--</span><span>
</span><a name="line-447"></a><span class="hs-keyword">data</span><span> </span><a name="ToolBarItem"><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier">ToolBarItem</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="ToolBarItem"><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier">ToolBarItem</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToolBar</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Id</span><span> </span><span class="hs-identifier hs-type">Bool</span><span></span><span>
</span><a name="line-448"></a><span></span><span>
</span><a name="line-449"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Classes.html#Able"><span class="hs-identifier hs-type">Able</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-450"></a><span>  </span><a name="local-8214565720323839989"><a href="Graphics.UI.WX.Classes.html#enabled"><span class="hs-identifier">enabled</span></a></a><span> </span><span>
</span><a name="line-451"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><span class="hs-string">&quot;enabled&quot;</span><span> </span><a href="#local-6989586621679097973"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679097974"><span class="hs-identifier hs-var">setter</span></a><span></span><span>
</span><a name="line-452"></a><span>    </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-453"></a><span>      </span><a name="local-6989586621679097973"><a href="#local-6989586621679097973"><span class="hs-identifier">getter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097975"><a href="#local-6989586621679097975"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097976"><a href="#local-6989586621679097976"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097977"><a href="#local-6989586621679097977"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-454"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toolBarGetToolEnabled</span><span> </span><a href="#local-6989586621679097975"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097976"><span class="hs-identifier hs-var">id</span></a><span></span><span>
</span><a name="line-455"></a><span></span><span>
</span><a name="line-456"></a><span>      </span><a name="local-6989586621679097974"><a href="#local-6989586621679097974"><span class="hs-identifier">setter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097978"><a href="#local-6989586621679097978"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097979"><a href="#local-6989586621679097979"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097980"><a href="#local-6989586621679097980"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679097981"><a href="#local-6989586621679097981"><span class="hs-identifier">enable</span></a></a><span></span><span>
</span><a name="line-457"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toolBarEnableTool</span><span> </span><a href="#local-6989586621679097978"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097979"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679097981"><span class="hs-identifier hs-var">enable</span></a><span></span><span>
</span><a name="line-458"></a><span>         </span><span>
</span><a name="line-459"></a><span></span><span>
</span><a name="line-460"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Classes.html#Tipped"><span class="hs-identifier hs-type">Tipped</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-461"></a><span>  </span><a name="local-8214565720323839976"><a href="Graphics.UI.WX.Classes.html#tooltip"><span class="hs-identifier">tooltip</span></a></a><span> </span><span>
</span><a name="line-462"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><span class="hs-string">&quot;tooltip&quot;</span><span> </span><a href="#local-6989586621679097964"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679097965"><span class="hs-identifier hs-var">setter</span></a><span></span><span>
</span><a name="line-463"></a><span>    </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-464"></a><span>      </span><a name="local-6989586621679097964"><a href="#local-6989586621679097964"><span class="hs-identifier">getter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097966"><a href="#local-6989586621679097966"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097967"><a href="#local-6989586621679097967"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097968"><a href="#local-6989586621679097968"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-465"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toolBarGetToolShortHelp</span><span> </span><a href="#local-6989586621679097966"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097967"><span class="hs-identifier hs-var">id</span></a><span></span><span>
</span><a name="line-466"></a><span></span><span>
</span><a name="line-467"></a><span>      </span><a name="local-6989586621679097965"><a href="#local-6989586621679097965"><span class="hs-identifier">setter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097969"><a href="#local-6989586621679097969"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097970"><a href="#local-6989586621679097970"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097971"><a href="#local-6989586621679097971"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679097972"><a href="#local-6989586621679097972"><span class="hs-identifier">txt</span></a></a><span></span><span>
</span><a name="line-468"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toolBarSetToolShortHelp</span><span> </span><a href="#local-6989586621679097969"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097970"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679097972"><span class="hs-identifier hs-var">txt</span></a><span></span><span>
</span><a name="line-469"></a><span>         </span><span>
</span><a name="line-470"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Classes.html#Help"><span class="hs-identifier hs-type">Help</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-471"></a><span>  </span><a name="local-8214565720323839987"><a href="Graphics.UI.WX.Classes.html#help"><span class="hs-identifier">help</span></a></a><span>  </span><span>
</span><a name="line-472"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><span class="hs-string">&quot;help&quot;</span><span> </span><a href="#local-6989586621679097955"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679097956"><span class="hs-identifier hs-var">setter</span></a><span></span><span>
</span><a name="line-473"></a><span>    </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-474"></a><span>      </span><a name="local-6989586621679097955"><a href="#local-6989586621679097955"><span class="hs-identifier">getter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097957"><a href="#local-6989586621679097957"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097958"><a href="#local-6989586621679097958"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097959"><a href="#local-6989586621679097959"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-475"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toolBarGetToolLongHelp</span><span> </span><a href="#local-6989586621679097957"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097958"><span class="hs-identifier hs-var">id</span></a><span></span><span>
</span><a name="line-476"></a><span></span><span>
</span><a name="line-477"></a><span>      </span><a name="local-6989586621679097956"><a href="#local-6989586621679097956"><span class="hs-identifier">setter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097960"><a href="#local-6989586621679097960"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097961"><a href="#local-6989586621679097961"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097962"><a href="#local-6989586621679097962"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679097963"><a href="#local-6989586621679097963"><span class="hs-identifier">txt</span></a></a><span></span><span>
</span><a name="line-478"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toolBarSetToolLongHelp</span><span> </span><a href="#local-6989586621679097960"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097961"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679097963"><span class="hs-identifier hs-var">txt</span></a><span></span><span>
</span><a name="line-479"></a><span>         </span><span>
</span><a name="line-480"></a><span></span><span>
</span><a name="line-481"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Classes.html#Checkable"><span class="hs-identifier hs-type">Checkable</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-482"></a><span>  </span><a name="local-8214565720323839984"><a href="Graphics.UI.WX.Classes.html#checkable"><span class="hs-identifier">checkable</span></a></a><span> </span><span>
</span><a name="line-483"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#readAttr"><span class="hs-identifier hs-var">readAttr</span></a><span> </span><span class="hs-string">&quot;checkable&quot;</span><span> </span><a href="#local-6989586621679097942"><span class="hs-identifier hs-var">getter</span></a><span></span><span>
</span><a name="line-484"></a><span>    </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-485"></a><span>      </span><a name="local-6989586621679097942"><a href="#local-6989586621679097942"><span class="hs-identifier">getter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097943"><a href="#local-6989586621679097943"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097944"><a href="#local-6989586621679097944"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097945"><a href="#local-6989586621679097945"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-486"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679097945"><span class="hs-identifier hs-var">isToggle</span></a><span></span><span>
</span><a name="line-487"></a><span></span><span>
</span><a name="line-488"></a><span>  </span><a name="local-8214565720323839985"><a href="Graphics.UI.WX.Classes.html#checked"><span class="hs-identifier">checked</span></a></a><span>   </span><span>
</span><a name="line-489"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><span class="hs-string">&quot;checked&quot;</span><span>  </span><a href="#local-6989586621679097946"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679097947"><span class="hs-identifier hs-var">setter</span></a><span></span><span>
</span><a name="line-490"></a><span>    </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-491"></a><span>      </span><a name="local-6989586621679097946"><a href="#local-6989586621679097946"><span class="hs-identifier">getter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097948"><a href="#local-6989586621679097948"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097949"><a href="#local-6989586621679097949"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097950"><a href="#local-6989586621679097950"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-492"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toolBarGetToolState</span><span> </span><a href="#local-6989586621679097948"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097949"><span class="hs-identifier hs-var">id</span></a><span></span><span>
</span><a name="line-493"></a><span></span><span>
</span><a name="line-494"></a><span>      </span><a name="local-6989586621679097947"><a href="#local-6989586621679097947"><span class="hs-identifier">setter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097951"><a href="#local-6989586621679097951"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097952"><a href="#local-6989586621679097952"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097953"><a href="#local-6989586621679097953"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679097954"><a href="#local-6989586621679097954"><span class="hs-identifier">toggle</span></a></a><span></span><span>
</span><a name="line-495"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toolBarToggleTool</span><span> </span><a href="#local-6989586621679097951"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097952"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679097954"><span class="hs-identifier hs-var">toggle</span></a><span></span><span>
</span><a name="line-496"></a><span>         </span><span>
</span><a name="line-497"></a><span></span><span>
</span><a name="line-498"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Classes.html#Identity"><span class="hs-identifier hs-type">Identity</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-499"></a><span>  </span><a name="local-8214565720323839982"><a href="Graphics.UI.WX.Classes.html#identity"><span class="hs-identifier">identity</span></a></a><span>  </span><span>
</span><a name="line-500"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#readAttr"><span class="hs-identifier hs-var">readAttr</span></a><span> </span><span class="hs-string">&quot;identity&quot;</span><span> </span><a href="#local-6989586621679097938"><span class="hs-identifier hs-var">getter</span></a><span></span><span>
</span><a name="line-501"></a><span>    </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-502"></a><span>      </span><a name="local-6989586621679097938"><a href="#local-6989586621679097938"><span class="hs-identifier">getter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097939"><a href="#local-6989586621679097939"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097940"><a href="#local-6989586621679097940"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097941"><a href="#local-6989586621679097941"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-503"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679097940"><span class="hs-identifier hs-var">id</span></a><span></span><span>
</span><a name="line-504"></a><span></span><span>
</span><a name="line-505"></a><span></span><span>
</span><a name="line-506"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Events.html#Commanding"><span class="hs-identifier hs-type">Commanding</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-507"></a><span>  </span><a name="local-8214565720323846304"><a href="Graphics.UI.WX.Events.html#command"><span class="hs-identifier">command</span></a></a><span></span><span>
</span><a name="line-508"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Events.html#newEvent"><span class="hs-identifier hs-var">newEvent</span></a><span> </span><span class="hs-string">&quot;command&quot;</span><span> </span><a href="#local-6989586621679097929"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679097930"><span class="hs-identifier hs-var">setter</span></a><span></span><span>
</span><a name="line-509"></a><span>    </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-510"></a><span>      </span><a name="local-6989586621679097929"><a href="#local-6989586621679097929"><span class="hs-identifier">getter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097931"><a href="#local-6989586621679097931"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097932"><a href="#local-6989586621679097932"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097933"><a href="#local-6989586621679097933"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-511"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">evtHandlerGetOnMenuCommand</span><span> </span><a href="#local-6989586621679097931"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097932"><span class="hs-identifier hs-var">id</span></a><span></span><span>
</span><a name="line-512"></a><span></span><span>
</span><a name="line-513"></a><span>      </span><a name="local-6989586621679097930"><a href="#local-6989586621679097930"><span class="hs-identifier">setter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097934"><a href="#local-6989586621679097934"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097935"><a href="#local-6989586621679097935"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097936"><a href="#local-6989586621679097936"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679097937"><a href="#local-6989586621679097937"><span class="hs-identifier">io</span></a></a><span></span><span>
</span><a name="line-514"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">evtHandlerOnMenuCommand</span><span> </span><a href="#local-6989586621679097934"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097935"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679097937"><span class="hs-identifier hs-var">io</span></a><span></span><span>
</span><a name="line-515"></a><span></span><span>
</span><a name="line-516"></a><span class="hs-comment">-- | React on tool event (normally handled by 'menu' though, so only use this</span><span>
</span><a name="line-517"></a><span class="hs-comment">-- for orphan toolbar items).</span><span>
</span><a name="line-518"></a><span class="hs-identifier">tool</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Events.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Window</span><span> </span><a href="#local-6989586621679096674"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-519"></a><a name="tool"><a href="Graphics.UI.WX.Menu.html#tool"><span class="hs-identifier">tool</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><a name="local-6989586621679097799"><a href="#local-6989586621679097799"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097800"><a href="#local-6989586621679097800"><span class="hs-identifier">id</span></a></a><span> </span><a name="local-6989586621679097801"><a href="#local-6989586621679097801"><span class="hs-identifier">isToggle</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-520"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Events.html#newEvent"><span class="hs-identifier hs-var">newEvent</span></a><span> </span><span class="hs-string">&quot;tool&quot;</span><span> </span><a href="#local-6989586621679097802"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679097803"><span class="hs-identifier hs-var">setter</span></a><span></span><span>
</span><a name="line-521"></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-522"></a><span>    </span><a name="local-6989586621679097802"><a href="#local-6989586621679097802"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679097804"><a href="#local-6989586621679097804"><span class="hs-identifier">w</span></a></a><span></span><span>
</span><a name="line-523"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">evtHandlerGetOnMenuCommand</span><span> </span><a href="#local-6989586621679097804"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679097800"><span class="hs-identifier hs-var">id</span></a><span></span><span>
</span><a name="line-524"></a><span>    </span><a name="local-6989586621679097803"><a href="#local-6989586621679097803"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679097805"><a href="#local-6989586621679097805"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679097806"><a href="#local-6989586621679097806"><span class="hs-identifier">io</span></a></a><span></span><span>
</span><a name="line-525"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">evtHandlerOnMenuCommand</span><span> </span><a href="#local-6989586621679097805"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679097800"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679097806"><span class="hs-identifier hs-var">io</span></a><span></span><span>
</span><a name="line-526"></a><span></span><span>
</span><a name="line-527"></a><span class="hs-comment">-- | Create a tool bar item based on a menu. Takes a relevant menu</span><span>
</span><a name="line-528"></a><span class="hs-comment">-- item, a label and an image file (bmp, png, gif, ico, etc.) as arguments. The image from the</span><span>
</span><a name="line-529"></a><span class="hs-comment">-- file is normally 16 pixels wide and 15 pixels high.</span><span>
</span><a name="line-530"></a><span class="hs-comment">-- The toolbar item will fire the relevant menu items just as if the menu has been selected.</span><span>
</span><a name="line-531"></a><span class="hs-comment">-- Checkable menus will give a checkable toolbar item. Beware though, that checkable tools</span><span>
</span><a name="line-532"></a><span class="hs-comment">-- normally require a specific @on command@ handler to keep them synchronised with the </span><span>
</span><a name="line-533"></a><span class="hs-comment">-- corresponding menu item.</span><span>
</span><a name="line-534"></a><span class="hs-identifier">toolMenu</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ToolBar</span><span> </span><a href="#local-6989586621679096673"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">MenuItem</span><span> </span><a href="#local-6989586621679096673"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span></span><span>
</span><a name="line-535"></a><a name="toolMenu"><a href="Graphics.UI.WX.Menu.html#toolMenu"><span class="hs-identifier">toolMenu</span></a></a><span> </span><a name="local-6989586621679097807"><a href="#local-6989586621679097807"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097808"><a href="#local-6989586621679097808"><span class="hs-identifier">menuitem</span></a></a><span> </span><a name="local-6989586621679097809"><a href="#local-6989586621679097809"><span class="hs-identifier">label</span></a></a><span> </span><a name="local-6989586621679097810"><a href="#local-6989586621679097810"><span class="hs-identifier">bitmapPath</span></a></a><span> </span><a name="local-6989586621679097811"><a href="#local-6989586621679097811"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-536"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">withBitmapFromFile</span><span> </span><a href="#local-6989586621679097810"><span class="hs-identifier hs-var">bitmapPath</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679097812"><a href="#local-6989586621679097812"><span class="hs-identifier">bitmap</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span></span><span>
</span><a name="line-537"></a><span>      </span><a href="Graphics.UI.WX.Menu.html#toolMenuFromBitmap"><span class="hs-identifier hs-var">toolMenuFromBitmap</span></a><span> </span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097808"><span class="hs-identifier hs-var">menuitem</span></a><span> </span><a href="#local-6989586621679097809"><span class="hs-identifier hs-var">label</span></a><span> </span><a href="#local-6989586621679097812"><span class="hs-identifier hs-var">bitmap</span></a><span> </span><a href="#local-6989586621679097811"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-538"></a><span></span><span>
</span><a name="line-539"></a><span class="hs-comment">-- | This is a generalized version of 'toolMenu' function. You can specify 'Bitmap' that is</span><span>
</span><a name="line-540"></a><span class="hs-comment">-- loaded from any other place instead of using 'FilePath' directly.</span><span>
</span><a name="line-541"></a><span class="hs-identifier">toolMenuFromBitmap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ToolBar</span><span> </span><a href="#local-6989586621679096671"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">MenuItem</span><span> </span><a href="#local-6989586621679096671"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bitmap</span><span> </span><a href="#local-6989586621679096672"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span></span><span>
</span><a name="line-542"></a><a name="toolMenuFromBitmap"><a href="Graphics.UI.WX.Menu.html#toolMenuFromBitmap"><span class="hs-identifier">toolMenuFromBitmap</span></a></a><span> </span><a name="local-6989586621679097813"><a href="#local-6989586621679097813"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097814"><a href="#local-6989586621679097814"><span class="hs-identifier">menuitem</span></a></a><span> </span><a name="local-6989586621679097815"><a href="#local-6989586621679097815"><span class="hs-identifier">label</span></a></a><span> </span><a name="local-6989586621679097816"><a href="#local-6989586621679097816"><span class="hs-identifier">bitmap</span></a></a><span> </span><a name="local-6989586621679097817"><a href="#local-6989586621679097817"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-543"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097818"><a href="#local-6989586621679097818"><span class="hs-identifier">isToggle</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Attributes.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621679097814"><span class="hs-identifier hs-var">menuitem</span></a><span> </span><a href="Graphics.UI.WX.Classes.html#checkable"><span class="hs-identifier hs-var">checkable</span></a><span></span><span>
</span><a name="line-544"></a><span>       </span><a name="local-6989586621679097819"><a href="#local-6989586621679097819"><span class="hs-identifier">id</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Attributes.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621679097814"><span class="hs-identifier hs-var">menuitem</span></a><span> </span><a href="Graphics.UI.WX.Classes.html#identity"><span class="hs-identifier hs-var">identity</span></a><span></span><span>
</span><a name="line-545"></a><span>       </span><a name="local-6989586621679097820"><a href="#local-6989586621679097820"><span class="hs-identifier">lhelp</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Attributes.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621679097814"><span class="hs-identifier hs-var">menuitem</span></a><span> </span><a href="Graphics.UI.WX.Classes.html#help"><span class="hs-identifier hs-var">help</span></a><span></span><span>
</span><a name="line-546"></a><span>       </span><a name="local-6989586621679097821"><a href="#local-6989586621679097821"><span class="hs-identifier">shelp</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Graphics.UI.WX.Attributes.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621679097814"><span class="hs-identifier hs-var">menuitem</span></a><span> </span><a href="Graphics.UI.WX.Classes.html#help"><span class="hs-identifier hs-var">help</span></a><span></span><span>
</span><a name="line-547"></a><span>       </span><span class="hs-identifier hs-var">toolBarAddTool2</span><span> </span><a href="#local-6989586621679097813"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097819"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679097815"><span class="hs-identifier hs-var">label</span></a><span> </span><a href="#local-6989586621679097816"><span class="hs-identifier hs-var">bitmap</span></a><span> </span><span class="hs-identifier hs-var">nullBitmap</span><span> </span><span>
</span><a name="line-548"></a><span>                       </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097818"><span class="hs-identifier hs-var">isToggle</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">wxITEM_CHECK</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">wxITEM_NORMAL</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-549"></a><span>                       </span><a href="#local-6989586621679097821"><span class="hs-identifier hs-var">shelp</span></a><span> </span><a href="#local-6989586621679097820"><span class="hs-identifier hs-var">lhelp</span></a><span></span><span>
</span><a name="line-550"></a><span>       </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097822"><a href="#local-6989586621679097822"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">downcastToolBar</span><span> </span><a href="#local-6989586621679097813"><span class="hs-identifier hs-var">toolbar</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097819"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679097818"><span class="hs-identifier hs-var">isToggle</span></a><span></span><span>
</span><a name="line-551"></a><span>       </span><a href="Graphics.UI.WX.Attributes.html#set"><span class="hs-identifier hs-var">set</span></a><span> </span><a href="#local-6989586621679097822"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679097817"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-552"></a><span>       </span><span class="hs-identifier hs-var">toolBarRealize</span><span> </span><a href="#local-6989586621679097813"><span class="hs-identifier hs-var">toolbar</span></a><span></span><span>
</span><a name="line-553"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679097822"><span class="hs-identifier hs-var">t</span></a><span></span><span>
</span><a name="line-554"></a><span></span><span>
</span><a name="line-555"></a><span class="hs-comment">-- | Create an /orphan/ toolbar item that is unassociated with a menu. Takes a </span><span>
</span><a name="line-556"></a><span class="hs-comment">-- label, a flag that is 'True' when the item is 'checkable' and a path to an image</span><span>
</span><a name="line-557"></a><span class="hs-comment">-- (bmp, png, gif, ico, etc.) as arguments.</span><span>
</span><a name="line-558"></a><span class="hs-identifier">toolItem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ToolBar</span><span> </span><a href="#local-6989586621679096670"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-type">ToolBarItem</span></a><span></span><span>
</span><a name="line-559"></a><a name="toolItem"><a href="Graphics.UI.WX.Menu.html#toolItem"><span class="hs-identifier">toolItem</span></a></a><span> </span><a name="local-6989586621679097823"><a href="#local-6989586621679097823"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097824"><a href="#local-6989586621679097824"><span class="hs-identifier">label</span></a></a><span> </span><a name="local-6989586621679097825"><a href="#local-6989586621679097825"><span class="hs-identifier">isCheckable</span></a></a><span> </span><a name="local-6989586621679097826"><a href="#local-6989586621679097826"><span class="hs-identifier">bitmapPath</span></a></a><span> </span><a name="local-6989586621679097827"><a href="#local-6989586621679097827"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-560"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">withBitmapFromFile</span><span> </span><a href="#local-6989586621679097826"><span class="hs-identifier hs-var">bitmapPath</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679097828"><a href="#local-6989586621679097828"><span class="hs-identifier">bitmap</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span></span><span>
</span><a name="line-561"></a><span>    </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097829"><a href="#local-6989586621679097829"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">idCreate</span><span></span><span>
</span><a name="line-562"></a><span>       </span><span class="hs-identifier hs-var">toolBarAddTool2</span><span> </span><a href="#local-6989586621679097823"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097829"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679097824"><span class="hs-identifier hs-var">label</span></a><span> </span><a href="#local-6989586621679097828"><span class="hs-identifier hs-var">bitmap</span></a><span> </span><span class="hs-identifier hs-var">nullBitmap</span><span> </span><span>
</span><a name="line-563"></a><span>                            </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097825"><span class="hs-identifier hs-var">isCheckable</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">wxITEM_CHECK</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">wxITEM_NORMAL</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-564"></a><span>                            </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-string">&quot;&quot;</span><span></span><span>
</span><a name="line-565"></a><span>       </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097830"><a href="#local-6989586621679097830"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Menu.html#ToolBarItem"><span class="hs-identifier hs-var">ToolBarItem</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">downcastToolBar</span><span> </span><a href="#local-6989586621679097823"><span class="hs-identifier hs-var">toolbar</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097829"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679097825"><span class="hs-identifier hs-var">isCheckable</span></a><span></span><span>
</span><a name="line-566"></a><span>       </span><a href="Graphics.UI.WX.Attributes.html#set"><span class="hs-identifier hs-var">set</span></a><span> </span><a href="#local-6989586621679097830"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-567"></a><span>       </span><span class="hs-identifier hs-var">toolBarRealize</span><span> </span><a href="#local-6989586621679097823"><span class="hs-identifier hs-var">toolbar</span></a><span></span><span>
</span><a name="line-568"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679097830"><span class="hs-identifier hs-var">t</span></a><span></span><span>
</span><a name="line-569"></a><span></span><span>
</span><a name="line-570"></a><span class="hs-comment">-- | Add an arbitrary control to a toolbar (typically a 'ComboBox'). The control</span><span>
</span><a name="line-571"></a><span class="hs-comment">-- must be created with the toolbar as the parent.</span><span>
</span><a name="line-572"></a><span class="hs-identifier">toolControl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ToolBar</span><span> </span><a href="#local-6989586621679096668"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Control</span><span> </span><a href="#local-6989586621679096669"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-573"></a><a name="toolControl"><a href="Graphics.UI.WX.Menu.html#toolControl"><span class="hs-identifier">toolControl</span></a></a><span> </span><a name="local-6989586621679097831"><a href="#local-6989586621679097831"><span class="hs-identifier">toolbar</span></a></a><span> </span><a name="local-6989586621679097832"><a href="#local-6989586621679097832"><span class="hs-identifier">control</span></a></a><span></span><span>
</span><a name="line-574"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">toolBarAddControl</span><span> </span><a href="#local-6989586621679097831"><span class="hs-identifier hs-var">toolbar</span></a><span> </span><a href="#local-6989586621679097832"><span class="hs-identifier hs-var">control</span></a><span></span><span>
</span><a name="line-575"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-576"></a><span>   </span><span>
</span><a name="line-577"></a><span></span><span>
</span><a name="line-578"></a><span class="hs-comment">{--------------------------------------------------------------------------------
  Statusbar
--------------------------------------------------------------------------------}</span><span></span><span>
</span><a name="line-581"></a><span class="hs-comment">-- | A field in a status bar.</span><span>
</span><a name="line-582"></a><span class="hs-comment">--</span><span>
</span><a name="line-583"></a><span class="hs-comment">-- * Instances: 'Textual'</span><span>
</span><a name="line-584"></a><span class="hs-comment">-- </span><span>
</span><a name="line-585"></a><span class="hs-keyword">data</span><span> </span><a name="StatusField"><a href="Graphics.UI.WX.Menu.html#StatusField"><span class="hs-identifier">StatusField</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="SF"><a href="Graphics.UI.WX.Menu.html#SF"><span class="hs-identifier">SF</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Var</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Var</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StatusBar</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Var</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Var</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-586"></a><span></span><span>
</span><a name="line-587"></a><span class="hs-comment">-- | The status width attribute determines the width of a status bar field.</span><span>
</span><a name="line-588"></a><span class="hs-comment">-- A negative width makes the field stretchable. The width than determines</span><span>
</span><a name="line-589"></a><span class="hs-comment">-- the amount of stretch in relation to other fields. The default</span><span>
</span><a name="line-590"></a><span class="hs-comment">-- status width is @-1@, ie. all fields stretch evenly.</span><span>
</span><a name="line-591"></a><span class="hs-comment">--</span><span>
</span><a name="line-592"></a><span class="hs-comment">-- Here is an example of a status bar</span><span>
</span><a name="line-593"></a><span class="hs-comment">-- with three fields, where the last field is 50 pixels wide, the first takes</span><span>
</span><a name="line-594"></a><span class="hs-comment">-- 66% of the remaining space and the second field 33%.</span><span>
</span><a name="line-595"></a><span class="hs-comment">--</span><span>
</span><a name="line-596"></a><span class="hs-comment">-- &gt; field1 &lt;- statusField [statusWidth := -2]</span><span>
</span><a name="line-597"></a><span class="hs-comment">-- &gt; field2 &lt;- statusField [text := &quot;hi&quot;]</span><span>
</span><a name="line-598"></a><span class="hs-comment">-- &gt; field3 &lt;- statusField [statusWidth := 50]</span><span>
</span><a name="line-599"></a><span class="hs-comment">-- &gt; set frame [statusBar := [field1,field2,field3]] </span><span>
</span><a name="line-600"></a><span class="hs-comment">--</span><span>
</span><a name="line-601"></a><span class="hs-identifier">statusWidth</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WX.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#StatusField"><span class="hs-identifier hs-type">StatusField</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span></span><span>
</span><a name="line-602"></a><a name="statusWidth"><a href="Graphics.UI.WX.Menu.html#statusWidth"><span class="hs-identifier">statusWidth</span></a></a><span> </span><span>
</span><a name="line-603"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><span class="hs-string">&quot;statusWidth&quot;</span><span> </span><a href="#local-6989586621679097833"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679097834"><span class="hs-identifier hs-var">setter</span></a><span></span><span>
</span><a name="line-604"></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-605"></a><span>    </span><a name="local-6989586621679097833"><a href="#local-6989586621679097833"><span class="hs-identifier">getter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679097835"><a href="#local-6989586621679097835"><span class="hs-identifier">vwidth</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-606"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">varGet</span><span> </span><a href="#local-6989586621679097835"><span class="hs-identifier hs-var">vwidth</span></a><span></span><span>
</span><a name="line-607"></a><span></span><span>
</span><a name="line-608"></a><span>    </span><a name="local-6989586621679097834"><a href="#local-6989586621679097834"><span class="hs-identifier">setter</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679097836"><a href="#local-6989586621679097836"><span class="hs-identifier">vwidth</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679097837"><a href="#local-6989586621679097837"><span class="hs-identifier">w</span></a></a><span></span><span>
</span><a name="line-609"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">varSet</span><span> </span><a href="#local-6989586621679097836"><span class="hs-identifier hs-var">vwidth</span></a><span> </span><a href="#local-6989586621679097837"><span class="hs-identifier hs-var">w</span></a><span></span><span>
</span><a name="line-610"></a><span></span><span>
</span><a name="line-611"></a><span class="hs-comment">-- | Create a status field.</span><span>
</span><a name="line-612"></a><span class="hs-identifier">statusField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Attributes.html#Prop"><span class="hs-identifier hs-type">Prop</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#StatusField"><span class="hs-identifier hs-type">StatusField</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Graphics.UI.WX.Menu.html#StatusField"><span class="hs-identifier hs-type">StatusField</span></a><span></span><span>
</span><a name="line-613"></a><a name="statusField"><a href="Graphics.UI.WX.Menu.html#statusField"><span class="hs-identifier">statusField</span></a></a><span> </span><a name="local-6989586621679097838"><a href="#local-6989586621679097838"><span class="hs-identifier">props</span></a></a><span></span><span>
</span><a name="line-614"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097839"><a href="#local-6989586621679097839"><span class="hs-identifier">vwidth</span></a></a><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">varCreate</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-615"></a><span>       </span><a name="local-6989586621679097840"><a href="#local-6989586621679097840"><span class="hs-identifier">vsbar</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">varCreate</span><span> </span><span class="hs-identifier hs-var">objectNull</span><span></span><span>
</span><a name="line-616"></a><span>       </span><a name="local-6989586621679097841"><a href="#local-6989586621679097841"><span class="hs-identifier">vidx</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">varCreate</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-617"></a><span>       </span><a name="local-6989586621679097842"><a href="#local-6989586621679097842"><span class="hs-identifier">vtext</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">varCreate</span><span> </span><span class="hs-string">&quot;&quot;</span><span></span><span>
</span><a name="line-618"></a><span>       </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097843"><a href="#local-6989586621679097843"><span class="hs-identifier">sf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Menu.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a href="#local-6989586621679097839"><span class="hs-identifier hs-var">vwidth</span></a><span> </span><a href="#local-6989586621679097840"><span class="hs-identifier hs-var">vsbar</span></a><span> </span><a href="#local-6989586621679097841"><span class="hs-identifier hs-var">vidx</span></a><span> </span><a href="#local-6989586621679097842"><span class="hs-identifier hs-var">vtext</span></a><span></span><span>
</span><a name="line-619"></a><span>       </span><a href="Graphics.UI.WX.Attributes.html#set"><span class="hs-identifier hs-var">set</span></a><span> </span><a href="#local-6989586621679097843"><span class="hs-identifier hs-var">sf</span></a><span> </span><a href="#local-6989586621679097838"><span class="hs-identifier hs-var">props</span></a><span></span><span>
</span><a name="line-620"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679097843"><span class="hs-identifier hs-var">sf</span></a><span></span><span>
</span><a name="line-621"></a><span></span><span>
</span><a name="line-622"></a><span></span><span>
</span><a name="line-623"></a><span class="hs-keyword">instance</span><span> </span><a href="Graphics.UI.WX.Classes.html#Textual"><span class="hs-identifier hs-type">Textual</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#StatusField"><span class="hs-identifier hs-type">StatusField</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-624"></a><span>  </span><a name="local-8214565720323840038"><a href="Graphics.UI.WX.Classes.html#text"><span class="hs-identifier">text</span></a></a><span></span><span>
</span><a name="line-625"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#newAttr"><span class="hs-identifier hs-var">newAttr</span></a><span> </span><span class="hs-string">&quot;text&quot;</span><span> </span><a href="#local-6989586621679097918"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621679097919"><span class="hs-identifier hs-var">set</span></a><span></span><span>
</span><a name="line-626"></a><span>    </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-627"></a><span>      </span><a name="local-6989586621679097918"><a href="#local-6989586621679097918"><span class="hs-identifier">get</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679097920"><a href="#local-6989586621679097920"><span class="hs-identifier">vsbar</span></a></a><span> </span><a name="local-6989586621679097921"><a href="#local-6989586621679097921"><span class="hs-identifier">vidx</span></a></a><span> </span><a name="local-6989586621679097922"><a href="#local-6989586621679097922"><span class="hs-identifier">vtext</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-628"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">varGet</span><span> </span><a href="#local-6989586621679097922"><span class="hs-identifier hs-var">vtext</span></a><span></span><span>
</span><a name="line-629"></a><span></span><span>
</span><a name="line-630"></a><span>      </span><a name="local-6989586621679097919"><a href="#local-6989586621679097919"><span class="hs-identifier">set</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.UI.WX.Menu.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679097923"><a href="#local-6989586621679097923"><span class="hs-identifier">vsbar</span></a></a><span> </span><a name="local-6989586621679097924"><a href="#local-6989586621679097924"><span class="hs-identifier">vidx</span></a></a><span> </span><a name="local-6989586621679097925"><a href="#local-6989586621679097925"><span class="hs-identifier">vtext</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621679097926"><a href="#local-6989586621679097926"><span class="hs-identifier">text</span></a></a><span></span><span>
</span><a name="line-631"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">varSet</span><span> </span><a href="#local-6989586621679097925"><span class="hs-identifier hs-var">vtext</span></a><span> </span><a href="#local-6989586621679097926"><span class="hs-identifier hs-var">text</span></a><span></span><span>
</span><a name="line-632"></a><span>             </span><a name="local-6989586621679097927"><a href="#local-6989586621679097927"><span class="hs-identifier">idx</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">varGet</span><span> </span><a href="#local-6989586621679097924"><span class="hs-identifier hs-var">vidx</span></a><span></span><span>
</span><a name="line-633"></a><span>             </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097927"><span class="hs-identifier hs-var">idx</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-634"></a><span>              </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097928"><a href="#local-6989586621679097928"><span class="hs-identifier">sbar</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">varGet</span><span> </span><a href="#local-6989586621679097923"><span class="hs-identifier hs-var">vsbar</span></a><span></span><span>
</span><a name="line-635"></a><span>                      </span><span class="hs-identifier hs-var">statusBarSetStatusText</span><span> </span><a href="#local-6989586621679097928"><span class="hs-identifier hs-var">sbar</span></a><span> </span><a href="#local-6989586621679097926"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-6989586621679097927"><span class="hs-identifier hs-var">idx</span></a><span></span><span>
</span><a name="line-636"></a><span>              </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-637"></a><span></span><span>
</span><a name="line-638"></a><span></span><span>
</span><a name="line-639"></a><span></span><span>
</span><a name="line-640"></a><span class="hs-pragma">{-# DEPRECATED statusbar &quot;Use statusBar instead&quot; #-}</span><span></span><span>
</span><a name="line-641"></a><span class="hs-comment">-- | /Deprecated/: use 'statusBar'. </span><span>
</span><a name="line-642"></a><span class="hs-identifier">statusbar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WX.Attributes.html#WriteAttr"><span class="hs-identifier hs-type">WriteAttr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Frame</span><span> </span><a href="#local-6989586621679096667"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Menu.html#StatusField"><span class="hs-identifier hs-type">StatusField</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-643"></a><a name="statusbar"><a href="Graphics.UI.WX.Menu.html#statusbar"><span class="hs-identifier">statusbar</span></a></a><span></span><span>
</span><a name="line-644"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Menu.html#statusBar"><span class="hs-identifier hs-var">statusBar</span></a><span></span><span>
</span><a name="line-645"></a><span></span><span>
</span><a name="line-646"></a><span class="hs-comment">-- | Specify the statusbar of a frame.</span><span>
</span><a name="line-647"></a><span class="hs-identifier">statusBar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.UI.WX.Attributes.html#WriteAttr"><span class="hs-identifier hs-type">WriteAttr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Frame</span><span> </span><a href="#local-6989586621679096666"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Graphics.UI.WX.Menu.html#StatusField"><span class="hs-identifier hs-type">StatusField</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-648"></a><a name="statusBar"><a href="Graphics.UI.WX.Menu.html#statusBar"><span class="hs-identifier">statusBar</span></a></a><span></span><span>
</span><a name="line-649"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.UI.WX.Attributes.html#writeAttr"><span class="hs-identifier hs-var">writeAttr</span></a><span> </span><span class="hs-string">&quot;statusbar&quot;</span><span> </span><a href="#local-6989586621679097844"><span class="hs-identifier hs-var">set</span></a><span></span><span>
</span><a name="line-650"></a><span>  </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-651"></a><span>    </span><a name="local-6989586621679097844"><a href="#local-6989586621679097844"><span class="hs-identifier">set</span></a></a><span> </span><a name="local-6989586621679097846"><a href="#local-6989586621679097846"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679097847"><a href="#local-6989586621679097847"><span class="hs-identifier">fields</span></a></a><span></span><span>
</span><a name="line-652"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097849"><a href="#local-6989586621679097849"><span class="hs-identifier">ws</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097848"><a href="#local-6989586621679097848"><span class="hs-identifier">field</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.UI.WX.Attributes.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-6989586621679097848"><span class="hs-identifier hs-var">field</span></a><span> </span><a href="Graphics.UI.WX.Menu.html#statusWidth"><span class="hs-identifier hs-var">statusWidth</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097847"><span class="hs-identifier hs-var">fields</span></a><span></span><span>
</span><a name="line-653"></a><span>           </span><a name="local-6989586621679097911"><a href="#local-6989586621679097911"><span class="hs-identifier">sb</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">statusBarCreateFields</span><span> </span><a href="#local-6989586621679097846"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679097849"><span class="hs-identifier hs-var">ws</span></a><span></span><span>
</span><a name="line-654"></a><span>           </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097845"><span class="hs-identifier hs-var">setsb</span></a><span> </span><a href="#local-6989586621679097911"><span class="hs-identifier hs-var">sb</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679097847"><span class="hs-identifier hs-var">fields</span></a><span> </span><span class="hs-special">)</span><span></span><span>
</span><a name="line-655"></a><span></span><span>
</span><a name="line-656"></a><span>    </span><a name="local-6989586621679097845"><a href="#local-6989586621679097845"><span class="hs-identifier">setsb</span></a></a><span> </span><a name="local-6989586621679097912"><a href="#local-6989586621679097912"><span class="hs-identifier">sb</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679097913"><a href="#local-6989586621679097913"><span class="hs-identifier">idx</span></a></a><span class="hs-special">,</span><a href="Graphics.UI.WX.Menu.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679097914"><a href="#local-6989586621679097914"><span class="hs-identifier">vsbar</span></a></a><span> </span><a name="local-6989586621679097915"><a href="#local-6989586621679097915"><span class="hs-identifier">vidx</span></a></a><span> </span><a name="local-6989586621679097916"><a href="#local-6989586621679097916"><span class="hs-identifier">vtext</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-657"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">varSet</span><span> </span><a href="#local-6989586621679097914"><span class="hs-identifier hs-var">vsbar</span></a><span> </span><a href="#local-6989586621679097912"><span class="hs-identifier hs-var">sb</span></a><span></span><span>
</span><a name="line-658"></a><span>           </span><span class="hs-identifier hs-var">varSet</span><span> </span><a href="#local-6989586621679097915"><span class="hs-identifier hs-var">vidx</span></a><span> </span><a href="#local-6989586621679097913"><span class="hs-identifier hs-var">idx</span></a><span></span><span>
</span><a name="line-659"></a><span>           </span><a name="local-6989586621679097917"><a href="#local-6989586621679097917"><span class="hs-identifier">text</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">varGet</span><span> </span><a href="#local-6989586621679097916"><span class="hs-identifier hs-var">vtext</span></a><span></span><span>
</span><a name="line-660"></a><span>           </span><span class="hs-identifier hs-var">statusBarSetStatusText</span><span> </span><a href="#local-6989586621679097912"><span class="hs-identifier hs-var">sb</span></a><span> </span><a href="#local-6989586621679097917"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-6989586621679097913"><span class="hs-identifier hs-var">idx</span></a><span> </span><span class="hs-comment">-- initialize</span><span>
</span><a name="line-661"></a></pre></body></html>