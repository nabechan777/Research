<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- Module      : Database.Record</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- Copyright   : 2013 Kei Hibino</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- License     : BSD3</span><span>
</span><a name="line-5"></a><span class="hs-comment">--</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Maintainer  : ex8k.hibino@gmail.com</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Stability   : experimental</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Portability : unknown</span><span>
</span><a name="line-9"></a><span class="hs-comment">--</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- This is integrated module which contains</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- types to represent table constraints and</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- interfaces to bind between SQL database values and Haskell records.</span><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-14"></a><span>  </span><span class="hs-comment">-- * Concepts</span><span>
</span><a name="line-15"></a><span>  </span><span class="hs-comment">-- $concepts</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-comment">-- * Binding between SQL values and Haskell records</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-comment">-- $bindSqlAndHaskellRecords</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span>  </span><span class="hs-comment">-- * Constraints used for 'RecordFromSql' inference</span><span>
</span><a name="line-21"></a><span>  </span><span class="hs-comment">-- $constraintsForInference</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span>  </span><span class="hs-comment">-- * Modules which provide proof objects</span><span>
</span><a name="line-24"></a><span>  </span><span class="hs-comment">-- ** Table constraint specified by keys</span><span>
</span><a name="line-25"></a><span>  </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">KeyConstraint</span><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-comment">-- ** Convert between Haskell type and list of SQL type</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">Persistable</span><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-comment">-- ** Convert from list of SQL type</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">FromSql</span><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-comment">-- ** Convert into list of SQL type</span><span>
</span><a name="line-31"></a><span>  </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">ToSql</span><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Record.KeyConstraint.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">KeyConstraint</span></a><span>
</span><a name="line-35"></a><span>  </span><span class="hs-special">(</span><a href="Database.Record.KeyConstraint.html#ColumnConstraint"><span class="hs-identifier hs-type">ColumnConstraint</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#HasColumnConstraint"><span class="hs-identifier hs-type">HasColumnConstraint</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>   </span><a href="Database.Record.KeyConstraint.html#Primary"><span class="hs-identifier hs-type">Primary</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#PrimaryColumnConstraint"><span class="hs-identifier hs-type">PrimaryColumnConstraint</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>   </span><a href="Database.Record.KeyConstraint.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#UniqueColumnConstraint"><span class="hs-identifier hs-type">UniqueColumnConstraint</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#uniqueColumn"><span class="hs-identifier hs-var">uniqueColumn</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#derivedUniqueColumnConstraint"><span class="hs-identifier hs-var">derivedUniqueColumnConstraint</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>   </span><a href="Database.Record.KeyConstraint.html#NotNull"><span class="hs-identifier hs-type">NotNull</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#NotNullColumnConstraint"><span class="hs-identifier hs-type">NotNullColumnConstraint</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#notNullColumn"><span class="hs-identifier hs-var">notNullColumn</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#derivedNotNullColumnConstraint"><span class="hs-identifier hs-var">derivedNotNullColumnConstraint</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>   </span><a href="Database.Record.KeyConstraint.html#KeyConstraint"><span class="hs-identifier hs-type">KeyConstraint</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#HasKeyConstraint"><span class="hs-identifier hs-type">HasKeyConstraint</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#PrimaryConstraint"><span class="hs-identifier hs-type">PrimaryConstraint</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#UniqueConstraint"><span class="hs-identifier hs-type">UniqueConstraint</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>   </span><a href="Database.Record.KeyConstraint.html#deriveComposite"><span class="hs-identifier hs-var">deriveComposite</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#unique"><span class="hs-identifier hs-var">unique</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#derivedCompositePrimary"><span class="hs-identifier hs-var">derivedCompositePrimary</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#derivedUniqueConstraint"><span class="hs-identifier hs-var">derivedUniqueConstraint</span></a><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Record.Persistable.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">Persistable</span></a><span>
</span><a name="line-42"></a><span>  </span><span class="hs-special">(</span><a href="Database.Record.Persistable.html#PersistableSqlType"><span class="hs-identifier hs-type">PersistableSqlType</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.Persistable.html#PersistableType"><span class="hs-identifier hs-type">PersistableType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Database.Record.Persistable.html#sqlNullValue"><span class="hs-identifier hs-var">sqlNullValue</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>   </span><a href="Database.Record.Persistable.html#PersistableRecordWidth"><span class="hs-identifier hs-type">PersistableRecordWidth</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.Persistable.html#PersistableWidth"><span class="hs-identifier hs-type">PersistableWidth</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Database.Record.Persistable.html#derivedWidth"><span class="hs-identifier hs-var">derivedWidth</span></a><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Record.FromSql.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">FromSql</span></a><span>
</span><a name="line-45"></a><span>  </span><span class="hs-special">(</span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.FromSql.html#FromSql"><span class="hs-identifier hs-type">FromSql</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Database.Record.FromSql.html#valueRecordFromSql"><span class="hs-identifier hs-var">valueRecordFromSql</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>   </span><a href="Database.Record.FromSql.html#runTakeRecord"><span class="hs-identifier hs-var">runTakeRecord</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.FromSql.html#takeRecord"><span class="hs-identifier hs-var">takeRecord</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.FromSql.html#runToRecord"><span class="hs-identifier hs-var">runToRecord</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.FromSql.html#toRecord"><span class="hs-identifier hs-var">toRecord</span></a><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Record.ToSql.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">ToSql</span></a><span>
</span><a name="line-48"></a><span>  </span><span class="hs-special">(</span><a href="Database.Record.ToSql.html#ToSqlM"><span class="hs-identifier hs-type">ToSqlM</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#ToSql"><span class="hs-identifier hs-type">ToSql</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#valueRecordToSql"><span class="hs-identifier hs-var">valueRecordToSql</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>   </span><a href="Database.Record.ToSql.html#runFromRecord"><span class="hs-identifier hs-var">runFromRecord</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#wrapToSql"><span class="hs-identifier hs-var">wrapToSql</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#putRecord"><span class="hs-identifier hs-var">putRecord</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#putEmpty"><span class="hs-identifier hs-var">putEmpty</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#fromRecord"><span class="hs-identifier hs-var">fromRecord</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>   </span><a href="Database.Record.ToSql.html#updateValuesByUnique"><span class="hs-identifier hs-var">updateValuesByUnique</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#updateValuesByPrimary"><span class="hs-identifier hs-var">updateValuesByPrimary</span></a><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Record.TupleInstances.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">TupleInstances</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">{- $concepts
On most drivers for SQL database,
we need to write or read untyped SQL value sequence
when accessing databases.

This library maps between list of untyped SQL type
and Haskell record type using type classes.
-}</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">{- $bindSqlAndHaskellRecords
You will need to implement instances of 'FromSql' and 'ToSql' class
to bind between SQL database values and Haskell records.

You can use Database.Record.TH module in this package
to generate instances from SQL database record column names and types.
-}</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">{- $constraintsForInference
You will need to implement instances of
'HasColumnConstraint' 'NotNull' which is a premise
to infer 'RecordFromSql' proof object using 'ToSql' 'q' ('Maybe' a) instance.
This proof object cat convert from SQL type into 'Maybe' typed record
when dealing with outer joined query.
-}</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-pragma">{-# ANN module &quot;HLint: ignore Use import/export shortcut&quot; #-}</span><span>
</span><a name="line-79"></a></pre></body></html>