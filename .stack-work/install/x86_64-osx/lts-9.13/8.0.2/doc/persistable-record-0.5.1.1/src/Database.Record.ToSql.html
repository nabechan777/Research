<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE DefaultSignatures #-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Module      : Database.Record.ToSql</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Copyright   : 2013-2017 Kei Hibino</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- License     : BSD3</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- Maintainer  : ex8k.hibino@gmail.com</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Stability   : experimental</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- Portability : unknown</span><span>
</span><a name="line-15"></a><span class="hs-comment">--</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- This module defines interfaces</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- from Haskell type into list of database value type.</span><span>
</span><a name="line-18"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">ToSql</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-19"></a><span>  </span><span class="hs-comment">-- * Conversion from record type into list of database value type</span><span>
</span><a name="line-20"></a><span>  </span><a href="Database.Record.ToSql.html#ToSqlM"><span class="hs-identifier hs-type">ToSqlM</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#runFromRecord"><span class="hs-identifier hs-var">runFromRecord</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>  </span><a href="Database.Record.ToSql.html#createRecordToSql"><span class="hs-identifier hs-var">createRecordToSql</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span>  </span><span class="hs-special">(</span><a href="Database.Record.ToSql.html#%3C%26%3E"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span>  </span><span class="hs-comment">-- * Derivation rules of 'RecordToSql' conversion</span><span>
</span><a name="line-26"></a><span>  </span><a href="Database.Record.ToSql.html#ToSql"><span class="hs-identifier hs-type">ToSql</span></a><span> </span><span class="hs-special">(</span><a href="Database.Record.ToSql.html#recordToSql"><span class="hs-identifier hs-var">recordToSql</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>  </span><a href="Database.Record.ToSql.html#putRecord"><span class="hs-identifier hs-var">putRecord</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#putEmpty"><span class="hs-identifier hs-var">putEmpty</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#fromRecord"><span class="hs-identifier hs-var">fromRecord</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#wrapToSql"><span class="hs-identifier hs-var">wrapToSql</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span>  </span><a href="Database.Record.ToSql.html#valueRecordToSql"><span class="hs-identifier hs-var">valueRecordToSql</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-comment">-- * Make parameter list for updating with key</span><span>
</span><a name="line-32"></a><span>  </span><a href="Database.Record.ToSql.html#updateValuesByUnique"><span class="hs-identifier hs-var">updateValuesByUnique</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>  </span><a href="Database.Record.ToSql.html#updateValuesByPrimary"><span class="hs-identifier hs-var">updateValuesByPrimary</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>  </span><a href="Database.Record.ToSql.html#updateValuesByUnique%27"><span class="hs-identifier hs-var">updateValuesByUnique'</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span>  </span><a href="Database.Record.ToSql.html#untypedUpdateValuesIndex"><span class="hs-identifier hs-var">untypedUpdateValuesIndex</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>  </span><a href="Database.Record.ToSql.html#unsafeUpdateValuesWithIndexes"><span class="hs-identifier hs-var">unsafeUpdateValuesWithIndexes</span></a><span>
</span><a name="line-38"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Generics</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Rep</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">U1</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">K1</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">M1</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-type">:*:</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">from</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">listArray</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toList</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromList</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">\\</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Writer</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Writer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">execWriter</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">tell</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">DList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">DList</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">DList</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">DList</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Record.Persistable.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">Persistable</span></a><span>
</span><a name="line-48"></a><span>  </span><span class="hs-special">(</span><a href="Database.Record.Persistable.html#PersistableSqlType"><span class="hs-identifier hs-type">PersistableSqlType</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.Persistable.html#runPersistableNullValue"><span class="hs-identifier hs-var">runPersistableNullValue</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.Persistable.html#PersistableType"><span class="hs-identifier hs-type">PersistableType</span></a><span> </span><span class="hs-special">(</span><a href="Database.Record.Persistable.html#persistableType"><span class="hs-identifier hs-var">persistableType</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>   </span><a href="Database.Record.Persistable.html#PersistableRecordWidth"><span class="hs-identifier hs-type">PersistableRecordWidth</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.Persistable.html#runPersistableRecordWidth"><span class="hs-identifier hs-var">runPersistableRecordWidth</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.Persistable.html#PersistableWidth"><span class="hs-identifier hs-type">PersistableWidth</span></a><span class="hs-special">(</span><a href="Database.Record.Persistable.html#persistableWidth"><span class="hs-identifier hs-var">persistableWidth</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Record.KeyConstraint.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">KeyConstraint</span></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-special">(</span><a href="Database.Record.KeyConstraint.html#Primary"><span class="hs-identifier hs-type">Primary</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#KeyConstraint"><span class="hs-identifier hs-type">KeyConstraint</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#HasKeyConstraint"><span class="hs-identifier hs-type">HasKeyConstraint</span></a><span class="hs-special">(</span><a href="Database.Record.KeyConstraint.html#keyConstraint"><span class="hs-identifier hs-var">keyConstraint</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#unique"><span class="hs-identifier hs-var">unique</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#indexes"><span class="hs-identifier hs-var">indexes</span></a><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">-- | Context type to convert into database value list.</span><span>
</span><a name="line-55"></a><span class="hs-keyword">type</span><span> </span><a name="ToSqlM"><a href="Database.Record.ToSql.html#ToSqlM"><span class="hs-identifier">ToSqlM</span></a></a><span> </span><a name="local-6989586621679049820"><a href="#local-6989586621679049820"><span class="hs-identifier">q</span></a></a><span> </span><a name="local-6989586621679049821"><a href="#local-6989586621679049821"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Writer</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">DList</span><span> </span><a href="#local-6989586621679049820"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679049821"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-identifier">runToSqlM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.ToSql.html#ToSqlM"><span class="hs-identifier hs-type">ToSqlM</span></a><span> </span><a href="#local-6989586621679050148"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050149"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679050148"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span>
</span><a name="line-58"></a><a name="runToSqlM"><a href="Database.Record.ToSql.html#runToSqlM"><span class="hs-identifier">runToSqlM</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">DList</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">execWriter</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">{- |
'RecordToSql' 'q' 'a' is data-type wrapping function
to convert from Haskell type 'a' into list of database value type (to send to database) ['q'].

This structure is similar to printer.
While running 'RecordToSql' behavior is the same as list printer.
which appends list of database value type ['q'] stream.
-}</span><span>
</span><a name="line-68"></a><span class="hs-keyword">newtype</span><span> </span><a name="RecordToSql"><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier">RecordToSql</span></a></a><span> </span><a name="local-6989586621679049818"><a href="#local-6989586621679049818"><span class="hs-identifier">q</span></a></a><span> </span><a name="local-6989586621679049819"><a href="#local-6989586621679049819"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RecordToSql"><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier">RecordToSql</span></a></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679049819"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#ToSqlM"><span class="hs-identifier hs-type">ToSqlM</span></a><span> </span><a href="#local-6989586621679049818"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-identifier">runRecordToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050146"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050147"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679050147"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#ToSqlM"><span class="hs-identifier hs-type">ToSqlM</span></a><span> </span><a href="#local-6989586621679050146"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><a name="runRecordToSql"><a href="Database.Record.ToSql.html#runRecordToSql"><span class="hs-identifier">runRecordToSql</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-var">RecordToSql</span></a><span> </span><a name="local-6989586621679050150"><a href="#local-6989586621679050150"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679050150"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">-- | Finalize 'RecordToSql' record printer.</span><span>
</span><a name="line-74"></a><span class="hs-identifier">wrapToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679050144"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#ToSqlM"><span class="hs-identifier hs-type">ToSqlM</span></a><span> </span><a href="#local-6989586621679050145"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050145"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050144"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-75"></a><a name="wrapToSql"><a href="Database.Record.ToSql.html#wrapToSql"><span class="hs-identifier">wrapToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-var">RecordToSql</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">-- | Run 'RecordToSql' printer function object. Convert from Haskell type 'a' into list of database value type ['q'].</span><span>
</span><a name="line-78"></a><span class="hs-identifier">runFromRecord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050142"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050143"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ printer function object which has capability to convert</span><span>
</span><a name="line-79"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679050143"><span class="hs-identifier hs-type">a</span></a><span>               </span><span class="hs-comment">-- ^ Haskell type</span><span>
</span><a name="line-80"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679050142"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span>             </span><span class="hs-comment">-- ^ list of database value</span><span>
</span><a name="line-81"></a><a name="runFromRecord"><a href="Database.Record.ToSql.html#runFromRecord"><span class="hs-identifier">runFromRecord</span></a></a><span> </span><a name="local-6989586621679050151"><a href="#local-6989586621679050151"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#runToSqlM"><span class="hs-identifier hs-var">runToSqlM</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Record.ToSql.html#runRecordToSql"><span class="hs-identifier hs-var">runRecordToSql</span></a><span> </span><a href="#local-6989586621679050151"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-comment">-- | Axiom of 'RecordToSql' for database value type 'q' and Haksell type 'a'.</span><span>
</span><a name="line-84"></a><span class="hs-identifier">createRecordToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679050140"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679050141"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- ^ Convert function body</span><span>
</span><a name="line-85"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050141"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050140"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ Result printer function object</span><span>
</span><a name="line-86"></a><a name="createRecordToSql"><a href="Database.Record.ToSql.html#createRecordToSql"><span class="hs-identifier">createRecordToSql</span></a></a><span> </span><a name="local-6989586621679050152"><a href="#local-6989586621679050152"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Record.ToSql.html#wrapToSql"><span class="hs-identifier hs-var">wrapToSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">tell</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">DList</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679050152"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- unsafely map record</span><span>
</span><a name="line-89"></a><span class="hs-identifier">mapToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679050137"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679050138"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050139"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050138"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050139"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050137"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-90"></a><a name="mapToSql"><a href="Database.Record.ToSql.html#mapToSql"><span class="hs-identifier">mapToSql</span></a></a><span> </span><a name="local-6989586621679050153"><a href="#local-6989586621679050153"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679050154"><a href="#local-6989586621679050154"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#wrapToSql"><span class="hs-identifier hs-var">wrapToSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Record.ToSql.html#runRecordToSql"><span class="hs-identifier hs-var">runRecordToSql</span></a><span> </span><a href="#local-6989586621679050154"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679050153"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-comment">-- unsafely put product record</span><span>
</span><a name="line-93"></a><span class="hs-identifier">productToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679050133"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679050134"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679050135"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#ToSqlM"><span class="hs-identifier hs-type">ToSqlM</span></a><span> </span><a href="#local-6989586621679050136"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#ToSqlM"><span class="hs-identifier hs-type">ToSqlM</span></a><span> </span><a href="#local-6989586621679050136"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050136"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050134"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050136"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050135"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050136"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050133"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-95"></a><a name="productToSql"><a href="Database.Record.ToSql.html#productToSql"><span class="hs-identifier">productToSql</span></a></a><span> </span><a name="local-6989586621679050155"><a href="#local-6989586621679050155"><span class="hs-identifier">run</span></a></a><span> </span><a name="local-6989586621679050156"><a href="#local-6989586621679050156"><span class="hs-identifier">ra</span></a></a><span> </span><a name="local-6989586621679050157"><a href="#local-6989586621679050157"><span class="hs-identifier">rb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#wrapToSql"><span class="hs-identifier hs-var">wrapToSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679050158"><a href="#local-6989586621679050158"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679050155"><span class="hs-identifier hs-var">run</span></a><span> </span><a href="#local-6989586621679050158"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679050159"><a href="#local-6989586621679050159"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679050160"><a href="#local-6989586621679050160"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-96"></a><span>  </span><a href="Database.Record.ToSql.html#runRecordToSql"><span class="hs-identifier hs-var">runRecordToSql</span></a><span> </span><a href="#local-6989586621679050156"><span class="hs-identifier hs-var">ra</span></a><span> </span><a href="#local-6989586621679050159"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-97"></a><span>  </span><a href="Database.Record.ToSql.html#runRecordToSql"><span class="hs-identifier hs-var">runRecordToSql</span></a><span> </span><a href="#local-6989586621679050157"><span class="hs-identifier hs-var">rb</span></a><span> </span><a href="#local-6989586621679050160"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-comment">-- | Derivation rule of 'RecordToSql' printer function object for Haskell tuple (,) type.</span><span>
</span><a name="line-100"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&amp;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050130"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050131"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050130"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050132"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050130"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679050131"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679050132"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span class="hs-special">(</span><a name="%3C%26%3E"><a href="Database.Record.ToSql.html#%3C%26%3E"><span class="hs-operator">&lt;&amp;&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#productToSql"><span class="hs-identifier hs-var">productToSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-comment">-- | Derivation rule of 'RecordToSql' printer function object for Haskell 'Maybe' type.</span><span>
</span><a name="line-104"></a><span class="hs-identifier">maybeRecord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.Persistable.html#PersistableSqlType"><span class="hs-identifier hs-type">PersistableSqlType</span></a><span> </span><a href="#local-6989586621679050128"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.Persistable.html#PersistableRecordWidth"><span class="hs-identifier hs-type">PersistableRecordWidth</span></a><span> </span><a href="#local-6989586621679050129"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050128"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050129"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050128"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679050129"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><a name="maybeRecord"><a href="Database.Record.ToSql.html#maybeRecord"><span class="hs-identifier">maybeRecord</span></a></a><span> </span><a name="local-6989586621679050161"><a href="#local-6989586621679050161"><span class="hs-identifier">qt</span></a></a><span> </span><a name="local-6989586621679050162"><a href="#local-6989586621679050162"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679050163"><a href="#local-6989586621679050163"><span class="hs-identifier">ra</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Record.ToSql.html#wrapToSql"><span class="hs-identifier hs-var">wrapToSql</span></a><span> </span><a href="#local-6989586621679050164"><span class="hs-identifier hs-var">d</span></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-106"></a><span>  </span><a name="local-6989586621679050164"><a href="#local-6989586621679050164"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679050165"><a href="#local-6989586621679050165"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#runRecordToSql"><span class="hs-identifier hs-var">runRecordToSql</span></a><span> </span><a href="#local-6989586621679050163"><span class="hs-identifier hs-var">ra</span></a><span> </span><a href="#local-6989586621679050165"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-107"></a><span>  </span><span class="hs-identifier">d</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tell</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">DList</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-special">(</span><a href="Database.Record.Persistable.html#runPersistableRecordWidth"><span class="hs-identifier hs-var">runPersistableRecordWidth</span></a><span> </span><a href="#local-6989586621679050162"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Record.Persistable.html#runPersistableNullValue"><span class="hs-identifier hs-var">runPersistableNullValue</span></a><span> </span><a href="#local-6989586621679050161"><span class="hs-identifier hs-var">qt</span></a><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-operator">&lt;&amp;&gt;</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-comment">{- |
'ToSql' 'q' 'a' is implicit rule to derive 'RecordToSql' 'q' 'a' record printer function for type 'a'.

Generic programming (&lt;https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#generic-programming&gt;)
with default signature is available for 'ToSql' class,
so you can make instance like below:

@
  \{\-\# LANGUAGE DeriveGeneric \#\-\}
  import GHC.Generics (Generic)
  import Database.HDBC (SqlValue)
  --
  data Foo = Foo { ... } deriving Generic
  instance ToSql SqlValue Foo
@

To make instances of 'ToSql' manually,
'ToSql' 'q' 'a' and 'RecordToSql' 'q 'a' are composable with monadic context.
When, you have data constructor and objects like below.

@
  data MyRecord = MyRecord Foo Bar Baz
@

@
  instance ToSql SqlValue Foo where
    ...
  instance ToSql SqlValue Bar where
    ...
  instance ToSql SqlValue Baz where
    ...
@

You can get composed 'ToSql' implicit rule like below.

@
  instance ToSql SqlValue MyRecord where
    recordToSql =
    recordToSql = wrapToSql $ \\ (MyRecord x y z) -&gt; do
      putRecord x
      putRecord y
      putRecord z
@

-}</span><span>
</span><a name="line-156"></a><span class="hs-keyword">class</span><span> </span><a href="Database.Record.Persistable.html#PersistableWidth"><span class="hs-identifier hs-type">PersistableWidth</span></a><span> </span><a href="#local-6989586621679049817"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="ToSql"><a href="Database.Record.ToSql.html#ToSql"><span class="hs-identifier">ToSql</span></a></a><span> </span><a name="local-6989586621679049816"><a href="#local-6989586621679049816"><span class="hs-identifier">q</span></a></a><span> </span><a name="local-6989586621679049817"><a href="#local-6989586621679049817"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-157"></a><span>  </span><span class="hs-comment">-- | Derived 'RecordToSql' printer function object.</span><span>
</span><a name="line-158"></a><span>  </span><span class="hs-identifier">recordToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679049816"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679049817"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span>  </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">recordToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span> </span><a href="#local-6989586621679049817"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#GToSql"><span class="hs-identifier hs-type">GToSql</span></a><span> </span><a href="#local-6989586621679049816"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Rep</span><span> </span><a href="#local-6989586621679049817"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679049816"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679049817"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-161"></a><span>  </span><a name="local-8214565720323824702"><a href="Database.Record.ToSql.html#recordToSql"><span class="hs-identifier">recordToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">from</span><span> </span><span class="hs-special">`</span><a href="Database.Record.ToSql.html#mapToSql"><span class="hs-identifier hs-var">mapToSql</span></a><span class="hs-special">`</span><span> </span><a href="Database.Record.ToSql.html#gToSql"><span class="hs-identifier hs-var">gToSql</span></a><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-keyword">class</span><span> </span><a name="GToSql"><a href="Database.Record.ToSql.html#GToSql"><span class="hs-identifier">GToSql</span></a></a><span> </span><a name="local-6989586621679049813"><a href="#local-6989586621679049813"><span class="hs-identifier">q</span></a></a><span> </span><a name="local-6989586621679049814"><a href="#local-6989586621679049814"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-164"></a><span>  </span><span class="hs-identifier">gToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679049813"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679049814"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679049815"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Record.ToSql.html#GToSql"><span class="hs-identifier hs-type">GToSql</span></a><span> </span><a href="#local-6989586621679050198"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-identifier hs-type">U1</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-167"></a><span>  </span><a name="local-8214565720323824700"><a href="Database.Record.ToSql.html#gToSql"><span class="hs-identifier">gToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#wrapToSql"><span class="hs-identifier hs-var">wrapToSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier hs-var">U1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">tell</span><span> </span><span class="hs-identifier hs-var">DList</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Database.Record.ToSql.html#GToSql"><span class="hs-identifier hs-type">GToSql</span></a><span> </span><a href="#local-6989586621679050192"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050193"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#GToSql"><span class="hs-identifier hs-type">GToSql</span></a><span> </span><a href="#local-6989586621679050192"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050194"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Record.ToSql.html#GToSql"><span class="hs-identifier hs-type">GToSql</span></a><span> </span><a href="#local-6989586621679050192"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679050193"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><a href="#local-6989586621679050194"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-170"></a><span>  </span><a name="local-8214565720323824700"><a href="Database.Record.ToSql.html#gToSql"><span class="hs-identifier">gToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#productToSql"><span class="hs-identifier hs-var">productToSql</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679050195"><a href="#local-6989586621679050195"><span class="hs-identifier">a</span></a></a><span class="hs-operator hs-var">:*:</span><a name="local-6989586621679050196"><a href="#local-6989586621679050196"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679050197"><a href="#local-6989586621679050197"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679050197"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679050195"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679050196"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="Database.Record.ToSql.html#gToSql"><span class="hs-identifier hs-var">gToSql</span></a><span> </span><a href="Database.Record.ToSql.html#gToSql"><span class="hs-identifier hs-var">gToSql</span></a><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Record.ToSql.html#GToSql"><span class="hs-identifier hs-type">GToSql</span></a><span> </span><a href="#local-6989586621679050187"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050188"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Record.ToSql.html#GToSql"><span class="hs-identifier hs-type">GToSql</span></a><span> </span><a href="#local-6989586621679050187"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">M1</span><span> </span><a href="#local-6989586621679050189"><span class="hs-identifier hs-type">i</span></a><span> </span><a href="#local-6989586621679050190"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679050188"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-173"></a><span>  </span><a name="local-8214565720323824700"><a href="Database.Record.ToSql.html#gToSql"><span class="hs-identifier">gToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">M1</span><span> </span><a name="local-6989586621679050191"><a href="#local-6989586621679050191"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679050191"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Database.Record.ToSql.html#mapToSql"><span class="hs-identifier hs-var">mapToSql</span></a><span class="hs-special">`</span><span> </span><a href="Database.Record.ToSql.html#gToSql"><span class="hs-identifier hs-var">gToSql</span></a><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Record.ToSql.html#ToSql"><span class="hs-identifier hs-type">ToSql</span></a><span> </span><a href="#local-6989586621679050183"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050184"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Record.ToSql.html#GToSql"><span class="hs-identifier hs-type">GToSql</span></a><span> </span><a href="#local-6989586621679050183"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">K1</span><span> </span><a href="#local-6989586621679050185"><span class="hs-identifier hs-type">i</span></a><span> </span><a href="#local-6989586621679050184"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-176"></a><span>  </span><a name="local-8214565720323824700"><a href="Database.Record.ToSql.html#gToSql"><span class="hs-identifier">gToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">K1</span><span> </span><a name="local-6989586621679050186"><a href="#local-6989586621679050186"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679050186"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Database.Record.ToSql.html#mapToSql"><span class="hs-identifier hs-var">mapToSql</span></a><span class="hs-special">`</span><span> </span><a href="Database.Record.ToSql.html#recordToSql"><span class="hs-identifier hs-var">recordToSql</span></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-comment">-- | Implicit derivation rule of 'RecordToSql' printer function object which can convert</span><span>
</span><a name="line-180"></a><span class="hs-comment">--   from Haskell 'Maybe' type into list of database value type ['q'].</span><span>
</span><a name="line-181"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Database.Record.Persistable.html#PersistableType"><span class="hs-identifier hs-type">PersistableType</span></a><span> </span><a href="#local-6989586621679050181"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#ToSql"><span class="hs-identifier hs-type">ToSql</span></a><span> </span><a href="#local-6989586621679050181"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050182"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Record.ToSql.html#ToSql"><span class="hs-identifier hs-type">ToSql</span></a><span> </span><a href="#local-6989586621679050181"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679050182"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-182"></a><span>  </span><a name="local-8214565720323824702"><a href="Database.Record.ToSql.html#recordToSql"><span class="hs-identifier">recordToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#maybeRecord"><span class="hs-identifier hs-var">maybeRecord</span></a><span> </span><a href="Database.Record.Persistable.html#persistableType"><span class="hs-identifier hs-var">persistableType</span></a><span> </span><a href="Database.Record.Persistable.html#persistableWidth"><span class="hs-identifier hs-var">persistableWidth</span></a><span> </span><a href="Database.Record.ToSql.html#recordToSql"><span class="hs-identifier hs-var">recordToSql</span></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- | Implicit derivation rule of 'RecordToSql' printer function object which can convert</span><span>
</span><a name="line-185"></a><span class="hs-comment">--   from Haskell unit () type into /empty/ list of database value type ['q'].</span><span>
</span><a name="line-186"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Record.ToSql.html#ToSql"><span class="hs-identifier hs-type">ToSql</span></a><span> </span><a href="#local-6989586621679050180"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- default generic instance</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-comment">-- | Run implicit 'RecordToSql' printer function object.</span><span>
</span><a name="line-189"></a><span class="hs-comment">--   Context to convert haskell record type 'a' into lib of database value type ['q'].</span><span>
</span><a name="line-190"></a><span class="hs-identifier">putRecord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.ToSql.html#ToSql"><span class="hs-identifier hs-type">ToSql</span></a><span> </span><a href="#local-6989586621679050126"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050127"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679050127"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#ToSqlM"><span class="hs-identifier hs-type">ToSqlM</span></a><span> </span><a href="#local-6989586621679050126"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-191"></a><a name="putRecord"><a href="Database.Record.ToSql.html#putRecord"><span class="hs-identifier">putRecord</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Record.ToSql.html#runRecordToSql"><span class="hs-identifier hs-var">runRecordToSql</span></a><span> </span><a href="Database.Record.ToSql.html#recordToSql"><span class="hs-identifier hs-var">recordToSql</span></a><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-comment">-- | Run 'RecordToSql' empty printer.</span><span>
</span><a name="line-194"></a><span class="hs-identifier">putEmpty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#ToSqlM"><span class="hs-identifier hs-type">ToSqlM</span></a><span> </span><a href="#local-6989586621679050125"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-195"></a><a name="putEmpty"><a href="Database.Record.ToSql.html#putEmpty"><span class="hs-identifier">putEmpty</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Record.ToSql.html#putRecord"><span class="hs-identifier hs-var">putRecord</span></a><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-comment">-- | Run implicit 'RecordToSql' printer function object.</span><span>
</span><a name="line-198"></a><span class="hs-comment">--   Convert from haskell type 'a' into list of database value type ['q'].</span><span>
</span><a name="line-199"></a><span class="hs-identifier">fromRecord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.ToSql.html#ToSql"><span class="hs-identifier hs-type">ToSql</span></a><span> </span><a href="#local-6989586621679050123"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050124"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679050124"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679050123"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span>
</span><a name="line-200"></a><a name="fromRecord"><a href="Database.Record.ToSql.html#fromRecord"><span class="hs-identifier">fromRecord</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Record.ToSql.html#runToSqlM"><span class="hs-identifier hs-var">runToSqlM</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Record.ToSql.html#putRecord"><span class="hs-identifier hs-var">putRecord</span></a><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-comment">-- | Derivation rule of 'RecordToSql' printer function object for value convert function.</span><span>
</span><a name="line-203"></a><span class="hs-identifier">valueRecordToSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679050121"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679050122"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050122"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050121"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-204"></a><a name="valueRecordToSql"><a href="Database.Record.ToSql.html#valueRecordToSql"><span class="hs-identifier">valueRecordToSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#createRecordToSql"><span class="hs-identifier hs-var">createRecordToSql</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-comment">-- | Make untyped indexes to update column from key indexes and record width.</span><span>
</span><a name="line-207"></a><span class="hs-comment">--   Expected by update form like</span><span>
</span><a name="line-208"></a><span class="hs-comment">--</span><span>
</span><a name="line-209"></a><span class="hs-comment">--  @</span><span>
</span><a name="line-210"></a><span class="hs-comment">--   UPDATE /table/ SET /c0/ = ?, /c1/ = ?, /c2/ = ? ... WHERE /key0/ = ? AND /key1/ = ? AND key2 = ? ...</span><span>
</span><a name="line-211"></a><span class="hs-comment">--  @</span><span>
</span><a name="line-212"></a><span class="hs-identifier">untypedUpdateValuesIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Key indexes</span><span>
</span><a name="line-213"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>   </span><span class="hs-comment">-- ^ Record width</span><span>
</span><a name="line-214"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Indexes to update other than key</span><span>
</span><a name="line-215"></a><a name="untypedUpdateValuesIndex"><a href="Database.Record.ToSql.html#untypedUpdateValuesIndex"><span class="hs-identifier">untypedUpdateValuesIndex</span></a></a><span> </span><a name="local-6989586621679050166"><a href="#local-6989586621679050166"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679050167"><a href="#local-6989586621679050167"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679050169"><span class="hs-identifier hs-var">otherThanKey</span></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-216"></a><span>    </span><a name="local-6989586621679050168"><a href="#local-6989586621679050168"><span class="hs-identifier">maxIx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679050167"><span class="hs-identifier hs-var">width</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-217"></a><span>    </span><a name="local-6989586621679050169"><a href="#local-6989586621679050169"><span class="hs-identifier">otherThanKey</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><a href="#local-6989586621679050168"><span class="hs-identifier hs-var">maxIx</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">\\</span><span> </span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="#local-6989586621679050166"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-comment">-- | Unsafely specify key indexes to convert from Haskell type `ra`</span><span>
</span><a name="line-220"></a><span class="hs-comment">--   into database value `q` list expected by update form like</span><span>
</span><a name="line-221"></a><span class="hs-comment">--</span><span>
</span><a name="line-222"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-223"></a><span class="hs-comment">--   UPDATE /table/ SET /c0/ = ?, /c1/ = ?, /c2/ = ? ... WHERE /key0/ = ? AND /key1/ = ? AND /key2/ = ? ...</span><span>
</span><a name="line-224"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-225"></a><span class="hs-comment">--</span><span>
</span><a name="line-226"></a><span class="hs-comment">--   using 'RecordToSql' printer function object.</span><span>
</span><a name="line-227"></a><span class="hs-identifier">unsafeUpdateValuesWithIndexes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050119"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050120"><span class="hs-identifier hs-type">ra</span></a><span>
</span><a name="line-228"></a><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-229"></a><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679050120"><span class="hs-identifier hs-type">ra</span></a><span>
</span><a name="line-230"></a><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679050119"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span>
</span><a name="line-231"></a><a name="unsafeUpdateValuesWithIndexes"><a href="Database.Record.ToSql.html#unsafeUpdateValuesWithIndexes"><span class="hs-identifier">unsafeUpdateValuesWithIndexes</span></a></a><span> </span><a name="local-6989586621679050170"><a href="#local-6989586621679050170"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679050171"><a href="#local-6989586621679050171"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679050172"><a href="#local-6989586621679050172"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679050175"><span class="hs-identifier hs-var">valsA</span></a><span> </span><span class="hs-glyph">!</span><span> </span><a href="#local-6989586621679050177"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679050177"><a href="#local-6989586621679050177"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679050176"><span class="hs-identifier hs-var">otherThanKey</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679050171"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-special">]</span><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-233"></a><span>    </span><a name="local-6989586621679050173"><a href="#local-6989586621679050173"><span class="hs-identifier">vals</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#runFromRecord"><span class="hs-identifier hs-var">runFromRecord</span></a><span> </span><a href="#local-6989586621679050170"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679050172"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-234"></a><span>    </span><a name="local-6989586621679050174"><a href="#local-6989586621679050174"><span class="hs-identifier">width</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679050173"><span class="hs-identifier hs-var">vals</span></a><span>
</span><a name="line-235"></a><span>    </span><a name="local-6989586621679050175"><a href="#local-6989586621679050175"><span class="hs-identifier">valsA</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">listArray</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679050174"><span class="hs-identifier hs-var">width</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679050173"><span class="hs-identifier hs-var">vals</span></a><span>
</span><a name="line-236"></a><span>    </span><a name="local-6989586621679050176"><a href="#local-6989586621679050176"><span class="hs-identifier">otherThanKey</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#untypedUpdateValuesIndex"><span class="hs-identifier hs-var">untypedUpdateValuesIndex</span></a><span> </span><a href="#local-6989586621679050171"><span class="hs-identifier hs-var">key</span></a><span> </span><a href="#local-6989586621679050174"><span class="hs-identifier hs-var">width</span></a><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-comment">-- | Convert from Haskell type `ra` into database value `q` list expected by update form like</span><span>
</span><a name="line-239"></a><span class="hs-comment">--</span><span>
</span><a name="line-240"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-241"></a><span class="hs-comment">--   UPDATE /table/ SET /c0/ = ?, /c1/ = ?, /c2/ = ? ... WHERE /key0/ = ? AND /key1/ = ? AND /key2/ = ? ...</span><span>
</span><a name="line-242"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-243"></a><span class="hs-comment">--</span><span>
</span><a name="line-244"></a><span class="hs-comment">--   using 'RecordToSql' printer function object.</span><span>
</span><a name="line-245"></a><span class="hs-identifier">updateValuesByUnique'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.ToSql.html#RecordToSql"><span class="hs-identifier hs-type">RecordToSql</span></a><span> </span><a href="#local-6989586621679050117"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050118"><span class="hs-identifier hs-type">ra</span></a><span>
</span><a name="line-246"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.KeyConstraint.html#KeyConstraint"><span class="hs-identifier hs-type">KeyConstraint</span></a><span> </span><a href="Database.Record.KeyConstraint.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><a href="#local-6989586621679050118"><span class="hs-identifier hs-type">ra</span></a><span> </span><span class="hs-comment">-- ^ Unique key table constraint printer function object.</span><span>
</span><a name="line-247"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679050118"><span class="hs-identifier hs-type">ra</span></a><span>
</span><a name="line-248"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679050117"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span>
</span><a name="line-249"></a><a name="updateValuesByUnique%27"><a href="Database.Record.ToSql.html#updateValuesByUnique%27"><span class="hs-identifier">updateValuesByUnique'</span></a></a><span> </span><a name="local-6989586621679050178"><a href="#local-6989586621679050178"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679050179"><a href="#local-6989586621679050179"><span class="hs-identifier">uk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#unsafeUpdateValuesWithIndexes"><span class="hs-identifier hs-var">unsafeUpdateValuesWithIndexes</span></a><span> </span><a href="#local-6989586621679050178"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-special">(</span><a href="Database.Record.KeyConstraint.html#indexes"><span class="hs-identifier hs-var">indexes</span></a><span> </span><a href="#local-6989586621679050179"><span class="hs-identifier hs-var">uk</span></a><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-comment">-- | Convert like 'updateValuesByUnique'' using implicit 'RecordToSql' printer function object.</span><span>
</span><a name="line-252"></a><span class="hs-identifier">updateValuesByUnique</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.ToSql.html#ToSql"><span class="hs-identifier hs-type">ToSql</span></a><span> </span><a href="#local-6989586621679050115"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050116"><span class="hs-identifier hs-type">ra</span></a><span>
</span><a name="line-253"></a><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Record.KeyConstraint.html#KeyConstraint"><span class="hs-identifier hs-type">KeyConstraint</span></a><span> </span><a href="Database.Record.KeyConstraint.html#Unique"><span class="hs-identifier hs-type">Unique</span></a><span> </span><a href="#local-6989586621679050116"><span class="hs-identifier hs-type">ra</span></a><span> </span><span class="hs-comment">-- ^ Unique key table constraint printer function object.</span><span>
</span><a name="line-254"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679050116"><span class="hs-identifier hs-type">ra</span></a><span>
</span><a name="line-255"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679050115"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span>
</span><a name="line-256"></a><a name="updateValuesByUnique"><a href="Database.Record.ToSql.html#updateValuesByUnique"><span class="hs-identifier">updateValuesByUnique</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.ToSql.html#updateValuesByUnique%27"><span class="hs-identifier hs-var">updateValuesByUnique'</span></a><span> </span><a href="Database.Record.ToSql.html#recordToSql"><span class="hs-identifier hs-var">recordToSql</span></a><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-comment">-- | Convert like 'updateValuesByUnique'' using implicit 'RecordToSql' and 'ColumnConstraint'.</span><span>
</span><a name="line-259"></a><span class="hs-identifier">updateValuesByPrimary</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Database.Record.KeyConstraint.html#HasKeyConstraint"><span class="hs-identifier hs-type">HasKeyConstraint</span></a><span> </span><a href="Database.Record.KeyConstraint.html#Primary"><span class="hs-identifier hs-type">Primary</span></a><span> </span><a href="#local-6989586621679050113"><span class="hs-identifier hs-type">ra</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.ToSql.html#ToSql"><span class="hs-identifier hs-type">ToSql</span></a><span> </span><a href="#local-6989586621679050114"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679050113"><span class="hs-identifier hs-type">ra</span></a><span class="hs-special">)</span><span>
</span><a name="line-260"></a><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679050113"><span class="hs-identifier hs-type">ra</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679050114"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span>
</span><a name="line-261"></a><a name="updateValuesByPrimary"><a href="Database.Record.ToSql.html#updateValuesByPrimary"><span class="hs-identifier">updateValuesByPrimary</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Record.ToSql.html#updateValuesByUnique"><span class="hs-identifier hs-var">updateValuesByUnique</span></a><span> </span><span class="hs-special">(</span><a href="Database.Record.KeyConstraint.html#unique"><span class="hs-identifier hs-var">unique</span></a><span> </span><a href="Database.Record.KeyConstraint.html#keyConstraint"><span class="hs-identifier hs-var">keyConstraint</span></a><span class="hs-special">)</span><span>
</span><a name="line-262"></a></pre></body></html>