<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE DefaultSignatures #-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Module      : Database.Record.FromSql</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Copyright   : 2013-2017 Kei Hibino</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- License     : BSD3</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- Maintainer  : ex8k.hibino@gmail.com</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Stability   : experimental</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- Portability : unknown</span><span>
</span><a name="line-15"></a><span class="hs-comment">--</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- This module defines interfaces</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- from list of database value type into Haskell type.</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">FromSql</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-20"></a><span>  </span><span class="hs-comment">-- * Conversion from list of database value type into record type</span><span>
</span><a name="line-21"></a><span>  </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.FromSql.html#runTakeRecord"><span class="hs-identifier hs-var">runTakeRecord</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.FromSql.html#runToRecord"><span class="hs-identifier hs-var">runToRecord</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>  </span><a href="Database.Record.FromSql.html#createRecordFromSql"><span class="hs-identifier hs-var">createRecordFromSql</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span>  </span><span class="hs-special">(</span><a href="Database.Record.FromSql.html#%3C%26%3E"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>  </span><a href="Database.Record.FromSql.html#maybeRecord"><span class="hs-identifier hs-var">maybeRecord</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>  </span><span class="hs-comment">-- * Derivation rules of 'RecordFromSql' conversion</span><span>
</span><a name="line-28"></a><span>  </span><a href="Database.Record.FromSql.html#FromSql"><span class="hs-identifier hs-type">FromSql</span></a><span> </span><span class="hs-special">(</span><a href="Database.Record.FromSql.html#recordFromSql"><span class="hs-identifier hs-var">recordFromSql</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>  </span><a href="Database.Record.FromSql.html#takeRecord"><span class="hs-identifier hs-var">takeRecord</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.FromSql.html#toRecord"><span class="hs-identifier hs-var">toRecord</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span>  </span><a href="Database.Record.FromSql.html#valueRecordFromSql"><span class="hs-identifier hs-var">valueRecordFromSql</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Generics</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Rep</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">U1</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">K1</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">M1</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-type">:*:</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">to</span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;*&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">liftM</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ap</span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Record.Persistable.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">Persistable</span></a><span> </span><span class="hs-special">(</span><a href="Database.Record.Persistable.html#PersistableType"><span class="hs-identifier hs-type">PersistableType</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Database.Record.Persistable.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">Persistable</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Persistable</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Record.KeyConstraint.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Record</span><span class="hs-operator">.</span><span class="hs-identifier">KeyConstraint</span></a><span>
</span><a name="line-41"></a><span>  </span><span class="hs-special">(</span><a href="Database.Record.KeyConstraint.html#HasColumnConstraint"><span class="hs-identifier hs-type">HasColumnConstraint</span></a><span class="hs-special">(</span><a href="Database.Record.KeyConstraint.html#columnConstraint"><span class="hs-identifier hs-var">columnConstraint</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#ColumnConstraint"><span class="hs-identifier hs-type">ColumnConstraint</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#NotNull"><span class="hs-identifier hs-type">NotNull</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.KeyConstraint.html#index"><span class="hs-identifier hs-var">index</span></a><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">{- |
'RecordFromSql' 'q' 'a' is data-type wrapping function
to convert from list of database value type (to receive from database) ['q'] into Haskell type 'a'

This structure is similar to parser.
While running 'RecordFromSql' behavior is the same as non-fail-able parser
which parse list of database value type ['q'] stream.

So, 'RecordFromSql' 'q' is 'Monad' and 'Applicative' instance like parser monad.
When, you have data constructor and objects like below.

@
  data MyRecord = MyRecord Foo Bar Baz
@

@
  foo :: 'RecordFromSql' SqlValue Foo
  foo =  ...
  bar :: 'RecordFromSql' SqlValue Bar
  bar =  ...
  baz :: 'RecordFromSql' SqlValue Bar
  baz =  ...
@

You can get composed 'RecordFromSql' like below.

@
  myRecord :: RecordFromSql SqlValue MyRecord
  myRecord =  MyRecord \&lt;$\&gt; foo \&lt;*\&gt; bar \&lt;*\&gt; baz
@
-}</span><span>
</span><a name="line-74"></a><span class="hs-keyword">newtype</span><span> </span><a name="RecordFromSql"><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier">RecordFromSql</span></a></a><span> </span><a name="local-6989586621679060172"><a href="#local-6989586621679060172"><span class="hs-identifier">q</span></a></a><span> </span><a name="local-6989586621679060173"><a href="#local-6989586621679060173"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RecordFromSql"><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier">RecordFromSql</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679060172"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060173"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060172"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">-- | Run 'RecordFromSql' parser function object.</span><span>
</span><a name="line-77"></a><span class="hs-comment">--   Convert from list of database value type ['q'] into Haskell type 'a' and rest of list ['q'].</span><span>
</span><a name="line-78"></a><span class="hs-identifier">runTakeRecord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060189"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060190"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ parser function object which has capability to convert</span><span>
</span><a name="line-79"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060189"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span>               </span><span class="hs-comment">-- ^ list of database value type</span><span>
</span><a name="line-80"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060190"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060189"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>          </span><span class="hs-comment">-- ^ Haskell type and rest of list</span><span>
</span><a name="line-81"></a><a name="runTakeRecord"><a href="Database.Record.FromSql.html#runTakeRecord"><span class="hs-identifier">runTakeRecord</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-var">RecordFromSql</span></a><span> </span><a name="local-6989586621679060191"><a href="#local-6989586621679060191"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060191"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-comment">-- | Axiom of 'RecordFromSql' for database value type 'q' and Haskell type 'a'</span><span>
</span><a name="line-84"></a><span class="hs-identifier">createRecordFromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679060187"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060188"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060187"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Convert function body</span><span>
</span><a name="line-85"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060187"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060188"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ Result parser function object</span><span>
</span><a name="line-86"></a><a name="createRecordFromSql"><a href="Database.Record.FromSql.html#createRecordFromSql"><span class="hs-identifier">createRecordFromSql</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-var">RecordFromSql</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- | Run 'RecordFromSql' parser function object. Convert from list of database value type ['q'] into  Haskell type 'a'.</span><span>
</span><a name="line-89"></a><span class="hs-identifier">runToRecord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060185"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060186"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ parser function object which has capability to convert</span><span>
</span><a name="line-90"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060185"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span>               </span><span class="hs-comment">-- ^ list of database value type</span><span>
</span><a name="line-91"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060186"><span class="hs-identifier hs-type">a</span></a><span>                 </span><span class="hs-comment">-- ^ Haskell type</span><span>
</span><a name="line-92"></a><a name="runToRecord"><a href="Database.Record.FromSql.html#runToRecord"><span class="hs-identifier">runToRecord</span></a></a><span> </span><a name="local-6989586621679060192"><a href="#local-6989586621679060192"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Record.FromSql.html#runTakeRecord"><span class="hs-identifier hs-var">runTakeRecord</span></a><span> </span><a href="#local-6989586621679060192"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">-- | 'Monad' instance like parser 'Monad'.</span><span>
</span><a name="line-95"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><span class="hs-special">(</span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060219"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-96"></a><span>  </span><a name="local-3458764513820541102"><span class="hs-identifier">return</span></a><span> </span><a name="local-6989586621679060220"><a href="#local-6989586621679060220"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.FromSql.html#createRecordFromSql"><span class="hs-identifier hs-var">createRecordFromSql</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060220"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>  </span><a name="local-6989586621679060221"><a href="#local-6989586621679060221"><span class="hs-identifier">ma</span></a></a><span> </span><a name="local-3458764513820541099"><span class="hs-operator">&gt;&gt;=</span></a><span> </span><a name="local-6989586621679060222"><a href="#local-6989586621679060222"><span class="hs-identifier">fmb</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-98"></a><span>    </span><a href="Database.Record.FromSql.html#createRecordFromSql"><span class="hs-identifier hs-var">createRecordFromSql</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060223"><a href="#local-6989586621679060223"><span class="hs-identifier">vals</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679060224"><a href="#local-6989586621679060224"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679060225"><a href="#local-6989586621679060225"><span class="hs-identifier">vals'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.FromSql.html#runTakeRecord"><span class="hs-identifier hs-var">runTakeRecord</span></a><span> </span><a href="#local-6989586621679060221"><span class="hs-identifier hs-var">ma</span></a><span> </span><a href="#local-6989586621679060223"><span class="hs-identifier hs-var">vals</span></a><span>
</span><a name="line-100"></a><span>              </span><span class="hs-keyword">in</span><span>  </span><a href="Database.Record.FromSql.html#runTakeRecord"><span class="hs-identifier hs-var">runTakeRecord</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060222"><span class="hs-identifier hs-var">fmb</span></a><span> </span><a href="#local-6989586621679060224"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060225"><span class="hs-identifier hs-var">vals'</span></a><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-comment">-- | Derived 'Functor' instance from 'Monad' instance</span><span>
</span><a name="line-103"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><span class="hs-special">(</span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060218"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-104"></a><span>  </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftM</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- | Derived 'Applicative' instance from 'Monad' instance</span><span>
</span><a name="line-107"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><span class="hs-special">(</span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060217"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-108"></a><span>  </span><a name="local-3458764513820541680"><span class="hs-identifier">pure</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-special">(</span><a name="local-3458764513820541679"><span class="hs-operator">&lt;*&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ap</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-comment">-- | Derivation rule of 'RecordFromSql' parser function object for Haskell tuple (,) type.</span><span>
</span><a name="line-112"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&amp;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060182"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060183"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060182"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060184"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060182"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060183"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679060184"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><a name="local-6989586621679060193"><a href="#local-6989586621679060193"><span class="hs-identifier">a</span></a></a><span> </span><a name="%3C%26%3E"><a href="Database.Record.FromSql.html#%3C%26%3E"><span class="hs-operator">&lt;&amp;&gt;</span></a></a><span> </span><a name="local-6989586621679060194"><a href="#local-6989586621679060194"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679060193"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679060194"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-operator">&lt;&amp;&gt;</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">-- | Derivation rule of 'RecordFromSql' parser function object for Haskell 'Maybe' type.</span><span>
</span><a name="line-119"></a><span class="hs-identifier">maybeRecord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.Persistable.html#PersistableType"><span class="hs-identifier hs-type">PersistableType</span></a><span> </span><a href="#local-6989586621679060180"><span class="hs-identifier hs-type">q</span></a><span>
</span><a name="line-120"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060180"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060181"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-121"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.KeyConstraint.html#ColumnConstraint"><span class="hs-identifier hs-type">ColumnConstraint</span></a><span> </span><a href="Database.Record.KeyConstraint.html#NotNull"><span class="hs-identifier hs-type">NotNull</span></a><span> </span><a href="#local-6989586621679060181"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-122"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060180"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679060181"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><a name="maybeRecord"><a href="Database.Record.FromSql.html#maybeRecord"><span class="hs-identifier">maybeRecord</span></a></a><span> </span><a name="local-6989586621679060195"><a href="#local-6989586621679060195"><span class="hs-identifier">rec</span></a></a><span> </span><a name="local-6989586621679060196"><a href="#local-6989586621679060196"><span class="hs-identifier">pkey</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.FromSql.html#createRecordFromSql"><span class="hs-identifier hs-var">createRecordFromSql</span></a><span> </span><a href="#local-6989586621679060197"><span class="hs-identifier hs-var">mayToRec</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-124"></a><span>  </span><a name="local-6989586621679060197"><a href="#local-6989586621679060197"><span class="hs-identifier">mayToRec</span></a></a><span> </span><a name="local-6989586621679060198"><a href="#local-6989586621679060198"><span class="hs-identifier">vals</span></a></a><span>
</span><a name="line-125"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060198"><span class="hs-identifier hs-var">vals</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="Database.Record.KeyConstraint.html#index"><span class="hs-identifier hs-var">index</span></a><span> </span><a href="#local-6989586621679060196"><span class="hs-identifier hs-var">pkey</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Database.Record.Persistable.html#sqlNullValue"><span class="hs-identifier hs-var">Persistable</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">sqlNullValue</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679060199"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679060200"><span class="hs-identifier hs-var">vals'</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679060200"><span class="hs-identifier hs-var">vals'</span></a><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-127"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679060199"><a href="#local-6989586621679060199"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679060200"><a href="#local-6989586621679060200"><span class="hs-identifier">vals'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.FromSql.html#runTakeRecord"><span class="hs-identifier hs-var">runTakeRecord</span></a><span> </span><a href="#local-6989586621679060195"><span class="hs-identifier hs-var">rec</span></a><span> </span><a href="#local-6989586621679060198"><span class="hs-identifier hs-var">vals</span></a><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-comment">{- |
'FromSql' 'q' 'a' is implicit rule to derive 'RecordFromSql' 'q' 'a' record parser function against type 'a'.

Generic programming (&lt;https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#generic-programming&gt;)
with default signature is available for 'FromSql' class,
so you can make instance like below:

@
  \{\-\# LANGUAGE DeriveGeneric \#\-\}
  import GHC.Generics (Generic)
  import Database.HDBC (SqlValue)
  --
  data Foo = Foo { ... } deriving Generic
  instance FromSql SqlValue Foo
@

-}</span><span>
</span><a name="line-146"></a><span class="hs-keyword">class</span><span> </span><a name="FromSql"><a href="Database.Record.FromSql.html#FromSql"><span class="hs-identifier">FromSql</span></a></a><span> </span><a name="local-6989586621679060170"><a href="#local-6989586621679060170"><span class="hs-identifier">q</span></a></a><span> </span><a name="local-6989586621679060171"><a href="#local-6989586621679060171"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-147"></a><span>  </span><span class="hs-comment">-- | 'RecordFromSql' 'q' 'a' record parser function.</span><span>
</span><a name="line-148"></a><span>  </span><span class="hs-identifier">recordFromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060170"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060171"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span>  </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">recordFromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span> </span><a href="#local-6989586621679060171"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.FromSql.html#GFromSql"><span class="hs-identifier hs-type">GFromSql</span></a><span> </span><a href="#local-6989586621679060170"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Rep</span><span> </span><a href="#local-6989586621679060171"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060170"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060171"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-151"></a><span>  </span><a name="local-8214565720323835067"><a href="Database.Record.FromSql.html#recordFromSql"><span class="hs-identifier">recordFromSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">to</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Record.FromSql.html#gFromSql"><span class="hs-identifier hs-var">gFromSql</span></a><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span class="hs-keyword">class</span><span> </span><a name="GFromSql"><a href="Database.Record.FromSql.html#GFromSql"><span class="hs-identifier">GFromSql</span></a></a><span> </span><a name="local-6989586621679060167"><a href="#local-6989586621679060167"><span class="hs-identifier">q</span></a></a><span> </span><a name="local-6989586621679060168"><a href="#local-6989586621679060168"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-identifier">gFromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060167"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060168"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679060169"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Record.FromSql.html#GFromSql"><span class="hs-identifier hs-type">GFromSql</span></a><span> </span><a href="#local-6989586621679060216"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-identifier hs-type">U1</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-158"></a><span>  </span><a name="local-8214565720323835065"><a href="Database.Record.FromSql.html#gFromSql"><span class="hs-identifier">gFromSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.FromSql.html#createRecordFromSql"><span class="hs-identifier hs-var">createRecordFromSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">U1</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Database.Record.FromSql.html#GFromSql"><span class="hs-identifier hs-type">GFromSql</span></a><span> </span><a href="#local-6989586621679060213"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060214"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.FromSql.html#GFromSql"><span class="hs-identifier hs-type">GFromSql</span></a><span> </span><a href="#local-6989586621679060213"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060215"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Record.FromSql.html#GFromSql"><span class="hs-identifier hs-type">GFromSql</span></a><span> </span><a href="#local-6989586621679060213"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060214"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><a href="#local-6989586621679060215"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-161"></a><span>  </span><a name="local-8214565720323835065"><a href="Database.Record.FromSql.html#gFromSql"><span class="hs-identifier">gFromSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">:*:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Record.FromSql.html#gFromSql"><span class="hs-identifier hs-var">gFromSql</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Database.Record.FromSql.html#gFromSql"><span class="hs-identifier hs-var">gFromSql</span></a><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Record.FromSql.html#GFromSql"><span class="hs-identifier hs-type">GFromSql</span></a><span> </span><a href="#local-6989586621679060209"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060210"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Record.FromSql.html#GFromSql"><span class="hs-identifier hs-type">GFromSql</span></a><span> </span><a href="#local-6989586621679060209"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">M1</span><span> </span><a href="#local-6989586621679060211"><span class="hs-identifier hs-type">i</span></a><span> </span><a href="#local-6989586621679060212"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679060210"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-164"></a><span>  </span><a name="local-8214565720323835065"><a href="Database.Record.FromSql.html#gFromSql"><span class="hs-identifier">gFromSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M1</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Record.FromSql.html#gFromSql"><span class="hs-identifier hs-var">gFromSql</span></a><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Record.FromSql.html#FromSql"><span class="hs-identifier hs-type">FromSql</span></a><span> </span><a href="#local-6989586621679060206"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060207"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Record.FromSql.html#GFromSql"><span class="hs-identifier hs-type">GFromSql</span></a><span> </span><a href="#local-6989586621679060206"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">K1</span><span> </span><a href="#local-6989586621679060208"><span class="hs-identifier hs-type">i</span></a><span> </span><a href="#local-6989586621679060207"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-167"></a><span>  </span><a name="local-8214565720323835065"><a href="Database.Record.FromSql.html#gFromSql"><span class="hs-identifier">gFromSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">K1</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Record.FromSql.html#recordFromSql"><span class="hs-identifier hs-var">recordFromSql</span></a><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-comment">-- | Implicit derivation rule of 'RecordFromSql' parser function object which can convert</span><span>
</span><a name="line-171"></a><span class="hs-comment">--   from list of database value type ['q'] into Haskell 'Maybe' type.</span><span>
</span><a name="line-172"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Database.Record.KeyConstraint.html#HasColumnConstraint"><span class="hs-identifier hs-type">HasColumnConstraint</span></a><span> </span><a href="Database.Record.KeyConstraint.html#NotNull"><span class="hs-identifier hs-type">NotNull</span></a><span> </span><a href="#local-6989586621679060204"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.FromSql.html#FromSql"><span class="hs-identifier hs-type">FromSql</span></a><span> </span><a href="#local-6989586621679060205"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060204"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Database.Record.Persistable.html#PersistableType"><span class="hs-identifier hs-type">PersistableType</span></a><span> </span><a href="#local-6989586621679060205"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-173"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Record.FromSql.html#FromSql"><span class="hs-identifier hs-type">FromSql</span></a><span> </span><a href="#local-6989586621679060205"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679060204"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-174"></a><span>  </span><a name="local-8214565720323835067"><a href="Database.Record.FromSql.html#recordFromSql"><span class="hs-identifier">recordFromSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.FromSql.html#maybeRecord"><span class="hs-identifier hs-var">maybeRecord</span></a><span> </span><a href="Database.Record.FromSql.html#recordFromSql"><span class="hs-identifier hs-var">recordFromSql</span></a><span> </span><a href="Database.Record.KeyConstraint.html#columnConstraint"><span class="hs-identifier hs-var">columnConstraint</span></a><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-comment">-- | Implicit derivation rule of 'RecordFromSql' parser function object which can convert</span><span>
</span><a name="line-177"></a><span class="hs-comment">--   from /empty/ list of database value type ['q'] into Haskell unit () type.</span><span>
</span><a name="line-178"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Record.FromSql.html#FromSql"><span class="hs-identifier hs-type">FromSql</span></a><span> </span><a href="#local-6989586621679060203"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- default generic instance</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-comment">-- | Run implicit 'RecordFromSql' parser function object.</span><span>
</span><a name="line-181"></a><span class="hs-comment">--   Convert from list of database value type ['q'] into haskell type 'a' and rest of list ['q'].</span><span>
</span><a name="line-182"></a><span class="hs-identifier">takeRecord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.FromSql.html#FromSql"><span class="hs-identifier hs-type">FromSql</span></a><span> </span><a href="#local-6989586621679060178"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060179"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060178"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060179"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060178"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-183"></a><a name="takeRecord"><a href="Database.Record.FromSql.html#takeRecord"><span class="hs-identifier">takeRecord</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Record.FromSql.html#runTakeRecord"><span class="hs-identifier hs-var">runTakeRecord</span></a><span> </span><a href="Database.Record.FromSql.html#recordFromSql"><span class="hs-identifier hs-var">recordFromSql</span></a><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">-- | Run implicit 'RecordFromSql' parser function object.</span><span>
</span><a name="line-186"></a><span class="hs-comment">--   Convert from list of database value type ['q'] into haskell type 'a'.</span><span>
</span><a name="line-187"></a><span class="hs-identifier">toRecord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Record.FromSql.html#FromSql"><span class="hs-identifier hs-type">FromSql</span></a><span> </span><a href="#local-6989586621679060176"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060177"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060176"><span class="hs-identifier hs-type">q</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060177"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-188"></a><a name="toRecord"><a href="Database.Record.FromSql.html#toRecord"><span class="hs-identifier">toRecord</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Database.Record.FromSql.html#runToRecord"><span class="hs-identifier hs-var">runToRecord</span></a><span> </span><a href="Database.Record.FromSql.html#recordFromSql"><span class="hs-identifier hs-var">recordFromSql</span></a><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-comment">-- | Derivation rule of 'RecordFromSql' parser function object for value convert function.</span><span>
</span><a name="line-191"></a><span class="hs-identifier">valueRecordFromSql</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060174"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060175"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Record.FromSql.html#RecordFromSql"><span class="hs-identifier hs-type">RecordFromSql</span></a><span> </span><a href="#local-6989586621679060174"><span class="hs-identifier hs-type">q</span></a><span> </span><a href="#local-6989586621679060175"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-192"></a><a name="valueRecordFromSql"><a href="Database.Record.FromSql.html#valueRecordFromSql"><span class="hs-identifier">valueRecordFromSql</span></a></a><span> </span><a name="local-6989586621679060201"><a href="#local-6989586621679060201"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Record.FromSql.html#createRecordFromSql"><span class="hs-identifier hs-var">createRecordFromSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679060202"><a href="#local-6989586621679060202"><span class="hs-identifier">qs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060201"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679060202"><span class="hs-identifier hs-var">qs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679060202"><span class="hs-identifier hs-var">qs</span></a><span class="hs-special">)</span><span>
</span><a name="line-193"></a></pre></body></html>